

date and time :  Fri Jun 11 20:50:04 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=449, weight_decay=1e-10)
device :  cuda:0
Counter({0: 2586, 1: 2553, 2: 2261})

Epoch :  1 loss training:  208.12230324745178 Time :  27
accuracy train: 0.625083 val: 0.570149 test: 0.589414
max validation accuracy : 0.570149 max acc epoch : 1 test accuracy : 0.589414
Counter({0: 3001, 1: 2317, 2: 2082})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  144.9687122106552 Time :  55
accuracy train: 0.724686 val: 0.623881 test: 0.651496
max validation accuracy : 0.623881 max acc epoch : 2 test accuracy : 0.651496
Counter({1: 2787, 0: 2679, 2: 1934})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.47566595673561 Time :  92
accuracy train: 0.743216 val: 0.620896 test: 0.668563
max validation accuracy : 0.623881 max acc epoch : 2 test accuracy : 0.651496
Counter({1: 2940, 0: 2535, 2: 1925})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  97.16029179096222 Time :  122
accuracy train: 0.814692 val: 0.653731 test: 0.702696
max validation accuracy : 0.653731 max acc epoch : 4 test accuracy : 0.702696
Counter({2: 2876, 1: 2567, 0: 1957})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.22520463168621 Time :  149
accuracy train: 0.823296 val: 0.659701 test: 0.706406
max validation accuracy : 0.659701 max acc epoch : 5 test accuracy : 0.706406
Counter({1: 2886, 0: 2573, 2: 1941})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  86.34439513087273 Time :  175
accuracy train: 0.833554 val: 0.656716 test: 0.704922
max validation accuracy : 0.659701 max acc epoch : 5 test accuracy : 0.706406
Counter({1: 2891, 2: 2578, 0: 1931})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  69.96660724282265 Time :  212
accuracy train: 0.866314 val: 0.683582 test: 0.714816
max validation accuracy : 0.683582 max acc epoch : 7 test accuracy : 0.714816
Counter({2: 2894, 1: 2585, 0: 1921})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.35201017558575 Time :  239
accuracy train: 0.858372 val: 0.674627 test: 0.709622
max validation accuracy : 0.683582 max acc epoch : 7 test accuracy : 0.714816
Counter({2: 2899, 0: 2586, 1: 1915})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.32590764760971 Time :  271
accuracy train: 0.884514 val: 0.683582 test: 0.713332
max validation accuracy : 0.683582 max acc epoch : 7 test accuracy : 0.714816
Counter({1: 2894, 0: 2597, 2: 1909})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.872914120554924 Time :  299
accuracy train: 0.881866 val: 0.668657 test: 0.713826
max validation accuracy : 0.683582 max acc epoch : 7 test accuracy : 0.714816
Counter({2: 2876, 0: 2608, 1: 1916})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  55.426844984292984 Time :  326
accuracy train: 0.902052 val: 0.686567 test: 0.714321
max validation accuracy : 0.686567 max acc epoch : 11 test accuracy : 0.714321
Counter({1: 2869, 0: 2617, 2: 1914})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.16479118168354 Time :  364
accuracy train: 0.900728 val: 0.674627 test: 0.715063
max validation accuracy : 0.686567 max acc epoch : 11 test accuracy : 0.714321
Counter({1: 2868, 0: 2618, 2: 1914})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  49.335894264280796 Time :  393
accuracy train: 0.912641 val: 0.674627 test: 0.716794
max validation accuracy : 0.686567 max acc epoch : 11 test accuracy : 0.714321
Counter({1: 2860, 0: 2624, 2: 1916})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  47.94458544254303 Time :  421
accuracy train: 0.919590 val: 0.662687 test: 0.714568
max validation accuracy : 0.686567 max acc epoch : 11 test accuracy : 0.714321
Counter({2: 2853, 0: 2629, 1: 1918})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  46.87192511558533 Time :  449
accuracy train: 0.919921 val: 0.683582 test: 0.715310
max validation accuracy : 0.686567 max acc epoch : 11 test accuracy : 0.714321
Counter({1: 2850, 0: 2639, 2: 1911})

Epoch :  16 loss training:  47.4982505440712 Time :  481
accuracy train: 0.923891 val: 0.683582 test: 0.717536
max validation accuracy : 0.686567 max acc epoch : 11 test accuracy : 0.714321
Counter({1: 2842, 0: 2656, 2: 1902})

Epoch :  17 loss training:  42.80327008664608 Time :  510
accuracy train: 0.932164 val: 0.674627 test: 0.715805
max validation accuracy : 0.686567 max acc epoch : 11 test accuracy : 0.714321
Counter({1: 2836, 0: 2661, 2: 1903})

Epoch :  18 loss training:  43.61332102864981 Time :  538
accuracy train: 0.931502 val: 0.698507 test: 0.720257
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2831, 0: 2662, 2: 1907})

Epoch :  19 loss training:  41.09520719945431 Time :  564
accuracy train: 0.938120 val: 0.680597 test: 0.718031
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({2: 2834, 0: 2671, 1: 1895})

Epoch :  20 loss training:  40.29767602682114 Time :  591
accuracy train: 0.939775 val: 0.686567 test: 0.718279
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2837, 0: 2671, 2: 1892})

Epoch :  21 loss training:  36.71831324696541 Time :  620
accuracy train: 0.944739 val: 0.680597 test: 0.716052
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({0: 2828, 2: 2684, 1: 1888})

Epoch :  22 loss training:  39.339334681630135 Time :  647
accuracy train: 0.948379 val: 0.686567 test: 0.716794
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2827, 2: 2683, 0: 1890})

Epoch :  23 loss training:  34.48108533024788 Time :  685
accuracy train: 0.955659 val: 0.674627 test: 0.717784
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2828, 0: 2680, 2: 1892})

Epoch :  24 loss training:  36.188403733074665 Time :  714
accuracy train: 0.953673 val: 0.683582 test: 0.716052
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2829, 0: 2678, 2: 1893})

Epoch :  25 loss training:  32.25518786162138 Time :  743
accuracy train: 0.959960 val: 0.677612 test: 0.719021
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({2: 2829, 0: 2677, 1: 1894})

Epoch :  26 loss training:  33.83310028910637 Time :  776
accuracy train: 0.964924 val: 0.680597 test: 0.715558
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({0: 2827, 2: 2680, 1: 1893})

Epoch :  27 loss training:  30.126516550779343 Time :  815
accuracy train: 0.966578 val: 0.683582 test: 0.719515
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({2: 2822, 1: 2683, 0: 1895})

Epoch :  28 loss training:  30.941774137318134 Time :  850
accuracy train: 0.971211 val: 0.680597 test: 0.717784
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2822, 0: 2691, 2: 1887})

Epoch :  29 loss training:  28.48722493276 Time :  884
accuracy train: 0.968895 val: 0.683582 test: 0.719268
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2824, 2: 2689, 0: 1887})

Epoch :  30 loss training:  31.034970313310623 Time :  910
accuracy train: 0.972535 val: 0.683582 test: 0.720505
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({2: 2830, 0: 2684, 1: 1886})

Epoch :  31 loss training:  27.607908755540848 Time :  938
accuracy train: 0.976175 val: 0.686567 test: 0.720505
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2830, 0: 2689, 2: 1881})

Epoch :  32 loss training:  28.509981144219637 Time :  965
accuracy train: 0.978822 val: 0.689552 test: 0.715310
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({0: 2834, 1: 2692, 2: 1874})

Epoch :  33 loss training:  23.24742154031992 Time :  993
accuracy train: 0.978491 val: 0.686567 test: 0.717042
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2830, 2: 2700, 0: 1870})

Epoch :  34 loss training:  24.896037727594376 Time :  1021
accuracy train: 0.978160 val: 0.692537 test: 0.719763
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2836, 0: 2698, 2: 1866})

Epoch :  35 loss training:  21.716190118342638 Time :  1048
accuracy train: 0.984116 val: 0.677612 test: 0.719515
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2834, 2: 2702, 0: 1864})

Epoch :  36 loss training:  23.808065623044968 Time :  1080
accuracy train: 0.983455 val: 0.683582 test: 0.720257
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2837, 2: 2702, 0: 1861})

Epoch :  37 loss training:  21.19328536093235 Time :  1108
accuracy train: 0.987095 val: 0.683582 test: 0.721741
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2830, 0: 2702, 2: 1868})

Epoch :  38 loss training:  22.58909361809492 Time :  1141
accuracy train: 0.989080 val: 0.683582 test: 0.717289
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2826, 0: 2712, 2: 1862})

Epoch :  39 loss training:  19.609561949968338 Time :  1169
accuracy train: 0.988749 val: 0.683582 test: 0.718773
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({2: 2832, 0: 2714, 1: 1854})

Epoch :  40 loss training:  20.657057657837868 Time :  1197
accuracy train: 0.989411 val: 0.677612 test: 0.718773
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2832, 2: 2711, 0: 1857})

Epoch :  41 loss training:  18.37434884905815 Time :  1224
accuracy train: 0.992720 val: 0.680597 test: 0.718773
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2828, 2: 2712, 0: 1860})

Epoch :  42 loss training:  18.942252729088068 Time :  1253
accuracy train: 0.991066 val: 0.683582 test: 0.721247
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2838, 0: 2701, 2: 1861})

Epoch :  43 loss training:  16.12973533011973 Time :  1286
accuracy train: 0.993051 val: 0.680597 test: 0.720752
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2842, 2: 2697, 0: 1861})

Epoch :  44 loss training:  17.480135038495064 Time :  1317
accuracy train: 0.991727 val: 0.668657 test: 0.720752
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2852, 0: 2688, 2: 1860})

Epoch :  45 loss training:  15.575411714613438 Time :  1344
accuracy train: 0.995367 val: 0.677612 test: 0.720257
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2848, 2: 2690, 0: 1862})

Epoch :  46 loss training:  17.009308211505413 Time :  1372
accuracy train: 0.996029 val: 0.677612 test: 0.721247
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({2: 2853, 1: 2683, 0: 1864})

Epoch :  47 loss training:  14.495381563901901 Time :  1405
accuracy train: 0.997353 val: 0.677612 test: 0.721247
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({2: 2851, 1: 2685, 0: 1864})

Epoch :  48 loss training:  15.496221255511045 Time :  1434
accuracy train: 0.996691 val: 0.674627 test: 0.722483
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({0: 2865, 1: 2674, 2: 1861})

Epoch :  49 loss training:  12.531017757952213 Time :  1462
accuracy train: 0.997684 val: 0.677612 test: 0.722483
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.720257
Counter({1: 2863, 0: 2674, 2: 1863})

========================================================================================================================================================================================================
best acc epoch :  18
validation accuracy :  0.6985074626865672
test accuracy :  0.7202572347266881
last test_accuracy :  0.7224833044768736
second best val :  0.6925373134328359
second best test :  0.7202572347266881
max gap 7
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=449, weight_decay=1e-10)
device :  cuda:0
Counter({0: 2586, 1: 2553, 2: 2261})

Epoch :  1 loss training:  208.88245981931686 Time :  1510
accuracy train: 0.621774 val: 0.549254 test: 0.591640
max validation accuracy : 0.549254 max acc epoch : 1 test accuracy : 0.591640
Counter({0: 3055, 2: 2567, 1: 1778})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  144.34423810243607 Time :  1538
accuracy train: 0.725678 val: 0.614925 test: 0.654712
max validation accuracy : 0.614925 max acc epoch : 2 test accuracy : 0.654712
Counter({2: 2884, 1: 2694, 0: 1822})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.54683518409729 Time :  1568
accuracy train: 0.739576 val: 0.617910 test: 0.667326
max validation accuracy : 0.617910 max acc epoch : 3 test accuracy : 0.667326
Counter({0: 3261, 1: 2660, 2: 1479})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  97.82235026359558 Time :  1595
accuracy train: 0.811714 val: 0.671642 test: 0.698986
max validation accuracy : 0.671642 max acc epoch : 4 test accuracy : 0.698986
Counter({0: 3412, 2: 2505, 1: 1483})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.32128173112869 Time :  1625
accuracy train: 0.822965 val: 0.653731 test: 0.709622
max validation accuracy : 0.671642 max acc epoch : 4 test accuracy : 0.698986
Counter({2: 3426, 1: 2509, 0: 1465})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  86.02501803636551 Time :  1656
accuracy train: 0.832561 val: 0.674627 test: 0.711106
max validation accuracy : 0.674627 max acc epoch : 6 test accuracy : 0.711106
Counter({2: 3494, 1: 2460, 0: 1446})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  69.6903270483017 Time :  1706
accuracy train: 0.863997 val: 0.674627 test: 0.714321
max validation accuracy : 0.674627 max acc epoch : 6 test accuracy : 0.711106
Counter({2: 3500, 1: 2458, 0: 1442})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.3246131837368 Time :  1732
accuracy train: 0.856386 val: 0.677612 test: 0.706901
max validation accuracy : 0.677612 max acc epoch : 8 test accuracy : 0.706901
Counter({2: 3482, 1: 2479, 0: 1439})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.7385451644659 Time :  1765
accuracy train: 0.878888 val: 0.683582 test: 0.711353
max validation accuracy : 0.683582 max acc epoch : 9 test accuracy : 0.711353
Counter({2: 3491, 1: 2473, 0: 1436})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.970815151929855 Time :  1792
accuracy train: 0.884183 val: 0.689552 test: 0.711106
max validation accuracy : 0.689552 max acc epoch : 10 test accuracy : 0.711106
Counter({1: 3485, 0: 2479, 2: 1436})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  56.071113511919975 Time :  1822
accuracy train: 0.901721 val: 0.683582 test: 0.719021
max validation accuracy : 0.689552 max acc epoch : 10 test accuracy : 0.711106
Counter({2: 3483, 1: 2472, 0: 1445})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.546218886971474 Time :  1854
accuracy train: 0.898412 val: 0.668657 test: 0.711353
max validation accuracy : 0.689552 max acc epoch : 10 test accuracy : 0.711106
Counter({0: 3468, 2: 2488, 1: 1444})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  49.49135680496693 Time :  1884
accuracy train: 0.912310 val: 0.677612 test: 0.719268
max validation accuracy : 0.689552 max acc epoch : 10 test accuracy : 0.711106
Counter({2: 3470, 1: 2482, 0: 1448})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  48.403627783060074 Time :  1913
accuracy train: 0.921244 val: 0.692537 test: 0.717536
max validation accuracy : 0.692537 max acc epoch : 14 test accuracy : 0.717536
Counter({2: 3460, 1: 2493, 0: 1447})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  47.22524610161781 Time :  1940
accuracy train: 0.918597 val: 0.671642 test: 0.720257
max validation accuracy : 0.692537 max acc epoch : 14 test accuracy : 0.717536
Counter({2: 3459, 1: 2495, 0: 1446})

Epoch :  16 loss training:  47.34552837908268 Time :  1975
accuracy train: 0.924553 val: 0.680597 test: 0.720999
max validation accuracy : 0.692537 max acc epoch : 14 test accuracy : 0.717536
Counter({1: 3448, 2: 2501, 0: 1451})

Epoch :  17 loss training:  42.761154517531395 Time :  2004
accuracy train: 0.928524 val: 0.689552 test: 0.719021
max validation accuracy : 0.692537 max acc epoch : 14 test accuracy : 0.717536
Counter({2: 3448, 1: 2501, 0: 1451})

Epoch :  18 loss training:  43.050060123205185 Time :  2033
accuracy train: 0.932495 val: 0.701493 test: 0.718279
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({1: 3460, 2: 2490, 0: 1450})

Epoch :  19 loss training:  40.5339820086956 Time :  2060
accuracy train: 0.936797 val: 0.686567 test: 0.723225
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({1: 3452, 2: 2494, 0: 1454})

Epoch :  20 loss training:  41.95126432925463 Time :  2096
accuracy train: 0.941099 val: 0.689552 test: 0.720505
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({2: 3442, 1: 2506, 0: 1452})

Epoch :  21 loss training:  37.07281105220318 Time :  2125
accuracy train: 0.945069 val: 0.683582 test: 0.722731
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({2: 3442, 0: 2504, 1: 1454})

Epoch :  22 loss training:  40.10205677896738 Time :  2152
accuracy train: 0.945400 val: 0.698507 test: 0.720752
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({0: 3417, 2: 2527, 1: 1456})

Epoch :  23 loss training:  35.545135751366615 Time :  2179
accuracy train: 0.953011 val: 0.677612 test: 0.722483
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({0: 3410, 1: 2528, 2: 1462})

Epoch :  24 loss training:  36.32706629484892 Time :  2209
accuracy train: 0.951026 val: 0.689552 test: 0.720752
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({2: 3401, 1: 2535, 0: 1464})

Epoch :  25 loss training:  32.667619459331036 Time :  2240
accuracy train: 0.960953 val: 0.674627 test: 0.723473
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({0: 3405, 2: 2533, 1: 1462})

Epoch :  26 loss training:  34.62546058371663 Time :  2273
accuracy train: 0.964593 val: 0.674627 test: 0.719021
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({2: 3410, 1: 2526, 0: 1464})

Epoch :  27 loss training:  31.368015341460705 Time :  2300
accuracy train: 0.967902 val: 0.680597 test: 0.725204
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({0: 3407, 1: 2525, 2: 1468})

Epoch :  28 loss training:  33.29367966204882 Time :  2328
accuracy train: 0.968895 val: 0.686567 test: 0.721741
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({0: 3410, 1: 2522, 2: 1468})

Epoch :  29 loss training:  27.998143669217825 Time :  2355
accuracy train: 0.970549 val: 0.671642 test: 0.721741
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({2: 3411, 1: 2525, 0: 1464})

Epoch :  30 loss training:  29.242777951061726 Time :  2384
accuracy train: 0.974851 val: 0.692537 test: 0.720257
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({1: 3415, 2: 2520, 0: 1465})

Epoch :  31 loss training:  26.90265556052327 Time :  2418
accuracy train: 0.974189 val: 0.677612 test: 0.723225
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({2: 3413, 1: 2519, 0: 1468})

Epoch :  32 loss training:  27.59402208030224 Time :  2446
accuracy train: 0.977498 val: 0.686567 test: 0.722731
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({2: 3421, 1: 2514, 0: 1465})

Epoch :  33 loss training:  26.199058674275875 Time :  2474
accuracy train: 0.981469 val: 0.683582 test: 0.720010
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({2: 3433, 1: 2503, 0: 1464})

Epoch :  34 loss training:  26.38964795321226 Time :  2499
accuracy train: 0.979484 val: 0.692537 test: 0.721989
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({2: 3430, 1: 2505, 0: 1465})

Epoch :  35 loss training:  22.36130003631115 Time :  2529
accuracy train: 0.982793 val: 0.686567 test: 0.721989
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({2: 3431, 1: 2507, 0: 1462})

Epoch :  36 loss training:  24.365950472652912 Time :  2566
accuracy train: 0.980477 val: 0.680597 test: 0.724215
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({0: 3424, 1: 2514, 2: 1462})

Epoch :  37 loss training:  21.976329013705254 Time :  2594
accuracy train: 0.985440 val: 0.671642 test: 0.721989
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({2: 3424, 1: 2514, 0: 1462})

Epoch :  38 loss training:  22.47131936252117 Time :  2627
accuracy train: 0.983786 val: 0.671642 test: 0.717784
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({2: 3423, 1: 2514, 0: 1463})

Epoch :  39 loss training:  20.200969006866217 Time :  2653
accuracy train: 0.989411 val: 0.674627 test: 0.722978
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({0: 3422, 1: 2514, 2: 1464})

Epoch :  40 loss training:  20.662033706903458 Time :  2679
accuracy train: 0.987095 val: 0.671642 test: 0.724957
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({0: 3439, 1: 2496, 2: 1465})

Epoch :  41 loss training:  18.569937482476234 Time :  2712
accuracy train: 0.990404 val: 0.674627 test: 0.725451
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({1: 3436, 2: 2496, 0: 1468})

Epoch :  42 loss training:  19.497269205749035 Time :  2740
accuracy train: 0.989742 val: 0.683582 test: 0.720999
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({2: 3426, 1: 2515, 0: 1459})

Epoch :  43 loss training:  16.586700400337577 Time :  2767
accuracy train: 0.991727 val: 0.674627 test: 0.718526
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({2: 3440, 1: 2505, 0: 1455})

Epoch :  44 loss training:  17.707740228623152 Time :  2793
accuracy train: 0.990735 val: 0.680597 test: 0.720999
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({1: 3436, 2: 2507, 0: 1457})

Epoch :  45 loss training:  15.075695008039474 Time :  2827
accuracy train: 0.993382 val: 0.671642 test: 0.721247
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({2: 3430, 1: 2514, 0: 1456})

Epoch :  46 loss training:  16.674878649413586 Time :  2854
accuracy train: 0.994705 val: 0.674627 test: 0.720999
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({2: 3427, 1: 2516, 0: 1457})

Epoch :  47 loss training:  14.082133084535599 Time :  2881
accuracy train: 0.995698 val: 0.677612 test: 0.723225
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({2: 3432, 1: 2514, 0: 1454})

Epoch :  48 loss training:  16.33665169030428 Time :  2908
accuracy train: 0.995036 val: 0.674627 test: 0.721494
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({1: 3411, 2: 2530, 0: 1459})

Epoch :  49 loss training:  13.81599060073495 Time :  2935
accuracy train: 0.996360 val: 0.674627 test: 0.718279
max validation accuracy : 0.701493 max acc epoch : 18 test accuracy : 0.718279
Counter({0: 3420, 2: 2522, 1: 1458})

========================================================================================================================================================================================================
best acc epoch :  18
validation accuracy :  0.7014925373134329
test accuracy :  0.7182785060598565
last test_accuracy :  0.7182785060598565
second best val :  0.6985074626865672
second best test :  0.7182785060598565
max gap 4
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=449, weight_decay=1e-10)
device :  cuda:0
Counter({0: 2586, 1: 2553, 2: 2261})

Epoch :  1 loss training:  208.36534816026688 Time :  2972
accuracy train: 0.618465 val: 0.546269 test: 0.585951
max validation accuracy : 0.546269 max acc epoch : 1 test accuracy : 0.585951
Counter({2: 3375, 1: 2301, 0: 1724})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  144.10450863838196 Time :  2998
accuracy train: 0.725017 val: 0.629851 test: 0.653228
max validation accuracy : 0.629851 max acc epoch : 2 test accuracy : 0.653228
Counter({1: 2792, 2: 2645, 0: 1963})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.21260872483253 Time :  3026
accuracy train: 0.728987 val: 0.605970 test: 0.657433
max validation accuracy : 0.629851 max acc epoch : 2 test accuracy : 0.653228
Counter({1: 2818, 2: 2774, 0: 1808})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  98.75728100538254 Time :  3052
accuracy train: 0.809398 val: 0.659701 test: 0.696512
max validation accuracy : 0.659701 max acc epoch : 4 test accuracy : 0.696512
Counter({2: 2792, 0: 2765, 1: 1843})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.35024362802505 Time :  3076
accuracy train: 0.822965 val: 0.671642 test: 0.699975
max validation accuracy : 0.671642 max acc epoch : 5 test accuracy : 0.699975
Counter({0: 2834, 1: 2734, 2: 1832})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  86.24936830997467 Time :  3117
accuracy train: 0.832561 val: 0.665672 test: 0.701212
max validation accuracy : 0.671642 max acc epoch : 5 test accuracy : 0.699975
Counter({0: 2852, 1: 2660, 2: 1888})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  71.73512551188469 Time :  3152
accuracy train: 0.861019 val: 0.710448 test: 0.706653
max validation accuracy : 0.710448 max acc epoch : 7 test accuracy : 0.706653
Counter({0: 2829, 1: 2667, 2: 1904})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  69.8647783100605 Time :  3182
accuracy train: 0.851423 val: 0.686567 test: 0.705417
max validation accuracy : 0.710448 max acc epoch : 7 test accuracy : 0.706653
Counter({0: 2767, 2: 2694, 1: 1939})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.21952250599861 Time :  3220
accuracy train: 0.876572 val: 0.692537 test: 0.709127
max validation accuracy : 0.710448 max acc epoch : 7 test accuracy : 0.706653
Counter({0: 2741, 1: 2731, 2: 1928})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.15874657034874 Time :  3250
accuracy train: 0.880543 val: 0.701493 test: 0.714321
max validation accuracy : 0.710448 max acc epoch : 7 test accuracy : 0.706653
Counter({2: 2745, 0: 2735, 1: 1920})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  55.98347972333431 Time :  3281
accuracy train: 0.897419 val: 0.713433 test: 0.713084
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({2: 2750, 1: 2728, 0: 1922})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  56.6947785615921 Time :  3309
accuracy train: 0.895103 val: 0.701493 test: 0.714074
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({0: 2749, 2: 2734, 1: 1917})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  50.502283960580826 Time :  3347
accuracy train: 0.911317 val: 0.698507 test: 0.714321
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({2: 2751, 0: 2733, 1: 1916})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  49.64294317364693 Time :  3380
accuracy train: 0.918266 val: 0.701493 test: 0.714074
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 2750, 2: 2735, 0: 1915})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  47.742347329854965 Time :  3409
accuracy train: 0.916612 val: 0.704478 test: 0.718773
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 2752, 2: 2740, 0: 1908})

Epoch :  16 loss training:  48.215966776013374 Time :  3444
accuracy train: 0.924222 val: 0.707463 test: 0.714816
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 2753, 2: 2745, 0: 1902})

Epoch :  17 loss training:  43.74244073778391 Time :  3478
accuracy train: 0.930510 val: 0.704478 test: 0.716547
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 2752, 0: 2747, 2: 1901})

Epoch :  18 loss training:  44.45420977473259 Time :  3510
accuracy train: 0.931502 val: 0.707463 test: 0.718773
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({0: 2754, 1: 2746, 2: 1900})

Epoch :  19 loss training:  41.71556159853935 Time :  3542
accuracy train: 0.936797 val: 0.704478 test: 0.715558
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 2754, 0: 2747, 2: 1899})

Epoch :  20 loss training:  40.98581674695015 Time :  3574
accuracy train: 0.941099 val: 0.713433 test: 0.720505
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 2769, 0: 2741, 2: 1890})

Epoch :  21 loss training:  38.65313521027565 Time :  3602
accuracy train: 0.942091 val: 0.701493 test: 0.718279
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 2769, 0: 2737, 2: 1894})

Epoch :  22 loss training:  40.90637398511171 Time :  3632
accuracy train: 0.945400 val: 0.695522 test: 0.721741
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 2769, 0: 2743, 2: 1888})

Epoch :  23 loss training:  35.66016561537981 Time :  3669
accuracy train: 0.950695 val: 0.692537 test: 0.723720
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 2775, 0: 2739, 2: 1886})

Epoch :  24 loss training:  37.44128958880901 Time :  3694
accuracy train: 0.950695 val: 0.704478 test: 0.722483
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 2790, 0: 2731, 2: 1879})

Epoch :  25 loss training:  34.33447118103504 Time :  3730
accuracy train: 0.959298 val: 0.689552 test: 0.723967
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 2789, 0: 2732, 2: 1879})

Epoch :  26 loss training:  33.71154887229204 Time :  3759
accuracy train: 0.960291 val: 0.689552 test: 0.722731
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({2: 2792, 0: 2729, 1: 1879})

Epoch :  27 loss training:  31.05035112053156 Time :  3794
accuracy train: 0.963269 val: 0.692537 test: 0.720752
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({2: 2798, 1: 2725, 0: 1877})

Epoch :  28 loss training:  32.307361997663975 Time :  3835
accuracy train: 0.968564 val: 0.692537 test: 0.724215
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 2814, 0: 2711, 2: 1875})

Epoch :  29 loss training:  29.53247757256031 Time :  3863
accuracy train: 0.970549 val: 0.698507 test: 0.721989
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({0: 2830, 1: 2701, 2: 1869})

Epoch :  30 loss training:  31.086438834667206 Time :  3892
accuracy train: 0.973197 val: 0.683582 test: 0.723473
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({2: 2840, 1: 2691, 0: 1869})

Epoch :  31 loss training:  27.930867597460747 Time :  3920
accuracy train: 0.976175 val: 0.683582 test: 0.720999
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 2838, 0: 2691, 2: 1871})

Epoch :  32 loss training:  28.585913252085447 Time :  3945
accuracy train: 0.977498 val: 0.689552 test: 0.722483
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 2843, 2: 2691, 0: 1866})

Epoch :  33 loss training:  25.095415711402893 Time :  3981
accuracy train: 0.980477 val: 0.695522 test: 0.719268
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({2: 2843, 0: 2689, 1: 1868})

Epoch :  34 loss training:  27.248079225420952 Time :  4011
accuracy train: 0.977167 val: 0.701493 test: 0.725451
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({2: 2847, 0: 2690, 1: 1863})

Epoch :  35 loss training:  22.230145186185837 Time :  4038
accuracy train: 0.983124 val: 0.695522 test: 0.720257
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 2848, 0: 2689, 2: 1863})

Epoch :  36 loss training:  24.016578752547503 Time :  4076
accuracy train: 0.979153 val: 0.692537 test: 0.722483
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 2862, 0: 2682, 2: 1856})

Epoch :  37 loss training:  21.32560607045889 Time :  4117
accuracy train: 0.983455 val: 0.704478 test: 0.722483
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({2: 2873, 1: 2677, 0: 1850})

Epoch :  38 loss training:  23.441246535629034 Time :  4160
accuracy train: 0.987095 val: 0.698507 test: 0.720257
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({1: 2865, 2: 2691, 0: 1844})

Epoch :  39 loss training:  19.97447367757559 Time :  4186
accuracy train: 0.987095 val: 0.704478 test: 0.722236
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({2: 2866, 0: 2690, 1: 1844})

Epoch :  40 loss training:  20.62467872351408 Time :  4214
accuracy train: 0.987095 val: 0.698507 test: 0.720999
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({2: 2877, 0: 2677, 1: 1846})

Epoch :  41 loss training:  18.557233119383454 Time :  4241
accuracy train: 0.990073 val: 0.698507 test: 0.723967
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({2: 2870, 0: 2677, 1: 1853})

Epoch :  42 loss training:  19.560198098421097 Time :  4268
accuracy train: 0.987095 val: 0.695522 test: 0.725946
max validation accuracy : 0.713433 max acc epoch : 11 test accuracy : 0.713084
Counter({2: 2872, 0: 2671, 1: 1857})

========================================================================================================================================================================================================
best acc epoch :  11
validation accuracy :  0.7134328358208956
test accuracy :  0.7130843433094237
last test_accuracy :  0.7259460796438288
second best val :  0.7104477611940299
second best test :  0.7066534751422211
max gap 4
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=449, weight_decay=1e-10)
device :  cuda:0
Counter({0: 2586, 1: 2553, 2: 2261})

Epoch :  1 loss training:  208.58848118782043 Time :  4311
accuracy train: 0.625414 val: 0.558209 test: 0.592382
max validation accuracy : 0.558209 max acc epoch : 1 test accuracy : 0.592382
Counter({0: 3019, 1: 2550, 2: 1831})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  144.44788771867752 Time :  4339
accuracy train: 0.724024 val: 0.611940 test: 0.658175
max validation accuracy : 0.611940 max acc epoch : 2 test accuracy : 0.658175
Counter({2: 2916, 0: 2678, 1: 1806})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.69469222426414 Time :  4364
accuracy train: 0.736929 val: 0.626866 test: 0.662627
max validation accuracy : 0.626866 max acc epoch : 3 test accuracy : 0.662627
Counter({1: 3226, 2: 2222, 0: 1952})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  97.21673953533173 Time :  4392
accuracy train: 0.811383 val: 0.665672 test: 0.697502
max validation accuracy : 0.665672 max acc epoch : 4 test accuracy : 0.697502
Counter({2: 3246, 1: 2598, 0: 1556})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.2617488950491 Time :  4425
accuracy train: 0.825943 val: 0.671642 test: 0.710116
max validation accuracy : 0.671642 max acc epoch : 5 test accuracy : 0.710116
Counter({0: 3331, 2: 2578, 1: 1491})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  86.4688660800457 Time :  4454
accuracy train: 0.833223 val: 0.674627 test: 0.707395
max validation accuracy : 0.674627 max acc epoch : 6 test accuracy : 0.707395
Counter({2: 3429, 1: 2493, 0: 1478})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  69.76815855503082 Time :  4484
accuracy train: 0.866314 val: 0.674627 test: 0.712342
max validation accuracy : 0.674627 max acc epoch : 6 test accuracy : 0.707395
Counter({2: 3436, 1: 2506, 0: 1458})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.68174716830254 Time :  4520
accuracy train: 0.862012 val: 0.680597 test: 0.714568
max validation accuracy : 0.680597 max acc epoch : 8 test accuracy : 0.714568
Counter({2: 3426, 1: 2513, 0: 1461})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.9719852656126 Time :  4546
accuracy train: 0.883852 val: 0.683582 test: 0.713579
max validation accuracy : 0.683582 max acc epoch : 9 test accuracy : 0.713579
Counter({0: 3435, 2: 2505, 1: 1460})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.3535293340683 Time :  4571
accuracy train: 0.883521 val: 0.671642 test: 0.713826
max validation accuracy : 0.683582 max acc epoch : 9 test accuracy : 0.713579
Counter({2: 3436, 1: 2503, 0: 1461})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  55.67797237634659 Time :  4597
accuracy train: 0.900728 val: 0.677612 test: 0.715063
max validation accuracy : 0.683582 max acc epoch : 9 test accuracy : 0.713579
Counter({0: 3437, 1: 2501, 2: 1462})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.65698225796223 Time :  4630
accuracy train: 0.900066 val: 0.671642 test: 0.716300
max validation accuracy : 0.683582 max acc epoch : 9 test accuracy : 0.713579
Counter({2: 3435, 1: 2504, 0: 1461})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  49.247267201542854 Time :  4656
accuracy train: 0.913633 val: 0.689552 test: 0.720010
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({2: 3435, 1: 2501, 0: 1464})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  48.78035481274128 Time :  4681
accuracy train: 0.923561 val: 0.680597 test: 0.717536
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({2: 3431, 1: 2506, 0: 1463})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  47.078397028148174 Time :  4708
accuracy train: 0.923891 val: 0.683582 test: 0.719021
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({0: 3433, 1: 2507, 2: 1460})

Epoch :  16 loss training:  46.947003439068794 Time :  4737
accuracy train: 0.926539 val: 0.686567 test: 0.720010
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({0: 3425, 2: 2510, 1: 1465})

Epoch :  17 loss training:  42.81971838325262 Time :  4767
accuracy train: 0.928855 val: 0.689552 test: 0.719763
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({2: 3432, 1: 2508, 0: 1460})

Epoch :  18 loss training:  43.71536149084568 Time :  4794
accuracy train: 0.932826 val: 0.686567 test: 0.723225
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({0: 3433, 2: 2506, 1: 1461})

Epoch :  19 loss training:  40.00420305132866 Time :  4822
accuracy train: 0.934811 val: 0.680597 test: 0.724462
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({1: 3427, 0: 2510, 2: 1463})

Epoch :  20 loss training:  42.27232501655817 Time :  4857
accuracy train: 0.941760 val: 0.686567 test: 0.722731
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({0: 3416, 2: 2520, 1: 1464})

Epoch :  21 loss training:  37.12437795102596 Time :  4892
accuracy train: 0.945069 val: 0.680597 test: 0.720752
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({2: 3408, 1: 2529, 0: 1463})

Epoch :  22 loss training:  40.30387511104345 Time :  4918
accuracy train: 0.945069 val: 0.689552 test: 0.722978
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({2: 3403, 1: 2541, 0: 1456})

Epoch :  23 loss training:  35.76734850555658 Time :  4945
accuracy train: 0.951357 val: 0.671642 test: 0.720752
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({2: 3404, 0: 2540, 1: 1456})

Epoch :  24 loss training:  36.20392818003893 Time :  4979
accuracy train: 0.951357 val: 0.683582 test: 0.722483
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({2: 3390, 1: 2546, 0: 1464})

Epoch :  25 loss training:  32.902850329875946 Time :  5014
accuracy train: 0.961284 val: 0.683582 test: 0.719515
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({2: 3391, 1: 2548, 0: 1461})

Epoch :  26 loss training:  34.87018669769168 Time :  5046
accuracy train: 0.965917 val: 0.686567 test: 0.719268
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({1: 3378, 2: 2557, 0: 1465})

Epoch :  27 loss training:  31.139346174895763 Time :  5083
accuracy train: 0.968233 val: 0.683582 test: 0.720505
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({1: 3383, 2: 2551, 0: 1466})

Epoch :  28 loss training:  33.020239658653736 Time :  5111
accuracy train: 0.967571 val: 0.680597 test: 0.723225
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({1: 3381, 0: 2554, 2: 1465})

Epoch :  29 loss training:  28.22335223853588 Time :  5135
accuracy train: 0.971542 val: 0.677612 test: 0.720999
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({2: 3380, 1: 2555, 0: 1465})

Epoch :  30 loss training:  29.321672655642033 Time :  5162
accuracy train: 0.972204 val: 0.680597 test: 0.722731
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({2: 3385, 1: 2553, 0: 1462})

Epoch :  31 loss training:  26.698945354670286 Time :  5193
accuracy train: 0.973197 val: 0.674627 test: 0.724215
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({2: 3396, 1: 2545, 0: 1459})

Epoch :  32 loss training:  27.35380559414625 Time :  5222
accuracy train: 0.976506 val: 0.683582 test: 0.724957
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({0: 3394, 2: 2549, 1: 1457})

Epoch :  33 loss training:  25.96002411097288 Time :  5248
accuracy train: 0.980146 val: 0.683582 test: 0.722236
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({0: 3403, 1: 2540, 2: 1457})

Epoch :  34 loss training:  26.23823694884777 Time :  5277
accuracy train: 0.978822 val: 0.686567 test: 0.722731
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({0: 3394, 1: 2552, 2: 1454})

Epoch :  35 loss training:  22.040572270751 Time :  5304
accuracy train: 0.982131 val: 0.686567 test: 0.723225
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({2: 3396, 1: 2550, 0: 1454})

Epoch :  36 loss training:  24.38432240113616 Time :  5347
accuracy train: 0.979815 val: 0.686567 test: 0.725946
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({2: 3390, 1: 2559, 0: 1451})

Epoch :  37 loss training:  21.722252510488033 Time :  5374
accuracy train: 0.985771 val: 0.671642 test: 0.721741
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({2: 3396, 1: 2555, 0: 1449})

Epoch :  38 loss training:  22.393883142620325 Time :  5399
accuracy train: 0.985771 val: 0.665672 test: 0.717042
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({0: 3396, 1: 2549, 2: 1455})

Epoch :  39 loss training:  19.92062759771943 Time :  5425
accuracy train: 0.989742 val: 0.671642 test: 0.723225
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({0: 3394, 1: 2549, 2: 1457})

Epoch :  40 loss training:  20.44752274826169 Time :  5450
accuracy train: 0.987426 val: 0.668657 test: 0.721247
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({0: 3394, 1: 2546, 2: 1460})

Epoch :  41 loss training:  18.035015758126974 Time :  5481
accuracy train: 0.991066 val: 0.677612 test: 0.719763
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({0: 3395, 2: 2548, 1: 1457})

Epoch :  42 loss training:  18.949130307883024 Time :  5511
accuracy train: 0.989080 val: 0.677612 test: 0.720999
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({1: 3387, 2: 2563, 0: 1450})

Epoch :  43 loss training:  16.50009572133422 Time :  5536
accuracy train: 0.992058 val: 0.680597 test: 0.720752
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({2: 3397, 1: 2555, 0: 1448})

Epoch :  44 loss training:  17.627115542069077 Time :  5565
accuracy train: 0.991066 val: 0.680597 test: 0.720505
max validation accuracy : 0.689552 max acc epoch : 13 test accuracy : 0.720010
Counter({2: 3391, 1: 2558, 0: 1451})

========================================================================================================================================================================================================
best acc epoch :  13
validation accuracy :  0.6895522388059702
test accuracy :  0.7200098936433341
last test_accuracy :  0.720504575810042
second best val :  0.6865671641791045
second best test :  0.7200098936433341
max gap 4
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=449, weight_decay=1e-10)
device :  cuda:0
Counter({0: 2586, 1: 2553, 2: 2261})

Epoch :  1 loss training:  208.37043756246567 Time :  5615
accuracy train: 0.618134 val: 0.546269 test: 0.586940
max validation accuracy : 0.546269 max acc epoch : 1 test accuracy : 0.586940
Counter({1: 2984, 0: 2640, 2: 1776})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  144.7802935242653 Time :  5655
accuracy train: 0.726340 val: 0.629851 test: 0.659411
max validation accuracy : 0.629851 max acc epoch : 2 test accuracy : 0.659411
Counter({1: 2945, 0: 2639, 2: 1816})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.08544754981995 Time :  5689
accuracy train: 0.738584 val: 0.629851 test: 0.662627
max validation accuracy : 0.629851 max acc epoch : 2 test accuracy : 0.659411
Counter({2: 3206, 1: 2643, 0: 1551})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  97.55646234750748 Time :  5714
accuracy train: 0.811052 val: 0.659701 test: 0.697997
max validation accuracy : 0.659701 max acc epoch : 4 test accuracy : 0.697997
Counter({2: 3409, 1: 2470, 0: 1521})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.16578434407711 Time :  5748
accuracy train: 0.825943 val: 0.674627 test: 0.711106
max validation accuracy : 0.674627 max acc epoch : 5 test accuracy : 0.711106
Counter({0: 3417, 2: 2490, 1: 1493})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  86.45825678110123 Time :  5781
accuracy train: 0.837194 val: 0.692537 test: 0.710611
max validation accuracy : 0.692537 max acc epoch : 6 test accuracy : 0.710611
Counter({2: 3516, 1: 2402, 0: 1482})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  69.73152454197407 Time :  5815
accuracy train: 0.867637 val: 0.689552 test: 0.716794
max validation accuracy : 0.692537 max acc epoch : 6 test accuracy : 0.710611
Counter({2: 3507, 1: 2425, 0: 1468})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.62745524942875 Time :  5852
accuracy train: 0.863005 val: 0.674627 test: 0.709622
max validation accuracy : 0.692537 max acc epoch : 6 test accuracy : 0.710611
Counter({1: 3472, 0: 2464, 2: 1464})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.79534129798412 Time :  5889
accuracy train: 0.883521 val: 0.692537 test: 0.715805
max validation accuracy : 0.692537 max acc epoch : 6 test accuracy : 0.710611
Counter({1: 3481, 2: 2458, 0: 1461})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.94989685714245 Time :  5931
accuracy train: 0.884844 val: 0.686567 test: 0.715558
max validation accuracy : 0.692537 max acc epoch : 6 test accuracy : 0.710611
Counter({0: 3482, 1: 2457, 2: 1461})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  56.08351904153824 Time :  5964
accuracy train: 0.899404 val: 0.680597 test: 0.718773
max validation accuracy : 0.692537 max acc epoch : 6 test accuracy : 0.710611
Counter({2: 3483, 1: 2450, 0: 1467})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.30071850121021 Time :  6001
accuracy train: 0.900066 val: 0.686567 test: 0.717536
max validation accuracy : 0.692537 max acc epoch : 6 test accuracy : 0.710611
Counter({0: 3477, 1: 2458, 2: 1465})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  49.66441237181425 Time :  6037
accuracy train: 0.914295 val: 0.677612 test: 0.720752
max validation accuracy : 0.692537 max acc epoch : 6 test accuracy : 0.710611
Counter({0: 3475, 1: 2456, 2: 1469})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  48.870186910033226 Time :  6079
accuracy train: 0.921244 val: 0.692537 test: 0.718526
max validation accuracy : 0.692537 max acc epoch : 6 test accuracy : 0.710611
Counter({2: 3470, 1: 2461, 0: 1469})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  47.3836537823081 Time :  6115
accuracy train: 0.923891 val: 0.680597 test: 0.720010
max validation accuracy : 0.692537 max acc epoch : 6 test accuracy : 0.710611
Counter({1: 3470, 2: 2460, 0: 1470})

Epoch :  16 loss training:  47.71670690178871 Time :  6153
accuracy train: 0.924884 val: 0.683582 test: 0.722483
max validation accuracy : 0.692537 max acc epoch : 6 test accuracy : 0.710611
Counter({2: 3464, 1: 2460, 0: 1476})

Epoch :  17 loss training:  43.219293765723705 Time :  6185
accuracy train: 0.929186 val: 0.680597 test: 0.720999
max validation accuracy : 0.692537 max acc epoch : 6 test accuracy : 0.710611
Counter({0: 3475, 1: 2448, 2: 1477})

Epoch :  18 loss training:  43.610326178371906 Time :  6225
accuracy train: 0.930841 val: 0.698507 test: 0.724215
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({0: 3480, 1: 2445, 2: 1475})

Epoch :  19 loss training:  40.34450776129961 Time :  6261
accuracy train: 0.936466 val: 0.686567 test: 0.724709
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({1: 3476, 2: 2448, 0: 1476})

Epoch :  20 loss training:  42.2538713440299 Time :  6301
accuracy train: 0.941099 val: 0.680597 test: 0.722483
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({2: 3469, 1: 2454, 0: 1477})

Epoch :  21 loss training:  37.213601879775524 Time :  6337
accuracy train: 0.941099 val: 0.680597 test: 0.721741
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({0: 3459, 1: 2460, 2: 1481})

Epoch :  22 loss training:  40.17628035694361 Time :  6370
accuracy train: 0.946062 val: 0.683582 test: 0.723225
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({2: 3455, 1: 2465, 0: 1480})

Epoch :  23 loss training:  35.88370117545128 Time :  6395
accuracy train: 0.949702 val: 0.680597 test: 0.723967
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({2: 3448, 1: 2469, 0: 1483})

Epoch :  24 loss training:  36.34325352311134 Time :  6421
accuracy train: 0.951688 val: 0.686567 test: 0.722236
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({1: 3436, 2: 2478, 0: 1486})

Epoch :  25 loss training:  33.534245662391186 Time :  6448
accuracy train: 0.957644 val: 0.683582 test: 0.723967
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({2: 3436, 1: 2476, 0: 1488})

Epoch :  26 loss training:  34.32554589211941 Time :  6472
accuracy train: 0.963600 val: 0.692537 test: 0.720257
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({2: 3415, 1: 2495, 0: 1490})

Epoch :  27 loss training:  31.369084112346172 Time :  6497
accuracy train: 0.966248 val: 0.689552 test: 0.723967
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({0: 3408, 1: 2500, 2: 1492})

Epoch :  28 loss training:  33.31600096076727 Time :  6523
accuracy train: 0.965586 val: 0.692537 test: 0.721741
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({2: 3415, 1: 2495, 0: 1490})

Epoch :  29 loss training:  28.362601544708014 Time :  6547
accuracy train: 0.971542 val: 0.683582 test: 0.722731
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({2: 3416, 1: 2495, 0: 1489})

Epoch :  30 loss training:  29.23107001185417 Time :  6572
accuracy train: 0.972535 val: 0.695522 test: 0.722978
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({1: 3422, 2: 2499, 0: 1479})

Epoch :  31 loss training:  26.703597616404295 Time :  6596
accuracy train: 0.971542 val: 0.680597 test: 0.726193
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({0: 3436, 1: 2489, 2: 1475})

Epoch :  32 loss training:  27.541392788290977 Time :  6620
accuracy train: 0.972866 val: 0.680597 test: 0.722236
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({1: 3441, 0: 2488, 2: 1471})

Epoch :  33 loss training:  26.092676728963852 Time :  6645
accuracy train: 0.980477 val: 0.683582 test: 0.725204
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({2: 3443, 1: 2487, 0: 1470})

Epoch :  34 loss training:  26.134212121367455 Time :  6670
accuracy train: 0.978160 val: 0.695522 test: 0.723225
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({2: 3433, 1: 2502, 0: 1465})

Epoch :  35 loss training:  22.432126954197884 Time :  6695
accuracy train: 0.981469 val: 0.692537 test: 0.724957
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({0: 3441, 1: 2496, 2: 1463})

Epoch :  36 loss training:  25.396894372999668 Time :  6721
accuracy train: 0.980807 val: 0.695522 test: 0.723473
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({1: 3437, 0: 2502, 2: 1461})

Epoch :  37 loss training:  21.061369098722935 Time :  6746
accuracy train: 0.985109 val: 0.689552 test: 0.724957
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({0: 3443, 1: 2500, 2: 1457})

Epoch :  38 loss training:  22.398129906505346 Time :  6772
accuracy train: 0.985109 val: 0.689552 test: 0.723473
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({1: 3439, 2: 2500, 0: 1461})

Epoch :  39 loss training:  19.585819508880377 Time :  6799
accuracy train: 0.988087 val: 0.689552 test: 0.722483
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({2: 3442, 1: 2500, 0: 1458})

Epoch :  40 loss training:  20.55697574093938 Time :  6824
accuracy train: 0.988418 val: 0.698507 test: 0.723473
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({0: 3454, 1: 2491, 2: 1455})

Epoch :  41 loss training:  17.16377580538392 Time :  6850
accuracy train: 0.989742 val: 0.686567 test: 0.722978
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({2: 3446, 1: 2497, 0: 1457})

Epoch :  42 loss training:  19.66417063213885 Time :  6877
accuracy train: 0.990404 val: 0.680597 test: 0.721989
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({2: 3426, 1: 2523, 0: 1451})

Epoch :  43 loss training:  16.373535305261612 Time :  6901
accuracy train: 0.992058 val: 0.686567 test: 0.727183
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({1: 3427, 0: 2519, 2: 1454})

Epoch :  44 loss training:  17.398832527920604 Time :  6926
accuracy train: 0.991727 val: 0.686567 test: 0.723967
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({0: 3431, 1: 2520, 2: 1449})

Epoch :  45 loss training:  15.907269913703203 Time :  6952
accuracy train: 0.994375 val: 0.677612 test: 0.723720
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({2: 3434, 1: 2515, 0: 1451})

Epoch :  46 loss training:  16.630971617996693 Time :  6977
accuracy train: 0.995036 val: 0.683582 test: 0.722236
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({0: 3429, 1: 2515, 2: 1456})

Epoch :  47 loss training:  14.644164096564054 Time :  7002
accuracy train: 0.997022 val: 0.671642 test: 0.722978
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({2: 3438, 1: 2508, 0: 1454})

Epoch :  48 loss training:  15.3691798876971 Time :  7028
accuracy train: 0.996360 val: 0.686567 test: 0.726935
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({1: 3431, 2: 2517, 0: 1452})

Epoch :  49 loss training:  12.838803708553314 Time :  7052
accuracy train: 0.998345 val: 0.680597 test: 0.725451
max validation accuracy : 0.698507 max acc epoch : 18 test accuracy : 0.724215
Counter({2: 3429, 1: 2516, 0: 1455})

========================================================================================================================================================================================================
best acc epoch :  18
validation accuracy :  0.6985074626865672
test accuracy :  0.7242146920603513
last test_accuracy :  0.725451397477121
second best val :  0.6955223880597015
second best test :  0.7242146920603513
max gap 12
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=449, weight_decay=1e-10)
device :  cuda:0
Counter({0: 2586, 1: 2553, 2: 2261})

Epoch :  1 loss training:  208.6376976966858 Time :  7098
accuracy train: 0.621774 val: 0.558209 test: 0.592629
max validation accuracy : 0.558209 max acc epoch : 1 test accuracy : 0.592629
Counter({2: 2984, 1: 2729, 0: 1687})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  144.69384336471558 Time :  7132
accuracy train: 0.723362 val: 0.600000 test: 0.654217
max validation accuracy : 0.600000 max acc epoch : 2 test accuracy : 0.654217
Counter({0: 2768, 2: 2694, 1: 1938})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.57657670974731 Time :  7158
accuracy train: 0.746195 val: 0.635821 test: 0.665842
max validation accuracy : 0.635821 max acc epoch : 3 test accuracy : 0.665842
Counter({1: 3057, 0: 2429, 2: 1914})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  97.53405475616455 Time :  7182
accuracy train: 0.811714 val: 0.665672 test: 0.701707
max validation accuracy : 0.665672 max acc epoch : 4 test accuracy : 0.701707
Counter({0: 2754, 1: 2746, 2: 1900})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  89.7492016851902 Time :  7208
accuracy train: 0.826274 val: 0.671642 test: 0.704427
max validation accuracy : 0.671642 max acc epoch : 5 test accuracy : 0.704427
Counter({1: 2768, 2: 2703, 0: 1929})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  87.41083085536957 Time :  7233
accuracy train: 0.828921 val: 0.674627 test: 0.699975
max validation accuracy : 0.674627 max acc epoch : 6 test accuracy : 0.699975
Counter({2: 2777, 0: 2735, 1: 1888})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.40127724409103 Time :  7256
accuracy train: 0.861350 val: 0.689552 test: 0.708880
max validation accuracy : 0.689552 max acc epoch : 7 test accuracy : 0.708880
Counter({0: 2757, 1: 2735, 2: 1908})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.96380339562893 Time :  7283
accuracy train: 0.862674 val: 0.671642 test: 0.704922
max validation accuracy : 0.689552 max acc epoch : 7 test accuracy : 0.708880
Counter({1: 2755, 0: 2723, 2: 1922})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.84842999279499 Time :  7311
accuracy train: 0.886499 val: 0.701493 test: 0.712342
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.712342
Counter({1: 2754, 0: 2719, 2: 1927})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  61.319458693265915 Time :  7337
accuracy train: 0.886168 val: 0.677612 test: 0.709869
max validation accuracy : 0.701493 max acc epoch : 9 test accuracy : 0.712342
Counter({1: 2760, 0: 2723, 2: 1917})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  56.724641643464565 Time :  7361
accuracy train: 0.899735 val: 0.704478 test: 0.715310
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({1: 2756, 0: 2730, 2: 1914})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  55.03402051329613 Time :  7387
accuracy train: 0.896095 val: 0.689552 test: 0.715805
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({2: 2762, 0: 2734, 1: 1904})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  50.149335861206055 Time :  7414
accuracy train: 0.910324 val: 0.698507 test: 0.714816
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({2: 2759, 0: 2738, 1: 1903})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  50.629220351576805 Time :  7441
accuracy train: 0.916612 val: 0.692537 test: 0.714816
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({1: 2759, 0: 2741, 2: 1900})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  45.854565754532814 Time :  7467
accuracy train: 0.918266 val: 0.704478 test: 0.717784
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({1: 2761, 2: 2744, 0: 1895})

Epoch :  16 loss training:  46.70037071406841 Time :  7493
accuracy train: 0.918597 val: 0.695522 test: 0.717784
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({2: 2761, 0: 2746, 1: 1893})

Epoch :  17 loss training:  42.95260887593031 Time :  7521
accuracy train: 0.928193 val: 0.698507 test: 0.718031
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({2: 2762, 0: 2746, 1: 1892})

Epoch :  18 loss training:  43.95604273676872 Time :  7547
accuracy train: 0.925877 val: 0.692537 test: 0.719021
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({1: 2769, 0: 2738, 2: 1893})

Epoch :  19 loss training:  40.512623615562916 Time :  7571
accuracy train: 0.935142 val: 0.692537 test: 0.718031
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({1: 2768, 0: 2739, 2: 1893})

Epoch :  20 loss training:  41.717063166201115 Time :  7595
accuracy train: 0.937459 val: 0.683582 test: 0.713579
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({1: 2767, 0: 2747, 2: 1886})

Epoch :  21 loss training:  37.88395667821169 Time :  7621
accuracy train: 0.940106 val: 0.686567 test: 0.718279
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({1: 2767, 0: 2746, 2: 1887})

Epoch :  22 loss training:  39.83823023736477 Time :  7646
accuracy train: 0.944739 val: 0.695522 test: 0.717784
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({2: 2761, 0: 2751, 1: 1888})

Epoch :  23 loss training:  35.51267632842064 Time :  7670
accuracy train: 0.949702 val: 0.704478 test: 0.720505
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({2: 2762, 0: 2753, 1: 1885})

Epoch :  24 loss training:  36.54579646140337 Time :  7698
accuracy train: 0.948048 val: 0.680597 test: 0.720752
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({1: 2769, 2: 2746, 0: 1885})

Epoch :  25 loss training:  32.5251002907753 Time :  7724
accuracy train: 0.955328 val: 0.692537 test: 0.720010
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({1: 2768, 2: 2746, 0: 1886})

Epoch :  26 loss training:  34.48090686649084 Time :  7751
accuracy train: 0.959629 val: 0.680597 test: 0.717536
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({1: 2765, 0: 2747, 2: 1888})

Epoch :  27 loss training:  31.08878118544817 Time :  7775
accuracy train: 0.965255 val: 0.689552 test: 0.717289
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({2: 2760, 0: 2758, 1: 1882})

Epoch :  28 loss training:  32.98645544052124 Time :  7798
accuracy train: 0.966248 val: 0.686567 test: 0.716794
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({0: 2769, 1: 2757, 2: 1874})

Epoch :  29 loss training:  28.275690659880638 Time :  7824
accuracy train: 0.967240 val: 0.704478 test: 0.720257
max validation accuracy : 0.704478 max acc epoch : 11 test accuracy : 0.715310
Counter({2: 2771, 0: 2745, 1: 1884})

Epoch :  30 loss training:  30.96148196607828 Time :  7849
accuracy train: 0.971873 val: 0.707463 test: 0.722236
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2767, 2: 2758, 1: 1875})

Epoch :  31 loss training:  26.872097983956337 Time :  7875
accuracy train: 0.973858 val: 0.692537 test: 0.720752
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2767, 1: 2756, 2: 1877})

Epoch :  32 loss training:  27.507980711758137 Time :  7900
accuracy train: 0.971873 val: 0.689552 test: 0.722483
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({1: 2772, 2: 2751, 0: 1877})

Epoch :  33 loss training:  24.30477659776807 Time :  7924
accuracy train: 0.976506 val: 0.686567 test: 0.724215
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({1: 2775, 2: 2750, 0: 1875})

Epoch :  34 loss training:  27.696264289319515 Time :  7948
accuracy train: 0.975513 val: 0.680597 test: 0.725451
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2803, 1: 2733, 2: 1864})

Epoch :  35 loss training:  22.701563933864236 Time :  7973
accuracy train: 0.981800 val: 0.692537 test: 0.720752
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2803, 1: 2727, 2: 1870})

Epoch :  36 loss training:  24.88816711679101 Time :  7996
accuracy train: 0.978160 val: 0.698507 test: 0.722731
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2799, 2: 2732, 1: 1869})

Epoch :  37 loss training:  21.56073833629489 Time :  8022
accuracy train: 0.986102 val: 0.692537 test: 0.720505
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({2: 2803, 1: 2733, 0: 1864})

Epoch :  38 loss training:  22.396228671073914 Time :  8045
accuracy train: 0.984778 val: 0.707463 test: 0.721741
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({2: 2810, 1: 2732, 0: 1858})

Epoch :  39 loss training:  19.204207181930542 Time :  8070
accuracy train: 0.989080 val: 0.686567 test: 0.720752
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({1: 2806, 2: 2736, 0: 1858})

Epoch :  40 loss training:  20.9380605481565 Time :  8094
accuracy train: 0.986102 val: 0.695522 test: 0.721247
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2811, 1: 2734, 2: 1855})

Epoch :  41 loss training:  17.550241012126207 Time :  8118
accuracy train: 0.990404 val: 0.689552 test: 0.724215
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2808, 1: 2735, 2: 1857})

Epoch :  42 loss training:  19.835138510912657 Time :  8141
accuracy train: 0.987095 val: 0.689552 test: 0.720999
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2805, 1: 2739, 2: 1856})

Epoch :  43 loss training:  15.983927235007286 Time :  8165
accuracy train: 0.991727 val: 0.689552 test: 0.723720
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2806, 1: 2744, 2: 1850})

Epoch :  44 loss training:  19.026108983904123 Time :  8189
accuracy train: 0.992389 val: 0.686567 test: 0.719268
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2807, 2: 2746, 1: 1847})

Epoch :  45 loss training:  15.954831639304757 Time :  8213
accuracy train: 0.992058 val: 0.692537 test: 0.723967
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({2: 2804, 1: 2747, 0: 1849})

Epoch :  46 loss training:  16.558685638010502 Time :  8238
accuracy train: 0.994044 val: 0.680597 test: 0.721741
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({2: 2800, 0: 2754, 1: 1846})

Epoch :  47 loss training:  13.742001431062818 Time :  8264
accuracy train: 0.993713 val: 0.689552 test: 0.723720
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2798, 2: 2754, 1: 1848})

Epoch :  48 loss training:  15.49414475262165 Time :  8288
accuracy train: 0.994705 val: 0.692537 test: 0.723967
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({2: 2794, 1: 2762, 0: 1844})

Epoch :  49 loss training:  13.037481375038624 Time :  8314
accuracy train: 0.995367 val: 0.695522 test: 0.723225
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({1: 2790, 2: 2759, 0: 1851})

Epoch :  50 loss training:  14.488904081285 Time :  8350
accuracy train: 0.995367 val: 0.689552 test: 0.727677
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({1: 2792, 2: 2748, 0: 1860})

Epoch :  51 loss training:  11.340122237801552 Time :  8385
accuracy train: 0.997684 val: 0.683582 test: 0.725946
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2797, 1: 2745, 2: 1858})

Epoch :  52 loss training:  13.207146897912025 Time :  8411
accuracy train: 0.998015 val: 0.689552 test: 0.724462
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2796, 1: 2750, 2: 1854})

Epoch :  53 loss training:  10.92742015235126 Time :  8435
accuracy train: 0.999007 val: 0.677612 test: 0.722236
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2796, 1: 2750, 2: 1854})

Epoch :  54 loss training:  12.086040774360299 Time :  8460
accuracy train: 0.997022 val: 0.680597 test: 0.722483
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2792, 1: 2751, 2: 1857})

Epoch :  55 loss training:  11.465748123824596 Time :  8486
accuracy train: 0.998676 val: 0.686567 test: 0.722483
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({2: 2788, 0: 2754, 1: 1858})

Epoch :  56 loss training:  11.289909245446324 Time :  8510
accuracy train: 0.999007 val: 0.680597 test: 0.721247
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2785, 2: 2764, 1: 1851})

Epoch :  57 loss training:  9.477343246340752 Time :  8534
accuracy train: 0.999669 val: 0.686567 test: 0.720010
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({2: 2784, 1: 2763, 0: 1853})

Epoch :  58 loss training:  9.945971675217152 Time :  8559
accuracy train: 0.999338 val: 0.686567 test: 0.722236
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2795, 2: 2763, 1: 1842})

Epoch :  59 loss training:  7.787401759065688 Time :  8583
accuracy train: 0.998676 val: 0.683582 test: 0.725204
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2794, 2: 2765, 1: 1841})

Epoch :  60 loss training:  9.670060609467328 Time :  8608
accuracy train: 0.999669 val: 0.695522 test: 0.719763
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({2: 2799, 0: 2769, 1: 1832})

Epoch :  61 loss training:  7.949217347893864 Time :  8631
accuracy train: 1.000000 val: 0.689552 test: 0.721247
max validation accuracy : 0.707463 max acc epoch : 30 test accuracy : 0.722236
Counter({0: 2794, 1: 2772, 2: 1834})

========================================================================================================================================================================================================
best acc epoch :  30
validation accuracy :  0.7074626865671642
test accuracy :  0.7222359633935197
last test_accuracy :  0.7212465990601039
second best val :  0.7044776119402985
second best test :  0.7153104130596092
max gap 19
========================================================================================================================================================================================================

itr : 6
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=449, weight_decay=1e-10)
device :  cuda:0
Counter({0: 2586, 1: 2553, 2: 2261})

Epoch :  1 loss training:  208.6046203970909 Time :  8659
accuracy train: 0.622766 val: 0.561194 test: 0.594361
max validation accuracy : 0.561194 max acc epoch : 1 test accuracy : 0.594361
Counter({0: 2933, 1: 2632, 2: 1835})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  144.42635768651962 Time :  8683
accuracy train: 0.724355 val: 0.617910 test: 0.656443
max validation accuracy : 0.617910 max acc epoch : 2 test accuracy : 0.656443
Counter({1: 2839, 0: 2729, 2: 1832})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  121.39053028821945 Time :  8709
accuracy train: 0.732958 val: 0.632836 test: 0.662379
max validation accuracy : 0.632836 max acc epoch : 3 test accuracy : 0.662379
Counter({2: 3284, 0: 2226, 1: 1890})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  97.6019631922245 Time :  8733
accuracy train: 0.808405 val: 0.659701 test: 0.698986
max validation accuracy : 0.659701 max acc epoch : 4 test accuracy : 0.698986
Counter({1: 2856, 0: 2629, 2: 1915})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.43537659943104 Time :  8758
accuracy train: 0.821972 val: 0.668657 test: 0.710858
max validation accuracy : 0.668657 max acc epoch : 5 test accuracy : 0.710858
Counter({1: 2862, 0: 2619, 2: 1919})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  86.23962467908859 Time :  8781
accuracy train: 0.830576 val: 0.668657 test: 0.710116
max validation accuracy : 0.668657 max acc epoch : 5 test accuracy : 0.710858
Counter({1: 2810, 2: 2679, 0: 1911})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  70.3637135475874 Time :  8808
accuracy train: 0.868299 val: 0.683582 test: 0.717289
max validation accuracy : 0.683582 max acc epoch : 7 test accuracy : 0.717289
Counter({2: 2807, 0: 2711, 1: 1882})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.80350515246391 Time :  8834
accuracy train: 0.856386 val: 0.671642 test: 0.709127
max validation accuracy : 0.683582 max acc epoch : 7 test accuracy : 0.717289
Counter({1: 2816, 0: 2712, 2: 1872})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.7630480080843 Time :  8859
accuracy train: 0.881535 val: 0.698507 test: 0.712590
max validation accuracy : 0.698507 max acc epoch : 9 test accuracy : 0.712590
Counter({1: 2815, 0: 2716, 2: 1869})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  60.33880095183849 Time :  8884
accuracy train: 0.877895 val: 0.680597 test: 0.715310
max validation accuracy : 0.698507 max acc epoch : 9 test accuracy : 0.712590
Counter({2: 2801, 0: 2736, 1: 1863})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  56.22431603074074 Time :  8909
accuracy train: 0.899735 val: 0.698507 test: 0.714568
max validation accuracy : 0.698507 max acc epoch : 9 test accuracy : 0.712590
Counter({2: 2792, 0: 2740, 1: 1868})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.620472110807896 Time :  8933
accuracy train: 0.893448 val: 0.683582 test: 0.715558
max validation accuracy : 0.698507 max acc epoch : 9 test accuracy : 0.712590
Counter({2: 2800, 0: 2735, 1: 1865})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  49.146349743008614 Time :  8957
accuracy train: 0.911648 val: 0.698507 test: 0.719268
max validation accuracy : 0.698507 max acc epoch : 9 test accuracy : 0.712590
Counter({2: 2788, 0: 2747, 1: 1865})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  48.900297716259956 Time :  8982
accuracy train: 0.919259 val: 0.680597 test: 0.716052
max validation accuracy : 0.698507 max acc epoch : 9 test accuracy : 0.712590
Counter({1: 2784, 0: 2749, 2: 1867})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  47.177178867161274 Time :  9006
accuracy train: 0.920251 val: 0.698507 test: 0.719021
max validation accuracy : 0.698507 max acc epoch : 9 test accuracy : 0.712590
Counter({1: 2779, 2: 2755, 0: 1866})

Epoch :  16 loss training:  46.702096581459045 Time :  9032
accuracy train: 0.926208 val: 0.704478 test: 0.719515
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({0: 2775, 2: 2764, 1: 1861})

Epoch :  17 loss training:  43.97442350536585 Time :  9056
accuracy train: 0.931502 val: 0.701493 test: 0.721741
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({0: 2771, 1: 2764, 2: 1865})

Epoch :  18 loss training:  44.91322773694992 Time :  9080
accuracy train: 0.931502 val: 0.689552 test: 0.720752
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({2: 2770, 0: 2769, 1: 1861})

Epoch :  19 loss training:  41.342774614691734 Time :  9104
accuracy train: 0.940106 val: 0.692537 test: 0.721247
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({0: 2772, 1: 2769, 2: 1859})

Epoch :  20 loss training:  42.903522826731205 Time :  9128
accuracy train: 0.942422 val: 0.698507 test: 0.719763
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({2: 2778, 0: 2765, 1: 1857})

Epoch :  21 loss training:  37.564032793045044 Time :  9154
accuracy train: 0.943746 val: 0.695522 test: 0.724215
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({2: 2782, 1: 2761, 0: 1857})

Epoch :  22 loss training:  39.21645434200764 Time :  9178
accuracy train: 0.944408 val: 0.680597 test: 0.719021
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({2: 2779, 1: 2765, 0: 1856})

Epoch :  23 loss training:  35.14365962892771 Time :  9204
accuracy train: 0.951688 val: 0.683582 test: 0.722236
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({0: 2778, 1: 2764, 2: 1858})

Epoch :  24 loss training:  36.15359625220299 Time :  9231
accuracy train: 0.955989 val: 0.680597 test: 0.719021
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({1: 2774, 2: 2766, 0: 1860})

Epoch :  25 loss training:  32.23948247730732 Time :  9257
accuracy train: 0.958637 val: 0.686567 test: 0.723967
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({0: 2774, 2: 2761, 1: 1865})

Epoch :  26 loss training:  34.26352831721306 Time :  9283
accuracy train: 0.958306 val: 0.692537 test: 0.720010
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({0: 2768, 1: 2761, 2: 1871})

Epoch :  27 loss training:  30.549010656774044 Time :  9308
accuracy train: 0.964924 val: 0.692537 test: 0.722731
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({2: 2767, 1: 2762, 0: 1871})

Epoch :  28 loss training:  32.76781265437603 Time :  9335
accuracy train: 0.969557 val: 0.689552 test: 0.719021
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({2: 2774, 1: 2764, 0: 1862})

Epoch :  29 loss training:  28.512214794754982 Time :  9363
accuracy train: 0.968233 val: 0.692537 test: 0.724709
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({0: 2772, 2: 2764, 1: 1864})

Epoch :  30 loss training:  30.325049325823784 Time :  9390
accuracy train: 0.969887 val: 0.701493 test: 0.722236
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({1: 2775, 0: 2769, 2: 1856})

Epoch :  31 loss training:  26.86640927195549 Time :  9416
accuracy train: 0.976506 val: 0.695522 test: 0.727183
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({0: 2779, 1: 2768, 2: 1853})

Epoch :  32 loss training:  27.770998060703278 Time :  9442
accuracy train: 0.972866 val: 0.689552 test: 0.724709
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({0: 2785, 1: 2762, 2: 1853})

Epoch :  33 loss training:  24.700279984623194 Time :  9468
accuracy train: 0.978822 val: 0.689552 test: 0.727183
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({1: 2792, 2: 2758, 0: 1850})

Epoch :  34 loss training:  27.521056160330772 Time :  9494
accuracy train: 0.976506 val: 0.689552 test: 0.722978
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({0: 2812, 2: 2749, 1: 1839})

Epoch :  35 loss training:  22.66507215425372 Time :  9521
accuracy train: 0.984447 val: 0.692537 test: 0.723225
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({2: 2814, 0: 2749, 1: 1837})

Epoch :  36 loss training:  24.29789500683546 Time :  9546
accuracy train: 0.981469 val: 0.692537 test: 0.722978
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({0: 2810, 2: 2756, 1: 1834})

Epoch :  37 loss training:  21.975257351994514 Time :  9571
accuracy train: 0.986764 val: 0.686567 test: 0.725204
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({0: 2811, 1: 2757, 2: 1832})

Epoch :  38 loss training:  22.031771775335073 Time :  9599
accuracy train: 0.986764 val: 0.689552 test: 0.724215
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({2: 2811, 1: 2753, 0: 1836})

Epoch :  39 loss training:  19.841429898515344 Time :  9630
accuracy train: 0.990735 val: 0.683582 test: 0.728419
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({0: 2808, 1: 2760, 2: 1832})

Epoch :  40 loss training:  20.628305515274405 Time :  9659
accuracy train: 0.988418 val: 0.692537 test: 0.728667
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({0: 2805, 2: 2764, 1: 1831})

Epoch :  41 loss training:  17.28333793208003 Time :  9685
accuracy train: 0.992389 val: 0.680597 test: 0.731388
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({0: 2804, 1: 2765, 2: 1831})

Epoch :  42 loss training:  19.665659096091986 Time :  9711
accuracy train: 0.989411 val: 0.692537 test: 0.724215
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({0: 2795, 1: 2773, 2: 1832})

Epoch :  43 loss training:  15.98232752084732 Time :  9736
accuracy train: 0.994375 val: 0.683582 test: 0.728172
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({0: 2790, 1: 2781, 2: 1829})

Epoch :  44 loss training:  18.71127263084054 Time :  9761
accuracy train: 0.994044 val: 0.680597 test: 0.721494
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({1: 2787, 0: 2784, 2: 1829})

Epoch :  45 loss training:  15.441936288028955 Time :  9788
accuracy train: 0.995367 val: 0.695522 test: 0.726935
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({2: 2792, 0: 2783, 1: 1825})

Epoch :  46 loss training:  16.559445375576615 Time :  9815
accuracy train: 0.996029 val: 0.674627 test: 0.723967
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({1: 2799, 2: 2777, 0: 1824})

Epoch :  47 loss training:  14.065042193979025 Time :  9841
accuracy train: 0.995036 val: 0.686567 test: 0.725946
max validation accuracy : 0.704478 max acc epoch : 16 test accuracy : 0.719515
Counter({1: 2805, 0: 2775, 2: 1820})

========================================================================================================================================================================================================
best acc epoch :  16
validation accuracy :  0.7044776119402985
test accuracy :  0.7195152114766262
last test_accuracy :  0.7259460796438288
second best val :  0.7014925373134329
second best test :  0.7195152114766262
max gap 7
========================================================================================================================================================================================================

itr : 7
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.3, early_stop=30, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=3, num_exp=10, num_layers=3, num_mlp_layers=1, random_vec=False, seed=449, weight_decay=1e-10)
device :  cuda:0
Counter({0: 2586, 1: 2553, 2: 2261})

Epoch :  1 loss training:  208.1803742647171 Time :  9871
accuracy train: 0.620450 val: 0.552239 test: 0.589661
max validation accuracy : 0.552239 max acc epoch : 1 test accuracy : 0.589661
Counter({0: 3027, 2: 2738, 1: 1635})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  144.30785363912582 Time :  9897
accuracy train: 0.726340 val: 0.620896 test: 0.656443
max validation accuracy : 0.620896 max acc epoch : 2 test accuracy : 0.656443
Counter({1: 2748, 2: 2718, 0: 1934})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  122.30270874500275 Time :  9921
accuracy train: 0.739246 val: 0.626866 test: 0.659411
max validation accuracy : 0.626866 max acc epoch : 3 test accuracy : 0.659411
Counter({2: 3154, 1: 2718, 0: 1528})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  97.301962018013 Time :  9944
accuracy train: 0.812376 val: 0.662687 test: 0.701707
max validation accuracy : 0.662687 max acc epoch : 4 test accuracy : 0.701707
Counter({0: 3333, 2: 2564, 1: 1503})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  88.61929151415825 Time :  9969
accuracy train: 0.823958 val: 0.680597 test: 0.711600
max validation accuracy : 0.680597 max acc epoch : 5 test accuracy : 0.711600
Counter({2: 3352, 1: 2565, 0: 1483})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  86.15950897336006 Time :  9992
accuracy train: 0.833554 val: 0.665672 test: 0.708632
max validation accuracy : 0.680597 max acc epoch : 5 test accuracy : 0.711600
Counter({2: 3407, 1: 2504, 0: 1489})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  69.88383361697197 Time :  10016
accuracy train: 0.866314 val: 0.686567 test: 0.707148
max validation accuracy : 0.686567 max acc epoch : 7 test accuracy : 0.707148
Counter({2: 3403, 1: 2512, 0: 1485})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  68.41440792381763 Time :  10040
accuracy train: 0.859034 val: 0.683582 test: 0.707890
max validation accuracy : 0.686567 max acc epoch : 7 test accuracy : 0.707148
Counter({2: 3371, 1: 2546, 0: 1483})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  64.84145620465279 Time :  10065
accuracy train: 0.884514 val: 0.683582 test: 0.710116
max validation accuracy : 0.686567 max acc epoch : 7 test accuracy : 0.707148
Counter({2: 3374, 1: 2550, 0: 1476})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  59.984752863645554 Time :  10090
accuracy train: 0.881205 val: 0.680597 test: 0.709622
max validation accuracy : 0.686567 max acc epoch : 7 test accuracy : 0.707148
Counter({1: 3368, 2: 2555, 0: 1477})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  56.24815756082535 Time :  10117
accuracy train: 0.901721 val: 0.689552 test: 0.716052
max validation accuracy : 0.689552 max acc epoch : 11 test accuracy : 0.716052
Counter({2: 3364, 1: 2557, 0: 1479})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  54.80915275961161 Time :  10142
accuracy train: 0.902383 val: 0.695522 test: 0.714321
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({0: 3349, 2: 2569, 1: 1482})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  49.33497814834118 Time :  10166
accuracy train: 0.913302 val: 0.686567 test: 0.717784
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({1: 3347, 2: 2569, 0: 1484})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  48.58040951192379 Time :  10191
accuracy train: 0.919259 val: 0.692537 test: 0.716547
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3341, 1: 2574, 0: 1485})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  47.37040163576603 Time :  10215
accuracy train: 0.922899 val: 0.686567 test: 0.720752
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3337, 1: 2576, 0: 1487})

Epoch :  16 loss training:  47.39402347803116 Time :  10239
accuracy train: 0.926539 val: 0.686567 test: 0.718773
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3327, 1: 2580, 0: 1493})

Epoch :  17 loss training:  42.84614658355713 Time :  10274
accuracy train: 0.930510 val: 0.680597 test: 0.718526
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({0: 3327, 1: 2576, 2: 1497})

Epoch :  18 loss training:  42.9350616261363 Time :  10304
accuracy train: 0.931833 val: 0.689552 test: 0.721741
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3342, 1: 2559, 0: 1499})

Epoch :  19 loss training:  40.498567178845406 Time :  10328
accuracy train: 0.934150 val: 0.686567 test: 0.724462
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({0: 3343, 1: 2562, 2: 1495})

Epoch :  20 loss training:  42.21160866320133 Time :  10352
accuracy train: 0.940768 val: 0.677612 test: 0.720999
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({0: 3342, 1: 2564, 2: 1494})

Epoch :  21 loss training:  37.040336452424526 Time :  10378
accuracy train: 0.943084 val: 0.686567 test: 0.720257
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({0: 3343, 2: 2564, 1: 1493})

Epoch :  22 loss training:  40.27007430046797 Time :  10406
accuracy train: 0.943746 val: 0.695522 test: 0.723473
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({0: 3343, 1: 2563, 2: 1494})

Epoch :  23 loss training:  36.018907487392426 Time :  10431
accuracy train: 0.949040 val: 0.686567 test: 0.721247
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3336, 1: 2564, 0: 1500})

Epoch :  24 loss training:  35.99254033714533 Time :  10454
accuracy train: 0.948379 val: 0.683582 test: 0.722978
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({0: 3326, 2: 2573, 1: 1501})

Epoch :  25 loss training:  33.172208994627 Time :  10479
accuracy train: 0.960291 val: 0.680597 test: 0.721741
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3326, 1: 2571, 0: 1503})

Epoch :  26 loss training:  34.49139266088605 Time :  10503
accuracy train: 0.960291 val: 0.692537 test: 0.717784
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3316, 1: 2580, 0: 1504})

Epoch :  27 loss training:  31.372892819344997 Time :  10527
accuracy train: 0.967571 val: 0.686567 test: 0.720999
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3316, 1: 2577, 0: 1507})

Epoch :  28 loss training:  33.09475377947092 Time :  10556
accuracy train: 0.968895 val: 0.680597 test: 0.721989
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({1: 3308, 2: 2581, 0: 1511})

Epoch :  29 loss training:  28.681061021983624 Time :  10585
accuracy train: 0.972204 val: 0.686567 test: 0.721494
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3314, 1: 2578, 0: 1508})

Epoch :  30 loss training:  29.30202116444707 Time :  10620
accuracy train: 0.974851 val: 0.689552 test: 0.723473
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3319, 1: 2575, 0: 1506})

Epoch :  31 loss training:  27.114267103374004 Time :  10652
accuracy train: 0.974851 val: 0.695522 test: 0.723473
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3324, 1: 2573, 0: 1503})

Epoch :  32 loss training:  27.491548277437687 Time :  10676
accuracy train: 0.977498 val: 0.686567 test: 0.720752
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3333, 1: 2575, 0: 1492})

Epoch :  33 loss training:  25.974548865109682 Time :  10699
accuracy train: 0.980807 val: 0.683582 test: 0.726193
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({2: 3330, 1: 2574, 0: 1496})

Epoch :  34 loss training:  25.999069783836603 Time :  10724
accuracy train: 0.977498 val: 0.689552 test: 0.726441
max validation accuracy : 0.695522 max acc epoch : 12 test accuracy : 0.714321
Counter({0: 3328, 2: 2580, 1: 1492})

slurmstepd: error: *** JOB 37221 ON cl-gpusrv1 CANCELLED AT 2021-06-11T23:49:04 ***
