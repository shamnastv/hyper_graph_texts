

date and time :  Thu Apr 29 10:44:52 2021
Namespace(batch_size=32, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
min_len_of_sentence : 1
max_len_of_sentence : 7408
min_num_of_sentence : 7
max_num_of_sentence : 21895
average_len_of_sentence: 5.831122391605742
average_num_of_sentence: 140.61349888570518
Total_num_of_sentence : 2650002
Counter({'rec.sport.hockey': 999, 'soc.religion.christian': 997, 'rec.motorcycles': 996, 'rec.sport.baseball': 994, 'sci.crypt': 991, 'rec.autos': 990, 'sci.med': 990, 'comp.windows.x': 988, 'sci.space': 987, 'comp.os.ms-windows.misc': 985, 'sci.electronics': 984, 'comp.sys.ibm.pc.hardware': 982, 'misc.forsale': 975, 'comp.graphics': 973, 'comp.sys.mac.hardware': 963, 'talk.politics.mideast': 940, 'talk.politics.guns': 910, 'alt.atheism': 799, 'talk.politics.misc': 775, 'talk.religion.misc': 628})
Total_number_of_words: 39033
Total_number_of_categories: 20
vocab size : 39033
got embeddings of : 30907

Epoch :  1 loss training:  656.2245582938194 Time :  302
accuracy train: 0.810076 val: 0.780725 test: 0.740308
max validation accuracy : 0.780725 max acc epoch : 1 test accuracy : 0.740308
Epoch-1 lr: 0.001

Epoch :  2 loss training:  389.8659247159958 Time :  422
accuracy train: 0.858391 val: 0.816092 test: 0.758364
max validation accuracy : 0.816092 max acc epoch : 2 test accuracy : 0.758364
Epoch-2 lr: 0.001

Epoch :  3 loss training:  324.68844920396805 Time :  542
accuracy train: 0.899047 val: 0.856764 test: 0.789565
max validation accuracy : 0.856764 max acc epoch : 3 test accuracy : 0.789565
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  239.13643276691437 Time :  665
accuracy train: 0.925562 val: 0.874447 test: 0.810143
max validation accuracy : 0.874447 max acc epoch : 4 test accuracy : 0.810143
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  214.2297668904066 Time :  785
accuracy train: 0.933811 val: 0.871795 test: 0.811604
max validation accuracy : 0.874447 max acc epoch : 4 test accuracy : 0.810143
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  197.03000108897686 Time :  903
accuracy train: 0.938525 val: 0.875332 test: 0.814525
max validation accuracy : 0.875332 max acc epoch : 6 test accuracy : 0.814525
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  165.69755156338215 Time :  1021
accuracy train: 0.956496 val: 0.882405 test: 0.821561
max validation accuracy : 0.882405 max acc epoch : 7 test accuracy : 0.821561
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  158.91925533860922 Time :  1137
accuracy train: 0.957675 val: 0.885057 test: 0.822623
max validation accuracy : 0.885057 max acc epoch : 8 test accuracy : 0.822623
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  143.2616503238678 Time :  1254
accuracy train: 0.960915 val: 0.888594 test: 0.821694
max validation accuracy : 0.888594 max acc epoch : 9 test accuracy : 0.821694
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  131.6588387787342 Time :  1372
accuracy train: 0.967888 val: 0.891247 test: 0.825412
max validation accuracy : 0.891247 max acc epoch : 10 test accuracy : 0.825412
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  125.6465422436595 Time :  1490
accuracy train: 0.971325 val: 0.893015 test: 0.827536
max validation accuracy : 0.893015 max acc epoch : 11 test accuracy : 0.827536
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  123.11794026941061 Time :  1605
accuracy train: 0.971128 val: 0.892131 test: 0.827536
max validation accuracy : 0.893015 max acc epoch : 11 test accuracy : 0.827536
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  112.83562207967043 Time :  1720
accuracy train: 0.974565 val: 0.894783 test: 0.829793
max validation accuracy : 0.894783 max acc epoch : 13 test accuracy : 0.829793
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  113.93696313351393 Time :  1837
accuracy train: 0.977315 val: 0.893899 test: 0.829129
max validation accuracy : 0.894783 max acc epoch : 13 test accuracy : 0.829793
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  117.2532259374857 Time :  1951
accuracy train: 0.976038 val: 0.899204 test: 0.830722
max validation accuracy : 0.899204 max acc epoch : 15 test accuracy : 0.830722

Epoch :  16 loss training:  103.39180341362953 Time :  2067
accuracy train: 0.976824 val: 0.890363 test: 0.830589
max validation accuracy : 0.899204 max acc epoch : 15 test accuracy : 0.830722

Epoch :  17 loss training:  104.60065540671349 Time :  2183
accuracy train: 0.977610 val: 0.896552 test: 0.832847
max validation accuracy : 0.899204 max acc epoch : 15 test accuracy : 0.830722

Epoch :  18 loss training:  102.13257426023483 Time :  2300
accuracy train: 0.978886 val: 0.899204 test: 0.829262
max validation accuracy : 0.899204 max acc epoch : 15 test accuracy : 0.830722

Epoch :  19 loss training:  102.5642596706748 Time :  2416
accuracy train: 0.978690 val: 0.898320 test: 0.828200
max validation accuracy : 0.899204 max acc epoch : 15 test accuracy : 0.830722

Epoch :  20 loss training:  100.5909684933722 Time :  2532
accuracy train: 0.980949 val: 0.893015 test: 0.829262
max validation accuracy : 0.899204 max acc epoch : 15 test accuracy : 0.830722

Epoch :  21 loss training:  97.65428671240807 Time :  2649
accuracy train: 0.981636 val: 0.896552 test: 0.830988
max validation accuracy : 0.899204 max acc epoch : 15 test accuracy : 0.830722

Epoch :  22 loss training:  96.69960429519415 Time :  2771
accuracy train: 0.982716 val: 0.898320 test: 0.832581
max validation accuracy : 0.899204 max acc epoch : 15 test accuracy : 0.830722

Epoch :  23 loss training:  91.46009973809123 Time :  2891
accuracy train: 0.983404 val: 0.899204 test: 0.833112
max validation accuracy : 0.899204 max acc epoch : 15 test accuracy : 0.830722

Epoch :  24 loss training:  83.90700924023986 Time :  3013
accuracy train: 0.986252 val: 0.898320 test: 0.835236
max validation accuracy : 0.899204 max acc epoch : 15 test accuracy : 0.830722

Epoch :  25 loss training:  80.55475643277168 Time :  3135
accuracy train: 0.988412 val: 0.901857 test: 0.836830
max validation accuracy : 0.901857 max acc epoch : 25 test accuracy : 0.836830

Epoch :  26 loss training:  76.2735018543899 Time :  3257
accuracy train: 0.988117 val: 0.908046 test: 0.836962
max validation accuracy : 0.908046 max acc epoch : 26 test accuracy : 0.836962

Epoch :  27 loss training:  69.61095030233264 Time :  3382
accuracy train: 0.989885 val: 0.902741 test: 0.836298
max validation accuracy : 0.908046 max acc epoch : 26 test accuracy : 0.836962

Epoch :  28 loss training:  64.92925056442618 Time :  3506
accuracy train: 0.991751 val: 0.900973 test: 0.838821
max validation accuracy : 0.908046 max acc epoch : 26 test accuracy : 0.836962

Epoch :  29 loss training:  64.83509507216513 Time :  3627
accuracy train: 0.992733 val: 0.908046 test: 0.837759
max validation accuracy : 0.908046 max acc epoch : 26 test accuracy : 0.836962

Epoch :  30 loss training:  60.105852752923965 Time :  3751
accuracy train: 0.993911 val: 0.903625 test: 0.838555
max validation accuracy : 0.908046 max acc epoch : 26 test accuracy : 0.836962

Epoch :  31 loss training:  57.018490973860025 Time :  3872
accuracy train: 0.993224 val: 0.908930 test: 0.834971
max validation accuracy : 0.908930 max acc epoch : 31 test accuracy : 0.834971

Epoch :  32 loss training:  51.286946473643184 Time :  3993
accuracy train: 0.993813 val: 0.907162 test: 0.836298
max validation accuracy : 0.908930 max acc epoch : 31 test accuracy : 0.834971

Epoch :  33 loss training:  48.385660292580724 Time :  4114
accuracy train: 0.995090 val: 0.908046 test: 0.839750
max validation accuracy : 0.908930 max acc epoch : 31 test accuracy : 0.834971

Epoch :  34 loss training:  47.38897638767958 Time :  4235
accuracy train: 0.994795 val: 0.911583 test: 0.839087
max validation accuracy : 0.911583 max acc epoch : 34 test accuracy : 0.839087

Epoch :  35 loss training:  44.430706795305014 Time :  4357
accuracy train: 0.996366 val: 0.907162 test: 0.839485
max validation accuracy : 0.911583 max acc epoch : 34 test accuracy : 0.839087

Epoch :  36 loss training:  41.670438488945365 Time :  4480
accuracy train: 0.997152 val: 0.911583 test: 0.840281
max validation accuracy : 0.911583 max acc epoch : 34 test accuracy : 0.839087

Epoch :  37 loss training:  41.1322409901768 Time :  4602
accuracy train: 0.996956 val: 0.906278 test: 0.841078
max validation accuracy : 0.911583 max acc epoch : 34 test accuracy : 0.839087

Epoch :  38 loss training:  38.32834804803133 Time :  4725
accuracy train: 0.997643 val: 0.913351 test: 0.841875
max validation accuracy : 0.913351 max acc epoch : 38 test accuracy : 0.841875

Epoch :  39 loss training:  35.64774734620005 Time :  4846
accuracy train: 0.997545 val: 0.913351 test: 0.840680
max validation accuracy : 0.913351 max acc epoch : 38 test accuracy : 0.841875

Epoch :  40 loss training:  32.85371575318277 Time :  4967
accuracy train: 0.998036 val: 0.910698 test: 0.840945
max validation accuracy : 0.913351 max acc epoch : 38 test accuracy : 0.841875

Epoch :  41 loss training:  32.244918373413384 Time :  5090
accuracy train: 0.998036 val: 0.914235 test: 0.842140
max validation accuracy : 0.914235 max acc epoch : 41 test accuracy : 0.842140

Epoch :  42 loss training:  28.87625028192997 Time :  5213
accuracy train: 0.998429 val: 0.909814 test: 0.843202
max validation accuracy : 0.914235 max acc epoch : 41 test accuracy : 0.842140

Epoch :  43 loss training:  30.743035612627864 Time :  5335
accuracy train: 0.998723 val: 0.917772 test: 0.841609
max validation accuracy : 0.917772 max acc epoch : 43 test accuracy : 0.841609

Epoch :  44 loss training:  26.29380159638822 Time :  5457
accuracy train: 0.998822 val: 0.913351 test: 0.843202
max validation accuracy : 0.917772 max acc epoch : 43 test accuracy : 0.841609

Epoch :  45 loss training:  25.388393469154835 Time :  5578
accuracy train: 0.998822 val: 0.915119 test: 0.842406
max validation accuracy : 0.917772 max acc epoch : 43 test accuracy : 0.841609

Epoch :  46 loss training:  24.870313516817987 Time :  5702
accuracy train: 0.998920 val: 0.911583 test: 0.846522
max validation accuracy : 0.917772 max acc epoch : 43 test accuracy : 0.841609

Epoch :  47 loss training:  25.833548415917903 Time :  5823
accuracy train: 0.998920 val: 0.916888 test: 0.845592
max validation accuracy : 0.917772 max acc epoch : 43 test accuracy : 0.841609

Epoch :  48 loss training:  20.934220779687166 Time :  5945
accuracy train: 0.998920 val: 0.910698 test: 0.844796
max validation accuracy : 0.917772 max acc epoch : 43 test accuracy : 0.841609

Epoch :  49 loss training:  19.52750438079238 Time :  6068
accuracy train: 0.999116 val: 0.917772 test: 0.845990
max validation accuracy : 0.917772 max acc epoch : 43 test accuracy : 0.841609

Epoch :  50 loss training:  20.782020901795477 Time :  6197
accuracy train: 0.999116 val: 0.914235 test: 0.844530
max validation accuracy : 0.917772 max acc epoch : 43 test accuracy : 0.841609

Epoch :  51 loss training:  17.090053071733564 Time :  6324
accuracy train: 0.999214 val: 0.916004 test: 0.844132
max validation accuracy : 0.917772 max acc epoch : 43 test accuracy : 0.841609

Epoch :  52 loss training:  18.507892390713096 Time :  6453
accuracy train: 0.999018 val: 0.919540 test: 0.844264
max validation accuracy : 0.919540 max acc epoch : 52 test accuracy : 0.844264

Epoch :  53 loss training:  16.356452414300293 Time :  6581
accuracy train: 0.999214 val: 0.910698 test: 0.846522
max validation accuracy : 0.919540 max acc epoch : 52 test accuracy : 0.844264

Epoch :  54 loss training:  15.996864995919168 Time :  6708
accuracy train: 0.999313 val: 0.923961 test: 0.846920
max validation accuracy : 0.923961 max acc epoch : 54 test accuracy : 0.846920

Epoch :  55 loss training:  16.19997329241596 Time :  6836
accuracy train: 0.999313 val: 0.918656 test: 0.849442
max validation accuracy : 0.923961 max acc epoch : 54 test accuracy : 0.846920

Epoch :  56 loss training:  13.957403588341549 Time :  6964
accuracy train: 0.999411 val: 0.918656 test: 0.849044
max validation accuracy : 0.923961 max acc epoch : 54 test accuracy : 0.846920

Epoch :  57 loss training:  13.672286595683545 Time :  7092
accuracy train: 0.999313 val: 0.921309 test: 0.845725
max validation accuracy : 0.923961 max acc epoch : 54 test accuracy : 0.846920

Epoch :  58 loss training:  13.841913621872663 Time :  7219
accuracy train: 0.999313 val: 0.925729 test: 0.847716
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.847716

Epoch :  59 loss training:  11.766463699750602 Time :  7347
accuracy train: 0.999313 val: 0.918656 test: 0.848779
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.847716

Epoch :  60 loss training:  11.970135318348184 Time :  7473
accuracy train: 0.999214 val: 0.919540 test: 0.847716
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.847716

Epoch :  61 loss training:  12.553070472902618 Time :  7603
accuracy train: 0.999411 val: 0.925729 test: 0.849973
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.847716

Epoch :  62 loss training:  11.358152513043024 Time :  7730
accuracy train: 0.999411 val: 0.917772 test: 0.846787
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.847716

Epoch :  63 loss training:  9.818658595206216 Time :  7857
accuracy train: 0.999411 val: 0.913351 test: 0.847053
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.847716

Epoch :  64 loss training:  10.24171486182604 Time :  7978
accuracy train: 0.999607 val: 0.918656 test: 0.850106
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.847716

Epoch :  65 loss training:  9.835651430068538 Time :  8100
accuracy train: 0.999509 val: 0.920424 test: 0.849310
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.847716

Epoch :  66 loss training:  9.26201025233604 Time :  8221
accuracy train: 0.999411 val: 0.916888 test: 0.851301
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.847716

Epoch :  67 loss training:  9.600590758258477 Time :  8342
accuracy train: 0.999313 val: 0.914235 test: 0.848646
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.847716

Epoch :  68 loss training:  8.446090988116339 Time :  8464
accuracy train: 0.999509 val: 0.921309 test: 0.850372
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.847716

Epoch :  69 loss training:  8.754551388439722 Time :  8585
accuracy train: 0.999509 val: 0.916888 test: 0.851301
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.847716

Epoch :  70 loss training:  7.7977637108415365 Time :  8708
accuracy train: 0.999705 val: 0.921309 test: 0.851699
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.847716

Epoch :  71 loss training:  7.441819614439737 Time :  8830
accuracy train: 0.999607 val: 0.923077 test: 0.851036
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.847716

Epoch :  72 loss training:  7.577278306969674 Time :  8953
accuracy train: 0.999607 val: 0.923077 test: 0.851168
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.847716

Epoch :  73 loss training:  5.631697565549985 Time :  9075
accuracy train: 0.999509 val: 0.922193 test: 0.853956
max validation accuracy : 0.925729 max acc epoch : 58 test accuracy : 0.847716

Epoch :  74 loss training:  6.4208701979368925 Time :  9196
accuracy train: 0.999705 val: 0.931034 test: 0.851699
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  75 loss training:  8.145575527043547 Time :  9318
accuracy train: 0.999607 val: 0.920424 test: 0.851965
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  76 loss training:  7.628207218309399 Time :  9440
accuracy train: 0.999509 val: 0.927498 test: 0.853160
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  77 loss training:  6.972649874544004 Time :  9561
accuracy train: 0.999509 val: 0.919540 test: 0.853425
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  78 loss training:  6.715624472592026 Time :  9685
accuracy train: 0.999411 val: 0.916888 test: 0.851965
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  79 loss training:  7.00928689147986 Time :  9807
accuracy train: 0.999607 val: 0.929266 test: 0.852230
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  80 loss training:  5.768974599428475 Time :  9928
accuracy train: 0.999705 val: 0.924845 test: 0.854222
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  81 loss training:  5.15336959954584 Time :  10048
accuracy train: 0.999607 val: 0.925729 test: 0.852363
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  82 loss training:  5.002313312259503 Time :  10169
accuracy train: 0.999705 val: 0.925729 test: 0.854222
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  83 loss training:  4.498639144178014 Time :  10290
accuracy train: 0.999607 val: 0.931034 test: 0.856479
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  84 loss training:  5.731604154454544 Time :  10414
accuracy train: 0.999705 val: 0.930150 test: 0.855550
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  85 loss training:  4.982782997045433 Time :  10545
accuracy train: 0.999607 val: 0.927498 test: 0.854620
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  86 loss training:  4.844783190841554 Time :  10672
accuracy train: 0.999607 val: 0.923077 test: 0.853956
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  87 loss training:  3.832926230446901 Time :  10799
accuracy train: 0.999607 val: 0.923961 test: 0.855550
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  88 loss training:  4.517296494916081 Time :  10926
accuracy train: 0.999804 val: 0.920424 test: 0.853160
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  89 loss training:  5.157985189987812 Time :  11052
accuracy train: 0.999804 val: 0.919540 test: 0.855019
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  90 loss training:  4.443363506463356 Time :  11179
accuracy train: 0.999705 val: 0.920424 test: 0.852762
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  91 loss training:  4.220318910411152 Time :  11306
accuracy train: 0.999705 val: 0.921309 test: 0.854355
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  92 loss training:  3.598194982390851 Time :  11433
accuracy train: 0.999607 val: 0.924845 test: 0.851699
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  93 loss training:  3.966400279838126 Time :  11559
accuracy train: 0.999607 val: 0.926614 test: 0.852230
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  94 loss training:  4.652355139493011 Time :  11688
accuracy train: 0.999607 val: 0.923961 test: 0.852230
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  95 loss training:  3.514538519200869 Time :  11820
accuracy train: 0.999607 val: 0.930150 test: 0.853558
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  96 loss training:  2.728046606585849 Time :  11953
accuracy train: 0.999705 val: 0.925729 test: 0.853027
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  97 loss training:  3.4236633108521346 Time :  12086
accuracy train: 0.999705 val: 0.923077 test: 0.851699
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  98 loss training:  2.701061274303356 Time :  12222
accuracy train: 0.999607 val: 0.923077 test: 0.853160
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  99 loss training:  3.2685667997429846 Time :  12353
accuracy train: 0.999607 val: 0.922193 test: 0.854620
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  100 loss training:  3.271805378346471 Time :  12484
accuracy train: 0.999705 val: 0.919540 test: 0.852496
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  101 loss training:  2.7528870877285954 Time :  12611
accuracy train: 0.999705 val: 0.922193 test: 0.854620
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  102 loss training:  2.2880987025419017 Time :  12734
accuracy train: 0.999705 val: 0.923961 test: 0.854222
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  103 loss training:  2.8932496740017086 Time :  12856
accuracy train: 0.999607 val: 0.924845 test: 0.854620
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  104 loss training:  2.7983293934958056 Time :  12976
accuracy train: 0.999705 val: 0.922193 test: 0.856877
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

Epoch :  105 loss training:  4.0617017674667295 Time :  13097
accuracy train: 0.999509 val: 0.928382 test: 0.856213
max validation accuracy : 0.931034 max acc epoch : 74 test accuracy : 0.851699

========================================================================================================================================================================================================
max acc epoch :  74
max validation accuracy :  0.9310344827586207
test accuracy :  0.8516994158258099
last test_accuracy :  0.8562134891131173
========================================================================================================================================================================================================



date and time :  Thu Apr 29 14:23:56 2021
Namespace(batch_size=32, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=True, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=False, seed=0, weight_decay=0)
device :  cuda:0
min_len_of_sentence : 1
max_len_of_sentence : 7408
min_num_of_sentence : 7
max_num_of_sentence : 21895
average_len_of_sentence: 5.831122391605742
average_num_of_sentence: 140.61349888570518
Total_num_of_sentence : 2650002
Counter({'rec.sport.hockey': 999, 'soc.religion.christian': 997, 'rec.motorcycles': 996, 'rec.sport.baseball': 994, 'sci.crypt': 991, 'rec.autos': 990, 'sci.med': 990, 'comp.windows.x': 988, 'sci.space': 987, 'comp.os.ms-windows.misc': 985, 'sci.electronics': 984, 'comp.sys.ibm.pc.hardware': 982, 'misc.forsale': 975, 'comp.graphics': 973, 'comp.sys.mac.hardware': 963, 'talk.politics.mideast': 940, 'talk.politics.guns': 910, 'alt.atheism': 799, 'talk.politics.misc': 775, 'talk.religion.misc': 628})
Total_number_of_words: 39033
Total_number_of_categories: 20
vocab size : 39033
got embeddings of : 30907

Epoch :  1 loss training:  665.1582510471344 Time :  293
accuracy train: 0.821173 val: 0.795756 test: 0.747079
max validation accuracy : 0.795756 max acc epoch : 1 test accuracy : 0.747079
Epoch-1 lr: 0.001

Epoch :  2 loss training:  387.2502362728119 Time :  416
accuracy train: 0.866542 val: 0.839965 test: 0.777350
max validation accuracy : 0.839965 max acc epoch : 2 test accuracy : 0.777350
Epoch-2 lr: 0.001

Epoch :  3 loss training:  330.27982661128044 Time :  536
accuracy train: 0.894727 val: 0.849691 test: 0.790494
max validation accuracy : 0.849691 max acc epoch : 3 test accuracy : 0.790494
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  238.07091107964516 Time :  658
accuracy train: 0.920750 val: 0.866490 test: 0.803107
max validation accuracy : 0.866490 max acc epoch : 4 test accuracy : 0.803107
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  210.2560949474573 Time :  777
accuracy train: 0.940489 val: 0.870027 test: 0.817844
max validation accuracy : 0.870027 max acc epoch : 5 test accuracy : 0.817844
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  197.55469945073128 Time :  895
accuracy train: 0.944515 val: 0.880637 test: 0.820234
max validation accuracy : 0.880637 max acc epoch : 6 test accuracy : 0.820234
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  162.66589653491974 Time :  1015
accuracy train: 0.956398 val: 0.893015 test: 0.825279
max validation accuracy : 0.893015 max acc epoch : 7 test accuracy : 0.825279
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  148.03142514824867 Time :  1133
accuracy train: 0.958264 val: 0.886826 test: 0.825279
max validation accuracy : 0.893015 max acc epoch : 7 test accuracy : 0.825279
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  145.97600996494293 Time :  1253
accuracy train: 0.965531 val: 0.888594 test: 0.823553
max validation accuracy : 0.893015 max acc epoch : 7 test accuracy : 0.825279
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  129.77804724127054 Time :  1372
accuracy train: 0.969655 val: 0.892131 test: 0.828598
max validation accuracy : 0.893015 max acc epoch : 7 test accuracy : 0.825279
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  120.28549122810364 Time :  1491
accuracy train: 0.973191 val: 0.892131 test: 0.830589
max validation accuracy : 0.893015 max acc epoch : 7 test accuracy : 0.825279
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  120.15520291030407 Time :  1611
accuracy train: 0.972798 val: 0.894783 test: 0.831784
max validation accuracy : 0.894783 max acc epoch : 12 test accuracy : 0.831784
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  109.62673813849688 Time :  1730
accuracy train: 0.975940 val: 0.894783 test: 0.832847
max validation accuracy : 0.894783 max acc epoch : 12 test accuracy : 0.831784
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  109.0837208032608 Time :  1847
accuracy train: 0.976726 val: 0.893899 test: 0.826872
max validation accuracy : 0.894783 max acc epoch : 12 test accuracy : 0.831784
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  109.79001519829035 Time :  1966
accuracy train: 0.978592 val: 0.900088 test: 0.835900
max validation accuracy : 0.900088 max acc epoch : 15 test accuracy : 0.835900

Epoch :  16 loss training:  101.28147754445672 Time :  2085
accuracy train: 0.978985 val: 0.893899 test: 0.835369
max validation accuracy : 0.900088 max acc epoch : 15 test accuracy : 0.835900

Epoch :  17 loss training:  102.05939201265574 Time :  2211
accuracy train: 0.978985 val: 0.896552 test: 0.836033
max validation accuracy : 0.900088 max acc epoch : 15 test accuracy : 0.835900

Epoch :  18 loss training:  99.07288543879986 Time :  2331
accuracy train: 0.980163 val: 0.896552 test: 0.836431
max validation accuracy : 0.900088 max acc epoch : 15 test accuracy : 0.835900

Epoch :  19 loss training:  96.64044326916337 Time :  2452
accuracy train: 0.980654 val: 0.896552 test: 0.831917
max validation accuracy : 0.900088 max acc epoch : 15 test accuracy : 0.835900

Epoch :  20 loss training:  94.36247230321169 Time :  2570
accuracy train: 0.980752 val: 0.893015 test: 0.831652
max validation accuracy : 0.900088 max acc epoch : 15 test accuracy : 0.835900

Epoch :  21 loss training:  97.29596189782023 Time :  2688
accuracy train: 0.983207 val: 0.897436 test: 0.839618
max validation accuracy : 0.900088 max acc epoch : 15 test accuracy : 0.835900

Epoch :  22 loss training:  92.06368301063776 Time :  2810
accuracy train: 0.984189 val: 0.900088 test: 0.838555
max validation accuracy : 0.900088 max acc epoch : 15 test accuracy : 0.835900

Epoch :  23 loss training:  87.23651922494173 Time :  2934
accuracy train: 0.986252 val: 0.898320 test: 0.839485
max validation accuracy : 0.900088 max acc epoch : 15 test accuracy : 0.835900

Epoch :  24 loss training:  79.97127103805542 Time :  3058
accuracy train: 0.988117 val: 0.900973 test: 0.839618
max validation accuracy : 0.900973 max acc epoch : 24 test accuracy : 0.839618

Epoch :  25 loss training:  76.51003992184997 Time :  3184
accuracy train: 0.988314 val: 0.904509 test: 0.840149
max validation accuracy : 0.904509 max acc epoch : 25 test accuracy : 0.840149

Epoch :  26 loss training:  74.77403909340501 Time :  3312
accuracy train: 0.989001 val: 0.907162 test: 0.843866
max validation accuracy : 0.907162 max acc epoch : 26 test accuracy : 0.843866

Epoch :  27 loss training:  67.51523760333657 Time :  3436
accuracy train: 0.990671 val: 0.900973 test: 0.841476
max validation accuracy : 0.907162 max acc epoch : 26 test accuracy : 0.843866

Epoch :  28 loss training:  62.20746233314276 Time :  3559
accuracy train: 0.992046 val: 0.901857 test: 0.840414
max validation accuracy : 0.907162 max acc epoch : 26 test accuracy : 0.843866

Epoch :  29 loss training:  60.61519568040967 Time :  3683
accuracy train: 0.991947 val: 0.901857 test: 0.842671
max validation accuracy : 0.907162 max acc epoch : 26 test accuracy : 0.843866

Epoch :  30 loss training:  58.60138193145394 Time :  3806
accuracy train: 0.994206 val: 0.903625 test: 0.846654
max validation accuracy : 0.907162 max acc epoch : 26 test accuracy : 0.843866

Epoch :  31 loss training:  53.888471903279424 Time :  3927
accuracy train: 0.993813 val: 0.906278 test: 0.846522
max validation accuracy : 0.907162 max acc epoch : 26 test accuracy : 0.843866

Epoch :  32 loss training:  50.53401175700128 Time :  4051
accuracy train: 0.994010 val: 0.905393 test: 0.843601
max validation accuracy : 0.907162 max acc epoch : 26 test accuracy : 0.843866

Epoch :  33 loss training:  47.14687032811344 Time :  4170
accuracy train: 0.995875 val: 0.906278 test: 0.847451
max validation accuracy : 0.907162 max acc epoch : 26 test accuracy : 0.843866

Epoch :  34 loss training:  43.57092669792473 Time :  4291
accuracy train: 0.995974 val: 0.906278 test: 0.848513
max validation accuracy : 0.907162 max acc epoch : 26 test accuracy : 0.843866

Epoch :  35 loss training:  41.85840670205653 Time :  4416
accuracy train: 0.996858 val: 0.903625 test: 0.845858
max validation accuracy : 0.907162 max acc epoch : 26 test accuracy : 0.843866

Epoch :  36 loss training:  42.80907887034118 Time :  4538
accuracy train: 0.997447 val: 0.906278 test: 0.848247
max validation accuracy : 0.907162 max acc epoch : 26 test accuracy : 0.843866

Epoch :  37 loss training:  37.995619367808104 Time :  4661
accuracy train: 0.997250 val: 0.909814 test: 0.848115
max validation accuracy : 0.909814 max acc epoch : 37 test accuracy : 0.848115

Epoch :  38 loss training:  36.970540549606085 Time :  4782
accuracy train: 0.997545 val: 0.914235 test: 0.849177
max validation accuracy : 0.914235 max acc epoch : 38 test accuracy : 0.849177

Epoch :  39 loss training:  32.857723901979625 Time :  4903
accuracy train: 0.997643 val: 0.911583 test: 0.850505
max validation accuracy : 0.914235 max acc epoch : 38 test accuracy : 0.849177

Epoch :  40 loss training:  32.924568948335946 Time :  5025
accuracy train: 0.998331 val: 0.908046 test: 0.850770
max validation accuracy : 0.914235 max acc epoch : 38 test accuracy : 0.849177

Epoch :  41 loss training:  33.35727101564407 Time :  5146
accuracy train: 0.997643 val: 0.912467 test: 0.851301
max validation accuracy : 0.914235 max acc epoch : 38 test accuracy : 0.849177

Epoch :  42 loss training:  29.640095803886652 Time :  5268
accuracy train: 0.998822 val: 0.910698 test: 0.852496
max validation accuracy : 0.914235 max acc epoch : 38 test accuracy : 0.849177

Epoch :  43 loss training:  26.37523558177054 Time :  5387
accuracy train: 0.998723 val: 0.906278 test: 0.851036
max validation accuracy : 0.914235 max acc epoch : 38 test accuracy : 0.849177

Epoch :  44 loss training:  26.663834524340928 Time :  5511
accuracy train: 0.998822 val: 0.909814 test: 0.850239
max validation accuracy : 0.914235 max acc epoch : 38 test accuracy : 0.849177

Epoch :  45 loss training:  23.43185892701149 Time :  5633
accuracy train: 0.999018 val: 0.913351 test: 0.853293
max validation accuracy : 0.914235 max acc epoch : 38 test accuracy : 0.849177

Epoch :  46 loss training:  24.875481081195176 Time :  5755
accuracy train: 0.999214 val: 0.918656 test: 0.853558
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  47 loss training:  22.886876406148076 Time :  5877
accuracy train: 0.999018 val: 0.916004 test: 0.851965
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  48 loss training:  20.19987516058609 Time :  6001
accuracy train: 0.999018 val: 0.907162 test: 0.851567
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  49 loss training:  20.02237772103399 Time :  6120
accuracy train: 0.999214 val: 0.913351 test: 0.852894
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  50 loss training:  20.4391670380719 Time :  6243
accuracy train: 0.999313 val: 0.914235 test: 0.855019
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  51 loss training:  17.995140527840704 Time :  6363
accuracy train: 0.999411 val: 0.913351 test: 0.855550
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  52 loss training:  16.659547622315586 Time :  6483
accuracy train: 0.999313 val: 0.915119 test: 0.851567
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  53 loss training:  15.878111149650067 Time :  6603
accuracy train: 0.999411 val: 0.914235 test: 0.853824
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  54 loss training:  15.377743519376963 Time :  6724
accuracy train: 0.999214 val: 0.913351 test: 0.853425
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  55 loss training:  15.480833305628039 Time :  6845
accuracy train: 0.999214 val: 0.908930 test: 0.855151
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  56 loss training:  13.319852568442002 Time :  6965
accuracy train: 0.999509 val: 0.916888 test: 0.854222
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  57 loss training:  12.973270468879491 Time :  7085
accuracy train: 0.999509 val: 0.914235 test: 0.853956
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  58 loss training:  13.421647890703753 Time :  7207
accuracy train: 0.999313 val: 0.916888 test: 0.854753
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  59 loss training:  12.613615656737238 Time :  7329
accuracy train: 0.999509 val: 0.918656 test: 0.854089
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  60 loss training:  13.321789809968323 Time :  7454
accuracy train: 0.999509 val: 0.914235 test: 0.856612
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  61 loss training:  11.775101674720645 Time :  7576
accuracy train: 0.999509 val: 0.914235 test: 0.856213
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  62 loss training:  11.424239655723795 Time :  7697
accuracy train: 0.999607 val: 0.913351 test: 0.857674
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  63 loss training:  10.640352566028014 Time :  7819
accuracy train: 0.999607 val: 0.911583 test: 0.856346
max validation accuracy : 0.918656 max acc epoch : 46 test accuracy : 0.853558

Epoch :  64 loss training:  9.852290781447664 Time :  7938
accuracy train: 0.999509 val: 0.920424 test: 0.855019
max validation accuracy : 0.920424 max acc epoch : 64 test accuracy : 0.855019

Epoch :  65 loss training:  8.817935902858153 Time :  8057
accuracy train: 0.999509 val: 0.919540 test: 0.857408
max validation accuracy : 0.920424 max acc epoch : 64 test accuracy : 0.855019

Epoch :  66 loss training:  9.055311071220785 Time :  8179
accuracy train: 0.999607 val: 0.916888 test: 0.857010
max validation accuracy : 0.920424 max acc epoch : 64 test accuracy : 0.855019

Epoch :  67 loss training:  9.522903666831553 Time :  8299
accuracy train: 0.999607 val: 0.916888 test: 0.853824
max validation accuracy : 0.920424 max acc epoch : 64 test accuracy : 0.855019

Epoch :  68 loss training:  8.045554500771686 Time :  8419
accuracy train: 0.999607 val: 0.923077 test: 0.856213
max validation accuracy : 0.923077 max acc epoch : 68 test accuracy : 0.856213

Epoch :  69 loss training:  9.369373316061683 Time :  8544
accuracy train: 0.999607 val: 0.918656 test: 0.856081
max validation accuracy : 0.923077 max acc epoch : 68 test accuracy : 0.856213

Epoch :  70 loss training:  7.180315112811513 Time :  8665
accuracy train: 0.999705 val: 0.911583 test: 0.857541
max validation accuracy : 0.923077 max acc epoch : 68 test accuracy : 0.856213

Epoch :  71 loss training:  6.9838093320140615 Time :  8788
accuracy train: 0.999509 val: 0.915119 test: 0.858471
max validation accuracy : 0.923077 max acc epoch : 68 test accuracy : 0.856213

Epoch :  72 loss training:  9.448034483590163 Time :  8910
accuracy train: 0.999607 val: 0.916888 test: 0.857408
max validation accuracy : 0.923077 max acc epoch : 68 test accuracy : 0.856213

Epoch :  73 loss training:  7.979629706707783 Time :  9031
accuracy train: 0.999607 val: 0.916004 test: 0.859002
max validation accuracy : 0.923077 max acc epoch : 68 test accuracy : 0.856213

Epoch :  74 loss training:  6.689025881234556 Time :  9152
accuracy train: 0.999411 val: 0.916888 test: 0.858072
max validation accuracy : 0.923077 max acc epoch : 68 test accuracy : 0.856213

Epoch :  75 loss training:  6.111431827477645 Time :  9273
accuracy train: 0.999804 val: 0.920424 test: 0.858072
max validation accuracy : 0.923077 max acc epoch : 68 test accuracy : 0.856213

Epoch :  76 loss training:  6.81481017312035 Time :  9397
accuracy train: 0.999411 val: 0.921309 test: 0.857939
max validation accuracy : 0.923077 max acc epoch : 68 test accuracy : 0.856213

Epoch :  77 loss training:  5.928022341628093 Time :  9518
accuracy train: 0.999607 val: 0.916004 test: 0.861922
max validation accuracy : 0.923077 max acc epoch : 68 test accuracy : 0.856213

Epoch :  78 loss training:  6.396646776702255 Time :  9643
accuracy train: 0.999607 val: 0.916888 test: 0.859400
max validation accuracy : 0.923077 max acc epoch : 68 test accuracy : 0.856213

Epoch :  79 loss training:  6.437417758745141 Time :  9764
accuracy train: 0.999705 val: 0.916004 test: 0.856479
max validation accuracy : 0.923077 max acc epoch : 68 test accuracy : 0.856213

Epoch :  80 loss training:  5.413737215800211 Time :  9886
accuracy train: 0.999607 val: 0.919540 test: 0.860993
max validation accuracy : 0.923077 max acc epoch : 68 test accuracy : 0.856213

Epoch :  81 loss training:  5.397609696723521 Time :  10011
accuracy train: 0.999705 val: 0.917772 test: 0.858869
max validation accuracy : 0.923077 max acc epoch : 68 test accuracy : 0.856213

Epoch :  82 loss training:  5.4784475401975214 Time :  10142
accuracy train: 0.999607 val: 0.920424 test: 0.859533
max validation accuracy : 0.923077 max acc epoch : 68 test accuracy : 0.856213

Epoch :  83 loss training:  4.669160730671138 Time :  10270
accuracy train: 0.999509 val: 0.919540 test: 0.858338
max validation accuracy : 0.923077 max acc epoch : 68 test accuracy : 0.856213

Epoch :  84 loss training:  4.772273538023001 Time :  10389
accuracy train: 0.999509 val: 0.923961 test: 0.859267
max validation accuracy : 0.923961 max acc epoch : 84 test accuracy : 0.859267

Epoch :  85 loss training:  4.792371223040391 Time :  10509
accuracy train: 0.999509 val: 0.916004 test: 0.857939
max validation accuracy : 0.923961 max acc epoch : 84 test accuracy : 0.859267

Epoch :  86 loss training:  4.005214574048296 Time :  10630
accuracy train: 0.999705 val: 0.921309 test: 0.858603
max validation accuracy : 0.923961 max acc epoch : 84 test accuracy : 0.859267

Epoch :  87 loss training:  3.9990087343903724 Time :  10752
accuracy train: 0.999607 val: 0.923077 test: 0.858205
max validation accuracy : 0.923961 max acc epoch : 84 test accuracy : 0.859267

Epoch :  88 loss training:  4.543125242082169 Time :  10873
accuracy train: 0.999705 val: 0.912467 test: 0.860462
max validation accuracy : 0.923961 max acc epoch : 84 test accuracy : 0.859267

Epoch :  89 loss training:  5.205610788776539 Time :  11000
accuracy train: 0.999804 val: 0.919540 test: 0.859134
max validation accuracy : 0.923961 max acc epoch : 84 test accuracy : 0.859267

Epoch :  90 loss training:  4.24248068020097 Time :  11124
accuracy train: 0.999705 val: 0.921309 test: 0.859267
max validation accuracy : 0.923961 max acc epoch : 84 test accuracy : 0.859267

Epoch :  91 loss training:  3.3064892975089606 Time :  11245
accuracy train: 0.999705 val: 0.918656 test: 0.858869
max validation accuracy : 0.923961 max acc epoch : 84 test accuracy : 0.859267

Epoch :  92 loss training:  3.5539266605337616 Time :  11368
accuracy train: 0.999804 val: 0.917772 test: 0.860462
max validation accuracy : 0.923961 max acc epoch : 84 test accuracy : 0.859267

Epoch :  93 loss training:  4.0672194612561725 Time :  11490
accuracy train: 0.999607 val: 0.921309 test: 0.856745
max validation accuracy : 0.923961 max acc epoch : 84 test accuracy : 0.859267

Epoch :  94 loss training:  3.7167215272784233 Time :  11609
accuracy train: 0.999705 val: 0.921309 test: 0.858338
max validation accuracy : 0.923961 max acc epoch : 84 test accuracy : 0.859267

Epoch :  95 loss training:  3.5725244688946987 Time :  11731
accuracy train: 0.999607 val: 0.920424 test: 0.859267
max validation accuracy : 0.923961 max acc epoch : 84 test accuracy : 0.859267

Epoch :  96 loss training:  3.676168605161365 Time :  11853
accuracy train: 0.999607 val: 0.924845 test: 0.861657
max validation accuracy : 0.924845 max acc epoch : 96 test accuracy : 0.861657

Epoch :  97 loss training:  4.551909920090111 Time :  11976
accuracy train: 0.999804 val: 0.923077 test: 0.860329
max validation accuracy : 0.924845 max acc epoch : 96 test accuracy : 0.861657

Epoch :  98 loss training:  3.238068415026646 Time :  12096
accuracy train: 0.999607 val: 0.919540 test: 0.860462
max validation accuracy : 0.924845 max acc epoch : 96 test accuracy : 0.861657

Epoch :  99 loss training:  3.961538746370934 Time :  12218
accuracy train: 0.999804 val: 0.923077 test: 0.861126
max validation accuracy : 0.924845 max acc epoch : 96 test accuracy : 0.861657

Epoch :  100 loss training:  2.7960338987759314 Time :  12337
accuracy train: 0.999804 val: 0.916888 test: 0.860196
max validation accuracy : 0.924845 max acc epoch : 96 test accuracy : 0.861657

Epoch :  101 loss training:  3.3431779496604577 Time :  12459
accuracy train: 0.999705 val: 0.920424 test: 0.860462
max validation accuracy : 0.924845 max acc epoch : 96 test accuracy : 0.861657

Epoch :  102 loss training:  3.226520598953357 Time :  12581
accuracy train: 0.999804 val: 0.924845 test: 0.863117
max validation accuracy : 0.924845 max acc epoch : 96 test accuracy : 0.861657

Epoch :  103 loss training:  3.315344400034519 Time :  12703
accuracy train: 0.999804 val: 0.919540 test: 0.860728
max validation accuracy : 0.924845 max acc epoch : 96 test accuracy : 0.861657

Epoch :  104 loss training:  2.613085912860697 Time :  12825
accuracy train: 0.999607 val: 0.919540 test: 0.860064
max validation accuracy : 0.924845 max acc epoch : 96 test accuracy : 0.861657

Epoch :  105 loss training:  2.683003451631521 Time :  12946
accuracy train: 0.999705 val: 0.917772 test: 0.861126
max validation accuracy : 0.924845 max acc epoch : 96 test accuracy : 0.861657

Epoch :  106 loss training:  2.3141354517138097 Time :  13063
accuracy train: 0.999804 val: 0.923961 test: 0.862454
max validation accuracy : 0.924845 max acc epoch : 96 test accuracy : 0.861657

Epoch :  107 loss training:  3.242102666932624 Time :  13183
accuracy train: 0.999607 val: 0.925729 test: 0.861790
max validation accuracy : 0.925729 max acc epoch : 107 test accuracy : 0.861790

Epoch :  108 loss training:  2.667592970559781 Time :  13306
accuracy train: 0.999705 val: 0.922193 test: 0.862055
max validation accuracy : 0.925729 max acc epoch : 107 test accuracy : 0.861790

Epoch :  109 loss training:  2.449231518578017 Time :  13430
accuracy train: 0.999804 val: 0.922193 test: 0.861657
max validation accuracy : 0.925729 max acc epoch : 107 test accuracy : 0.861790

Epoch :  110 loss training:  2.226602925278712 Time :  13552
accuracy train: 0.999902 val: 0.925729 test: 0.862985
max validation accuracy : 0.925729 max acc epoch : 107 test accuracy : 0.861790

Epoch :  111 loss training:  2.502742159558693 Time :  13672
accuracy train: 0.999705 val: 0.923961 test: 0.863914
max validation accuracy : 0.925729 max acc epoch : 107 test accuracy : 0.861790

Epoch :  112 loss training:  1.5563038360123755 Time :  13791
accuracy train: 0.999804 val: 0.924845 test: 0.863781
max validation accuracy : 0.925729 max acc epoch : 107 test accuracy : 0.861790

Epoch :  113 loss training:  2.8375256030703895 Time :  13915
accuracy train: 0.999607 val: 0.922193 test: 0.861524
max validation accuracy : 0.925729 max acc epoch : 107 test accuracy : 0.861790

Epoch :  114 loss training:  2.2784114940295694 Time :  14037
accuracy train: 1.000000 val: 0.921309 test: 0.864976
max validation accuracy : 0.925729 max acc epoch : 107 test accuracy : 0.861790

Epoch :  115 loss training:  1.7607584202924045 Time :  14158
accuracy train: 0.999705 val: 0.926614 test: 0.862985
max validation accuracy : 0.926614 max acc epoch : 115 test accuracy : 0.862985

Epoch :  116 loss training:  2.191625091138121 Time :  14281
accuracy train: 0.999804 val: 0.922193 test: 0.859002
max validation accuracy : 0.926614 max acc epoch : 115 test accuracy : 0.862985

Epoch :  117 loss training:  2.864380676241126 Time :  14403
accuracy train: 0.999705 val: 0.918656 test: 0.860595
max validation accuracy : 0.926614 max acc epoch : 115 test accuracy : 0.862985

Epoch :  118 loss training:  1.472552740095125 Time :  14524
accuracy train: 0.999902 val: 0.923077 test: 0.861259
max validation accuracy : 0.926614 max acc epoch : 115 test accuracy : 0.862985

Epoch :  119 loss training:  2.0039850872271927 Time :  14646
accuracy train: 0.999804 val: 0.920424 test: 0.860462
max validation accuracy : 0.926614 max acc epoch : 115 test accuracy : 0.862985

Epoch :  120 loss training:  1.9800302825315157 Time :  14768
accuracy train: 0.999902 val: 0.924845 test: 0.860728
max validation accuracy : 0.926614 max acc epoch : 115 test accuracy : 0.862985

Epoch :  121 loss training:  2.682152612847858 Time :  14890
accuracy train: 0.999705 val: 0.918656 test: 0.861391
max validation accuracy : 0.926614 max acc epoch : 115 test accuracy : 0.862985

Epoch :  122 loss training:  1.8718151011853479 Time :  15008
accuracy train: 0.999902 val: 0.926614 test: 0.860462
max validation accuracy : 0.926614 max acc epoch : 115 test accuracy : 0.862985

Epoch :  123 loss training:  1.5014373082813108 Time :  15128
accuracy train: 0.999902 val: 0.918656 test: 0.859665
max validation accuracy : 0.926614 max acc epoch : 115 test accuracy : 0.862985

Epoch :  124 loss training:  2.0166014926799107 Time :  15250
accuracy train: 0.999902 val: 0.922193 test: 0.863117
max validation accuracy : 0.926614 max acc epoch : 115 test accuracy : 0.862985

Epoch :  125 loss training:  2.2494342829668312 Time :  15376
accuracy train: 0.999804 val: 0.920424 test: 0.860462
max validation accuracy : 0.926614 max acc epoch : 115 test accuracy : 0.862985

Epoch :  126 loss training:  1.5098105429060524 Time :  15512
accuracy train: 0.999804 val: 0.924845 test: 0.862055
max validation accuracy : 0.926614 max acc epoch : 115 test accuracy : 0.862985

Epoch :  127 loss training:  1.2888902255508583 Time :  15644
accuracy train: 0.999902 val: 0.916888 test: 0.859533
max validation accuracy : 0.926614 max acc epoch : 115 test accuracy : 0.862985

Epoch :  128 loss training:  2.4626957641739864 Time :  15776
accuracy train: 0.999902 val: 0.922193 test: 0.860064
max validation accuracy : 0.926614 max acc epoch : 115 test accuracy : 0.862985

Epoch :  129 loss training:  1.5835251726020942 Time :  15913
accuracy train: 0.999804 val: 0.927498 test: 0.862321
max validation accuracy : 0.927498 max acc epoch : 129 test accuracy : 0.862321

Epoch :  130 loss training:  1.5423562105934252 Time :  16045
accuracy train: 0.999902 val: 0.930150 test: 0.860728
max validation accuracy : 0.930150 max acc epoch : 130 test accuracy : 0.860728

Epoch :  131 loss training:  1.3490939234980033 Time :  16179
accuracy train: 0.999804 val: 0.926614 test: 0.860728
max validation accuracy : 0.930150 max acc epoch : 130 test accuracy : 0.860728

Epoch :  132 loss training:  2.2574630761082517 Time :  16315
accuracy train: 0.999902 val: 0.931034 test: 0.865109
max validation accuracy : 0.931034 max acc epoch : 132 test accuracy : 0.865109

Epoch :  133 loss training:  1.0745798644202296 Time :  16452
accuracy train: 0.999804 val: 0.923077 test: 0.861922
max validation accuracy : 0.931034 max acc epoch : 132 test accuracy : 0.865109

Epoch :  134 loss training:  1.720117387631035 Time :  16586
accuracy train: 0.999804 val: 0.926614 test: 0.861259
max validation accuracy : 0.931034 max acc epoch : 132 test accuracy : 0.865109

Epoch :  135 loss training:  1.8090630240694736 Time :  16720
accuracy train: 0.999902 val: 0.924845 test: 0.858736
max validation accuracy : 0.931034 max acc epoch : 132 test accuracy : 0.865109

Epoch :  136 loss training:  1.529983766402438 Time :  16858
accuracy train: 0.999902 val: 0.924845 test: 0.863117
max validation accuracy : 0.931034 max acc epoch : 132 test accuracy : 0.865109

Epoch :  137 loss training:  1.1734878015340655 Time :  16993
accuracy train: 0.999804 val: 0.929266 test: 0.860993
max validation accuracy : 0.931034 max acc epoch : 132 test accuracy : 0.865109

Epoch :  138 loss training:  1.2730823557067197 Time :  17127
accuracy train: 0.999902 val: 0.928382 test: 0.860728
max validation accuracy : 0.931034 max acc epoch : 132 test accuracy : 0.865109

Epoch :  139 loss training:  1.2336305070020899 Time :  17260
accuracy train: 1.000000 val: 0.927498 test: 0.865374
max validation accuracy : 0.931034 max acc epoch : 132 test accuracy : 0.865109

Epoch :  140 loss training:  1.7874309122016712 Time :  17395
accuracy train: 0.999804 val: 0.932803 test: 0.860993
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  141 loss training:  1.1586335714237066 Time :  17525
accuracy train: 0.999804 val: 0.926614 test: 0.861524
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  142 loss training:  1.2147006883169524 Time :  17662
accuracy train: 0.999902 val: 0.928382 test: 0.864578
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  143 loss training:  1.2128322708085761 Time :  17795
accuracy train: 0.999902 val: 0.927498 test: 0.863383
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  144 loss training:  1.531359303780846 Time :  17926
accuracy train: 0.999902 val: 0.927498 test: 0.862188
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  145 loss training:  1.0763186091680836 Time :  18053
accuracy train: 0.999902 val: 0.929266 test: 0.863648
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  146 loss training:  1.4111760594787484 Time :  18180
accuracy train: 0.999902 val: 0.926614 test: 0.862321
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  147 loss training:  0.9433920634764945 Time :  18308
accuracy train: 1.000000 val: 0.926614 test: 0.864180
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  148 loss training:  0.7709613187635114 Time :  18435
accuracy train: 0.999902 val: 0.923961 test: 0.864312
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  149 loss training:  0.8690324555354891 Time :  18562
accuracy train: 1.000000 val: 0.924845 test: 0.865905
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  150 loss training:  1.3414456029349822 Time :  18686
accuracy train: 0.999902 val: 0.927498 test: 0.864843
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  151 loss training:  1.2310790666379035 Time :  18814
accuracy train: 1.000000 val: 0.927498 test: 0.862055
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  152 loss training:  0.8128489834007269 Time :  18943
accuracy train: 1.000000 val: 0.930150 test: 0.862586
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  153 loss training:  1.9494913791204453 Time :  19070
accuracy train: 0.999705 val: 0.923961 test: 0.858736
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  154 loss training:  1.118533075105006 Time :  19197
accuracy train: 0.999902 val: 0.924845 test: 0.861790
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  155 loss training:  0.973371849173418 Time :  19324
accuracy train: 0.999902 val: 0.928382 test: 0.862055
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  156 loss training:  0.9845694902687683 Time :  19452
accuracy train: 1.000000 val: 0.928382 test: 0.859931
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  157 loss training:  0.8281347221090982 Time :  19580
accuracy train: 1.000000 val: 0.923077 test: 0.863250
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  158 loss training:  0.9402288783312542 Time :  19706
accuracy train: 1.000000 val: 0.924845 test: 0.857939
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  159 loss training:  1.0725258161437523 Time :  19834
accuracy train: 1.000000 val: 0.925729 test: 0.858471
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  160 loss training:  0.7703319688262127 Time :  19961
accuracy train: 1.000000 val: 0.922193 test: 0.859798
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  161 loss training:  0.8010324070455681 Time :  20090
accuracy train: 0.999902 val: 0.926614 test: 0.864843
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  162 loss training:  0.5994805662703584 Time :  20216
accuracy train: 1.000000 val: 0.931034 test: 0.864312
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  163 loss training:  0.6818029487094464 Time :  20342
accuracy train: 1.000000 val: 0.931034 test: 0.864180
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  164 loss training:  0.9400428955032112 Time :  20469
accuracy train: 0.999902 val: 0.922193 test: 0.863516
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  165 loss training:  1.2123323928826721 Time :  20597
accuracy train: 1.000000 val: 0.931919 test: 0.866968
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  166 loss training:  0.3907292327967298 Time :  20724
accuracy train: 1.000000 val: 0.931034 test: 0.864976
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  167 loss training:  0.4641502683334693 Time :  20853
accuracy train: 1.000000 val: 0.928382 test: 0.862985
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  168 loss training:  1.0099607316587935 Time :  20985
accuracy train: 1.000000 val: 0.925729 test: 0.865905
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  169 loss training:  0.6907700959527574 Time :  21113
accuracy train: 1.000000 val: 0.924845 test: 0.865109
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  170 loss training:  0.48436233121356054 Time :  21240
accuracy train: 1.000000 val: 0.926614 test: 0.863781
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

Epoch :  171 loss training:  0.8079706349635671 Time :  21367
accuracy train: 1.000000 val: 0.921309 test: 0.866835
max validation accuracy : 0.932803 max acc epoch : 140 test accuracy : 0.860993

========================================================================================================================================================================================================
max acc epoch :  140
max validation accuracy :  0.9328028293545535
test accuracy :  0.8609930961232076
last test_accuracy :  0.8668348380244291
========================================================================================================================================================================================================



date and time :  Thu Apr 29 20:20:51 2021
Namespace(batch_size=32, dataset='20ng', device=0, dropout=0.3, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_layers=3, num_mlp_layers=1, random_vec=True, seed=0, weight_decay=0)
device :  cuda:0
Counter({16: 1425, 4: 1424, 8: 1326, 5: 1265, 6: 1108, 3: 1093, 15: 1059, 9: 999, 2: 991, 14: 988, 12: 987, 19: 945, 17: 932, 1: 817, 11: 762, 10: 736, 13: 684, 0: 683, 7: 497, 18: 125})

Traceback (most recent call last):
  File "main.py", line 262, in <module>
    main()
  File "main.py", line 211, in main
    loss_accum = train(epoch, args, model, optimizer, data_full_split_train, class_weights)
  File "main.py", line 65, in train
    loss.backward()
  File "/home/shamnast/.local/lib/python3.6/site-packages/torch/tensor.py", line 221, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/shamnast/.local/lib/python3.6/site-packages/torch/autograd/__init__.py", line 132, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA out of memory. Tried to allocate 298.00 MiB (GPU 0; 10.92 GiB total capacity; 9.44 GiB already allocated; 269.38 MiB free; 9.95 GiB reserved in total by PyTorch)
