

date and time :  Sun May 23 20:52:41 2021
itr : 0
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.4, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=791, weight_decay=1e-07)
device :  cuda:0
Counter({2: 2591, 1: 2556, 0: 2253})

Epoch :  1 loss training:  223.53232204914093 Time :  243
accuracy train: 0.612177 val: 0.564179 test: 0.584220
max validation accuracy : 0.564179 max acc epoch : 1 test accuracy : 0.584220
Counter({2: 2901, 0: 2435, 1: 2064})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  151.68852365016937 Time :  361
accuracy train: 0.691595 val: 0.641791 test: 0.650012
max validation accuracy : 0.641791 max acc epoch : 2 test accuracy : 0.650012
Counter({0: 2755, 2: 2677, 1: 1968})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  135.50891542434692 Time :  484
accuracy train: 0.736598 val: 0.710448 test: 0.657185
max validation accuracy : 0.710448 max acc epoch : 3 test accuracy : 0.657185
Counter({2: 2655, 1: 2556, 0: 2189})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  111.76618278026581 Time :  613
accuracy train: 0.773660 val: 0.728358 test: 0.686124
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.686124
Counter({1: 2686, 0: 2556, 2: 2158})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  104.02008399367332 Time :  703
accuracy train: 0.787889 val: 0.725373 test: 0.696018
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.686124
Counter({2: 2676, 1: 2597, 0: 2127})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  99.23986142873764 Time :  818
accuracy train: 0.788220 val: 0.719403 test: 0.681919
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.686124
Counter({0: 2686, 1: 2665, 2: 2049})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  90.48250538110733 Time :  928
accuracy train: 0.809398 val: 0.725373 test: 0.694039
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.686124
Counter({2: 2700, 0: 2658, 1: 2042})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  85.4858583509922 Time :  1024
accuracy train: 0.824950 val: 0.722388 test: 0.703438
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.686124
Counter({1: 2691, 0: 2681, 2: 2028})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  80.31965321302414 Time :  1133
accuracy train: 0.828921 val: 0.746269 test: 0.703685
max validation accuracy : 0.746269 max acc epoch : 9 test accuracy : 0.703685
Counter({1: 2713, 2: 2673, 0: 2014})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  76.00874441862106 Time :  1250
accuracy train: 0.845136 val: 0.749254 test: 0.705664
max validation accuracy : 0.749254 max acc epoch : 10 test accuracy : 0.705664
Counter({2: 2708, 0: 2678, 1: 2014})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  74.56891804933548 Time :  1371
accuracy train: 0.845797 val: 0.755224 test: 0.709374
max validation accuracy : 0.755224 max acc epoch : 11 test accuracy : 0.709374
Counter({1: 2716, 0: 2673, 2: 2011})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  73.25819900631905 Time :  1465
accuracy train: 0.849437 val: 0.749254 test: 0.704180
max validation accuracy : 0.755224 max acc epoch : 11 test accuracy : 0.709374
Counter({0: 2714, 2: 2676, 1: 2010})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  69.02514061331749 Time :  1573
accuracy train: 0.854732 val: 0.749254 test: 0.712342
max validation accuracy : 0.755224 max acc epoch : 11 test accuracy : 0.709374
Counter({1: 2714, 2: 2679, 0: 2007})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  69.50389559566975 Time :  1679
accuracy train: 0.862012 val: 0.746269 test: 0.709622
max validation accuracy : 0.755224 max acc epoch : 11 test accuracy : 0.709374
Counter({1: 2712, 2: 2680, 0: 2008})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  68.82576516270638 Time :  1796
accuracy train: 0.858703 val: 0.743284 test: 0.707395
max validation accuracy : 0.755224 max acc epoch : 11 test accuracy : 0.709374
Counter({0: 2714, 2: 2676, 1: 2010})

Epoch :  16 loss training:  67.94855126738548 Time :  1910
accuracy train: 0.865652 val: 0.746269 test: 0.709374
max validation accuracy : 0.755224 max acc epoch : 11 test accuracy : 0.709374
Counter({2: 2714, 0: 2677, 1: 2009})

Epoch :  17 loss training:  66.39545732736588 Time :  2005
accuracy train: 0.867968 val: 0.755224 test: 0.707890
max validation accuracy : 0.755224 max acc epoch : 11 test accuracy : 0.709374
Counter({1: 2712, 0: 2683, 2: 2005})

Epoch :  18 loss training:  64.37296034395695 Time :  2124
accuracy train: 0.871277 val: 0.752239 test: 0.709127
max validation accuracy : 0.755224 max acc epoch : 11 test accuracy : 0.709374
Counter({2: 2712, 1: 2688, 0: 2000})

Epoch :  19 loss training:  63.679974257946014 Time :  2242
accuracy train: 0.879881 val: 0.749254 test: 0.706901
max validation accuracy : 0.755224 max acc epoch : 11 test accuracy : 0.709374
Counter({2: 2710, 1: 2689, 0: 2001})

Epoch :  20 loss training:  64.62878730893135 Time :  2342
accuracy train: 0.881535 val: 0.755224 test: 0.712095
max validation accuracy : 0.755224 max acc epoch : 11 test accuracy : 0.709374
Counter({1: 2710, 0: 2693, 2: 1997})

Epoch :  21 loss training:  61.10552726686001 Time :  2444
accuracy train: 0.885837 val: 0.755224 test: 0.708385
max validation accuracy : 0.755224 max acc epoch : 11 test accuracy : 0.709374
Counter({1: 2709, 0: 2689, 2: 2002})

Epoch :  22 loss training:  60.19167545437813 Time :  2560
accuracy train: 0.890801 val: 0.752239 test: 0.708385
max validation accuracy : 0.755224 max acc epoch : 11 test accuracy : 0.709374
Counter({2: 2713, 0: 2689, 1: 1998})

Epoch :  23 loss training:  57.89448043704033 Time :  2653
accuracy train: 0.895433 val: 0.740299 test: 0.713332
max validation accuracy : 0.755224 max acc epoch : 11 test accuracy : 0.709374
Counter({1: 2702, 0: 2690, 2: 2008})

Epoch :  24 loss training:  57.83558310568333 Time :  2737
accuracy train: 0.897750 val: 0.746269 test: 0.710116
max validation accuracy : 0.755224 max acc epoch : 11 test accuracy : 0.709374
Counter({0: 2701, 1: 2693, 2: 2006})

Epoch :  25 loss training:  57.40316465497017 Time :  2842
accuracy train: 0.906023 val: 0.743284 test: 0.711353
max validation accuracy : 0.755224 max acc epoch : 11 test accuracy : 0.709374
Counter({0: 2699, 1: 2698, 2: 2003})

Epoch :  26 loss training:  54.435445591807365 Time :  2966
accuracy train: 0.904037 val: 0.758209 test: 0.707643
max validation accuracy : 0.758209 max acc epoch : 26 test accuracy : 0.707643
Counter({1: 2711, 0: 2687, 2: 2002})

Epoch :  27 loss training:  55.74299268424511 Time :  3051
accuracy train: 0.909001 val: 0.764179 test: 0.713332
max validation accuracy : 0.764179 max acc epoch : 27 test accuracy : 0.713332
Counter({1: 2710, 0: 2686, 2: 2004})

Epoch :  28 loss training:  52.168714329600334 Time :  3134
accuracy train: 0.914957 val: 0.749254 test: 0.712095
max validation accuracy : 0.764179 max acc epoch : 27 test accuracy : 0.713332
Counter({1: 2711, 2: 2681, 0: 2008})

Epoch :  29 loss training:  51.08336062729359 Time :  3230
accuracy train: 0.920913 val: 0.761194 test: 0.714321
max validation accuracy : 0.764179 max acc epoch : 27 test accuracy : 0.713332
Counter({0: 2714, 1: 2681, 2: 2005})

Epoch :  30 loss training:  50.579203218221664 Time :  3330
accuracy train: 0.922899 val: 0.767164 test: 0.713579
max validation accuracy : 0.767164 max acc epoch : 30 test accuracy : 0.713579
Counter({2: 2718, 1: 2680, 0: 2002})

Epoch :  31 loss training:  49.98977269232273 Time :  3410
accuracy train: 0.924222 val: 0.761194 test: 0.716794
max validation accuracy : 0.767164 max acc epoch : 30 test accuracy : 0.713579
Counter({0: 2726, 2: 2671, 1: 2003})

Epoch :  32 loss training:  46.67002769559622 Time :  3496
accuracy train: 0.927531 val: 0.758209 test: 0.714321
max validation accuracy : 0.767164 max acc epoch : 30 test accuracy : 0.713579
Counter({0: 2731, 1: 2667, 2: 2002})

Epoch :  33 loss training:  46.06511080265045 Time :  3612
accuracy train: 0.932495 val: 0.758209 test: 0.712342
max validation accuracy : 0.767164 max acc epoch : 30 test accuracy : 0.713579
Counter({1: 2730, 2: 2666, 0: 2004})

Epoch :  34 loss training:  46.19098189473152 Time :  3714
accuracy train: 0.936135 val: 0.758209 test: 0.716300
max validation accuracy : 0.767164 max acc epoch : 30 test accuracy : 0.713579
Counter({0: 2731, 1: 2668, 2: 2001})

Epoch :  35 loss training:  44.666573598980904 Time :  3793
accuracy train: 0.938782 val: 0.761194 test: 0.715805
max validation accuracy : 0.767164 max acc epoch : 30 test accuracy : 0.713579
Counter({0: 2727, 1: 2669, 2: 2004})

Epoch :  36 loss training:  44.973124109208584 Time :  3893
accuracy train: 0.946393 val: 0.767164 test: 0.711848
max validation accuracy : 0.767164 max acc epoch : 30 test accuracy : 0.713579
Counter({0: 2731, 1: 2675, 2: 1994})

Epoch :  37 loss training:  43.70384953171015 Time :  4000
accuracy train: 0.944739 val: 0.761194 test: 0.714074
max validation accuracy : 0.767164 max acc epoch : 30 test accuracy : 0.713579
Counter({2: 2734, 1: 2683, 0: 1983})

Epoch :  38 loss training:  41.66630147397518 Time :  4094
accuracy train: 0.949702 val: 0.749254 test: 0.714816
max validation accuracy : 0.767164 max acc epoch : 30 test accuracy : 0.713579
Counter({2: 2741, 0: 2688, 1: 1971})

Epoch :  39 loss training:  40.251492358744144 Time :  4176
accuracy train: 0.954997 val: 0.764179 test: 0.715063
max validation accuracy : 0.767164 max acc epoch : 30 test accuracy : 0.713579
Counter({0: 2741, 2: 2687, 1: 1972})

Epoch :  40 loss training:  40.31855744123459 Time :  4277
accuracy train: 0.953342 val: 0.767164 test: 0.716300
max validation accuracy : 0.767164 max acc epoch : 30 test accuracy : 0.713579
Counter({1: 2743, 2: 2687, 0: 1970})

Epoch :  41 loss training:  38.48857036232948 Time :  4363
accuracy train: 0.958968 val: 0.767164 test: 0.715310
max validation accuracy : 0.767164 max acc epoch : 30 test accuracy : 0.713579
Counter({0: 2741, 2: 2696, 1: 1963})

Epoch :  42 loss training:  36.9369223639369 Time :  4469
accuracy train: 0.963269 val: 0.776119 test: 0.719763
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({2: 2749, 1: 2685, 0: 1966})

Epoch :  43 loss training:  38.394966177642345 Time :  4566
accuracy train: 0.963931 val: 0.743284 test: 0.718031
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({0: 2747, 2: 2693, 1: 1960})

Epoch :  44 loss training:  35.02737731486559 Time :  4665
accuracy train: 0.962608 val: 0.755224 test: 0.719268
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({2: 2749, 0: 2690, 1: 1961})

Epoch :  45 loss training:  32.78475619107485 Time :  4773
accuracy train: 0.965586 val: 0.758209 test: 0.716794
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({0: 2750, 1: 2688, 2: 1962})

Epoch :  46 loss training:  36.04917295277119 Time :  4899
accuracy train: 0.967571 val: 0.758209 test: 0.716300
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({0: 2748, 1: 2691, 2: 1961})

Epoch :  47 loss training:  32.25131003558636 Time :  4998
accuracy train: 0.972866 val: 0.749254 test: 0.721989
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({2: 2759, 0: 2679, 1: 1962})

Epoch :  48 loss training:  31.58248070627451 Time :  5090
accuracy train: 0.975182 val: 0.749254 test: 0.716052
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({1: 2760, 2: 2679, 0: 1961})

Epoch :  49 loss training:  31.30837333202362 Time :  5183
accuracy train: 0.975844 val: 0.764179 test: 0.713084
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({1: 2757, 2: 2681, 0: 1962})

Epoch :  50 loss training:  30.551641426980495 Time :  5308
accuracy train: 0.978160 val: 0.758209 test: 0.720010
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({2: 2760, 1: 2678, 0: 1962})

Epoch :  51 loss training:  30.002557016909122 Time :  5400
accuracy train: 0.977829 val: 0.755224 test: 0.717042
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({2: 2757, 1: 2676, 0: 1967})

Epoch :  52 loss training:  27.952304258942604 Time :  5486
accuracy train: 0.982131 val: 0.761194 test: 0.715310
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({0: 2757, 2: 2676, 1: 1967})

Epoch :  53 loss training:  29.263172775506973 Time :  5570
accuracy train: 0.983455 val: 0.764179 test: 0.718526
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({0: 2755, 1: 2677, 2: 1968})

Epoch :  54 loss training:  27.020439226180315 Time :  5668
accuracy train: 0.983455 val: 0.755224 test: 0.719268
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({0: 2762, 1: 2677, 2: 1961})

Epoch :  55 loss training:  27.810628447681665 Time :  5778
accuracy train: 0.986764 val: 0.764179 test: 0.717536
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({0: 2761, 1: 2674, 2: 1965})

Epoch :  56 loss training:  26.87991853058338 Time :  5876
accuracy train: 0.987095 val: 0.755224 test: 0.716052
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({0: 2760, 1: 2679, 2: 1961})

Epoch :  57 loss training:  24.34212574735284 Time :  5996
accuracy train: 0.987426 val: 0.758209 test: 0.717784
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({1: 2764, 0: 2675, 2: 1961})

Epoch :  58 loss training:  26.096267729997635 Time :  6088
accuracy train: 0.987756 val: 0.755224 test: 0.717289
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({0: 2765, 1: 2676, 2: 1959})

Epoch :  59 loss training:  24.257540058344603 Time :  6185
accuracy train: 0.988418 val: 0.743284 test: 0.714816
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({2: 2760, 1: 2675, 0: 1965})

Epoch :  60 loss training:  24.059854302555323 Time :  6301
accuracy train: 0.989742 val: 0.758209 test: 0.714074
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({1: 2763, 2: 2674, 0: 1963})

Epoch :  61 loss training:  21.101445771753788 Time :  6401
accuracy train: 0.991066 val: 0.770149 test: 0.720010
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({0: 2769, 1: 2668, 2: 1963})

Epoch :  62 loss training:  21.596044283360243 Time :  6494
accuracy train: 0.992389 val: 0.764179 test: 0.720752
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({0: 2766, 1: 2668, 2: 1966})

Epoch :  63 loss training:  22.345028173178434 Time :  6605
accuracy train: 0.993051 val: 0.761194 test: 0.717289
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({2: 2764, 1: 2666, 0: 1970})

Epoch :  64 loss training:  20.52017054706812 Time :  6694
accuracy train: 0.993382 val: 0.764179 test: 0.718031
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({0: 2767, 1: 2656, 2: 1977})

Epoch :  65 loss training:  21.133342631161213 Time :  6795
accuracy train: 0.994375 val: 0.770149 test: 0.721494
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({0: 2768, 2: 2657, 1: 1975})

Epoch :  66 loss training:  21.449831198900938 Time :  6898
accuracy train: 0.994705 val: 0.764179 test: 0.716300
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({0: 2768, 2: 2654, 1: 1978})

Epoch :  67 loss training:  18.526633966714144 Time :  6978
accuracy train: 0.994705 val: 0.761194 test: 0.716794
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({0: 2772, 2: 2653, 1: 1975})

Epoch :  68 loss training:  17.489949841983616 Time :  7077
accuracy train: 0.995698 val: 0.773134 test: 0.716547
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({1: 2775, 2: 2649, 0: 1976})

Epoch :  69 loss training:  17.259739702567458 Time :  7175
accuracy train: 0.995036 val: 0.773134 test: 0.720257
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({0: 2775, 1: 2648, 2: 1977})

Epoch :  70 loss training:  18.160724114626646 Time :  7264
accuracy train: 0.995367 val: 0.770149 test: 0.715063
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({1: 2775, 2: 2650, 0: 1975})

Epoch :  71 loss training:  17.173034388571978 Time :  7348
accuracy train: 0.996360 val: 0.758209 test: 0.713826
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({2: 2779, 1: 2649, 0: 1972})

Epoch :  72 loss training:  16.0140452478081 Time :  7453
accuracy train: 0.996360 val: 0.773134 test: 0.718526
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({2: 2784, 1: 2651, 0: 1965})

Epoch :  73 loss training:  14.708880849182606 Time :  7555
accuracy train: 0.997353 val: 0.764179 test: 0.711600
max validation accuracy : 0.776119 max acc epoch : 42 test accuracy : 0.719763
Counter({1: 2782, 2: 2651, 0: 1967})

========================================================================================================================================================================================================
max acc epoch :  42
max validation accuracy :  0.7761194029850746
test accuracy :  0.7197625525599802
last test_accuracy :  0.7116002968093
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.4, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=791, weight_decay=1e-07)
device :  cuda:0
Counter({2: 2591, 1: 2556, 0: 2253})

Epoch :  1 loss training:  223.40411376953125 Time :  7784
accuracy train: 0.617141 val: 0.573134 test: 0.585209
max validation accuracy : 0.573134 max acc epoch : 1 test accuracy : 0.585209
Counter({2: 2858, 1: 2353, 0: 2189})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  151.92345017194748 Time :  7907
accuracy train: 0.699868 val: 0.662687 test: 0.650754
max validation accuracy : 0.662687 max acc epoch : 2 test accuracy : 0.650754
Counter({2: 2747, 1: 2643, 0: 2010})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  135.8407945036888 Time :  8015
accuracy train: 0.733951 val: 0.704478 test: 0.660401
max validation accuracy : 0.704478 max acc epoch : 3 test accuracy : 0.660401
Counter({0: 2724, 1: 2607, 2: 2069})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  111.7206546664238 Time :  8107
accuracy train: 0.773329 val: 0.725373 test: 0.685877
max validation accuracy : 0.725373 max acc epoch : 4 test accuracy : 0.685877
Counter({2: 2748, 1: 2567, 0: 2085})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  103.63570445775986 Time :  8226
accuracy train: 0.785572 val: 0.728358 test: 0.697502
max validation accuracy : 0.728358 max acc epoch : 5 test accuracy : 0.697502
Counter({2: 2744, 1: 2590, 0: 2066})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  98.89516597986221 Time :  8319
accuracy train: 0.792852 val: 0.725373 test: 0.683651
max validation accuracy : 0.728358 max acc epoch : 5 test accuracy : 0.697502
Counter({2: 2742, 0: 2596, 1: 2062})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  89.26494839787483 Time :  8419
accuracy train: 0.813369 val: 0.746269 test: 0.696265
max validation accuracy : 0.746269 max acc epoch : 7 test accuracy : 0.696265
Counter({0: 2751, 1: 2590, 2: 2059})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  83.66221717000008 Time :  8523
accuracy train: 0.822634 val: 0.746269 test: 0.699728
max validation accuracy : 0.746269 max acc epoch : 7 test accuracy : 0.696265
Counter({0: 2754, 1: 2574, 2: 2072})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  80.70748636126518 Time :  8631
accuracy train: 0.835870 val: 0.752239 test: 0.706406
max validation accuracy : 0.752239 max acc epoch : 9 test accuracy : 0.706406
Counter({2: 2758, 0: 2564, 1: 2078})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  76.3730126619339 Time :  8733
accuracy train: 0.843481 val: 0.749254 test: 0.704427
max validation accuracy : 0.752239 max acc epoch : 9 test accuracy : 0.706406
Counter({0: 2760, 1: 2564, 2: 2076})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  75.09439019858837 Time :  8820
accuracy train: 0.843150 val: 0.743284 test: 0.709127
max validation accuracy : 0.752239 max acc epoch : 9 test accuracy : 0.706406
Counter({1: 2769, 0: 2563, 2: 2068})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  73.40386418998241 Time :  8924
accuracy train: 0.852085 val: 0.749254 test: 0.709374
max validation accuracy : 0.752239 max acc epoch : 9 test accuracy : 0.706406
Counter({0: 2772, 1: 2563, 2: 2065})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  72.40029250085354 Time :  9031
accuracy train: 0.857048 val: 0.740299 test: 0.710364
max validation accuracy : 0.752239 max acc epoch : 9 test accuracy : 0.706406
Counter({0: 2773, 2: 2562, 1: 2065})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  68.51887708902359 Time :  9134
accuracy train: 0.860026 val: 0.749254 test: 0.709869
max validation accuracy : 0.752239 max acc epoch : 9 test accuracy : 0.706406
Counter({1: 2770, 0: 2565, 2: 2065})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  71.52814447879791 Time :  9221
accuracy train: 0.858703 val: 0.749254 test: 0.711600
max validation accuracy : 0.752239 max acc epoch : 9 test accuracy : 0.706406
Counter({0: 2771, 2: 2566, 1: 2063})

Epoch :  16 loss training:  67.91391533613205 Time :  9297
accuracy train: 0.864990 val: 0.749254 test: 0.709622
max validation accuracy : 0.752239 max acc epoch : 9 test accuracy : 0.706406
Counter({2: 2771, 1: 2566, 0: 2063})

Epoch :  17 loss training:  66.19936349987984 Time :  9397
accuracy train: 0.870285 val: 0.761194 test: 0.710116
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({1: 2769, 2: 2568, 0: 2063})

Epoch :  18 loss training:  66.09252132475376 Time :  9494
accuracy train: 0.872270 val: 0.749254 test: 0.712590
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({1: 2766, 2: 2575, 0: 2059})

Epoch :  19 loss training:  65.86743366718292 Time :  9597
accuracy train: 0.880212 val: 0.740299 test: 0.713826
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 2765, 2: 2575, 1: 2060})

Epoch :  20 loss training:  63.15462362766266 Time :  9694
accuracy train: 0.883521 val: 0.749254 test: 0.716300
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 2766, 1: 2575, 2: 2059})

Epoch :  21 loss training:  62.00947165489197 Time :  9809
accuracy train: 0.885506 val: 0.749254 test: 0.716052
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 2766, 2: 2577, 1: 2057})

Epoch :  22 loss training:  61.07113416492939 Time :  9893
accuracy train: 0.893779 val: 0.752239 test: 0.716794
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 2765, 1: 2574, 2: 2061})

Epoch :  23 loss training:  59.0030704587698 Time :  9998
accuracy train: 0.894441 val: 0.752239 test: 0.716052
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 2759, 2: 2572, 1: 2069})

Epoch :  24 loss training:  61.05517928302288 Time :  10119
accuracy train: 0.900066 val: 0.749254 test: 0.712095
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 2754, 2: 2574, 1: 2072})

Epoch :  25 loss training:  56.77586589753628 Time :  10212
accuracy train: 0.904368 val: 0.746269 test: 0.715063
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({1: 2757, 2: 2576, 0: 2067})

Epoch :  26 loss training:  54.51130795478821 Time :  10342
accuracy train: 0.903375 val: 0.755224 test: 0.711848
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({1: 2761, 0: 2573, 2: 2066})

Epoch :  27 loss training:  55.633722096681595 Time :  10461
accuracy train: 0.909662 val: 0.758209 test: 0.715063
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 2759, 1: 2574, 2: 2067})

Epoch :  28 loss training:  53.82816582918167 Time :  10585
accuracy train: 0.915619 val: 0.752239 test: 0.714568
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 2758, 1: 2577, 2: 2065})

Epoch :  29 loss training:  51.838877096772194 Time :  10724
accuracy train: 0.916612 val: 0.758209 test: 0.712837
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 2758, 2: 2581, 1: 2061})

Epoch :  30 loss training:  52.345348596572876 Time :  10840
accuracy train: 0.920582 val: 0.755224 test: 0.713332
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({2: 2760, 1: 2578, 0: 2062})

Epoch :  31 loss training:  49.105301193892956 Time :  10952
accuracy train: 0.921906 val: 0.758209 test: 0.714816
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 2760, 2: 2580, 1: 2060})

Epoch :  32 loss training:  47.871692448854446 Time :  11098
accuracy train: 0.928524 val: 0.761194 test: 0.715558
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({1: 2762, 2: 2584, 0: 2054})

Epoch :  33 loss training:  48.72216726094484 Time :  11221
accuracy train: 0.931171 val: 0.755224 test: 0.716300
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 2769, 1: 2584, 2: 2047})

Epoch :  34 loss training:  46.509180411696434 Time :  11340
accuracy train: 0.931833 val: 0.761194 test: 0.715558
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({1: 2772, 2: 2581, 0: 2047})

Epoch :  35 loss training:  45.5218353420496 Time :  11493
accuracy train: 0.938451 val: 0.752239 test: 0.715805
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 2768, 1: 2582, 2: 2050})

Epoch :  36 loss training:  43.581476509571075 Time :  11603
accuracy train: 0.943746 val: 0.752239 test: 0.713826
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({1: 2756, 2: 2578, 0: 2066})

Epoch :  37 loss training:  44.462176859378815 Time :  11739
accuracy train: 0.948048 val: 0.761194 test: 0.713826
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({2: 2765, 1: 2569, 0: 2066})

Epoch :  38 loss training:  40.923935405910015 Time :  11869
accuracy train: 0.951688 val: 0.761194 test: 0.718526
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 2765, 2: 2570, 1: 2065})

Epoch :  39 loss training:  39.779050938785076 Time :  12004
accuracy train: 0.953673 val: 0.749254 test: 0.715558
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 2767, 1: 2571, 2: 2062})

Epoch :  40 loss training:  39.876818381249905 Time :  12109
accuracy train: 0.954335 val: 0.755224 test: 0.721247
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 2768, 1: 2571, 2: 2061})

Epoch :  41 loss training:  38.48637840151787 Time :  12209
accuracy train: 0.956651 val: 0.752239 test: 0.717042
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({0: 2767, 1: 2570, 2: 2063})

Epoch :  42 loss training:  37.776866018772125 Time :  12331
accuracy train: 0.959629 val: 0.755224 test: 0.718773
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({2: 2766, 1: 2567, 0: 2067})

Epoch :  43 loss training:  35.49755082279444 Time :  12461
accuracy train: 0.963269 val: 0.749254 test: 0.719763
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({1: 2769, 2: 2567, 0: 2064})

Epoch :  44 loss training:  35.97399206459522 Time :  12571
accuracy train: 0.961615 val: 0.761194 test: 0.721247
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({1: 2766, 0: 2568, 2: 2066})

Epoch :  45 loss training:  35.28687074035406 Time :  12692
accuracy train: 0.966909 val: 0.755224 test: 0.718526
max validation accuracy : 0.761194 max acc epoch : 17 test accuracy : 0.710116
Counter({2: 2766, 1: 2571, 0: 2063})

Epoch :  46 loss training:  34.049438789486885 Time :  12837
accuracy train: 0.969557 val: 0.767164 test: 0.715805
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2763, 1: 2571, 2: 2066})

Epoch :  47 loss training:  33.773717898875475 Time :  12956
accuracy train: 0.972866 val: 0.761194 test: 0.721989
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2762, 1: 2577, 2: 2061})

Epoch :  48 loss training:  31.26191507279873 Time :  13063
accuracy train: 0.975182 val: 0.761194 test: 0.716794
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2766, 1: 2576, 2: 2058})

Epoch :  49 loss training:  31.440658658742905 Time :  13185
accuracy train: 0.976506 val: 0.755224 test: 0.718279
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({1: 2766, 2: 2576, 0: 2058})

Epoch :  50 loss training:  29.962554194033146 Time :  13283
accuracy train: 0.977498 val: 0.761194 test: 0.715310
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2769, 1: 2575, 2: 2056})

Epoch :  51 loss training:  30.045669849961996 Time :  13438
accuracy train: 0.978822 val: 0.761194 test: 0.717289
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2771, 1: 2575, 2: 2054})

Epoch :  52 loss training:  30.4581399820745 Time :  13557
accuracy train: 0.982793 val: 0.764179 test: 0.716547
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2770, 1: 2575, 2: 2055})

Epoch :  53 loss training:  28.566522166132927 Time :  13658
accuracy train: 0.984116 val: 0.749254 test: 0.714321
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2769, 1: 2581, 2: 2050})

Epoch :  54 loss training:  27.56635209918022 Time :  13784
accuracy train: 0.984447 val: 0.767164 test: 0.714568
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({1: 2775, 2: 2572, 0: 2053})

Epoch :  55 loss training:  27.770059429109097 Time :  13904
accuracy train: 0.985109 val: 0.752239 test: 0.720505
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2775, 1: 2566, 2: 2059})

Epoch :  56 loss training:  26.291968446224928 Time :  14019
accuracy train: 0.988418 val: 0.764179 test: 0.718279
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2776, 1: 2562, 2: 2062})

Epoch :  57 loss training:  23.636368688195944 Time :  14129
accuracy train: 0.988418 val: 0.749254 test: 0.715558
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2778, 1: 2559, 2: 2063})

Epoch :  58 loss training:  23.15456200018525 Time :  14245
accuracy train: 0.987756 val: 0.752239 test: 0.717042
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({1: 2780, 2: 2559, 0: 2061})

Epoch :  59 loss training:  24.024104721844196 Time :  14357
accuracy train: 0.990404 val: 0.737313 test: 0.713332
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({1: 2778, 2: 2557, 0: 2065})

Epoch :  60 loss training:  22.092554479837418 Time :  14468
accuracy train: 0.991396 val: 0.755224 test: 0.714568
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({1: 2779, 2: 2558, 0: 2063})

Epoch :  61 loss training:  22.11982088536024 Time :  14581
accuracy train: 0.990404 val: 0.767164 test: 0.721494
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2782, 1: 2558, 2: 2060})

Epoch :  62 loss training:  22.07875258475542 Time :  14703
accuracy train: 0.991727 val: 0.767164 test: 0.720999
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2783, 1: 2564, 2: 2053})

Epoch :  63 loss training:  20.971174336969852 Time :  14822
accuracy train: 0.992058 val: 0.743284 test: 0.717536
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2794, 1: 2566, 2: 2040})

Epoch :  64 loss training:  20.44573935121298 Time :  14959
accuracy train: 0.992389 val: 0.743284 test: 0.719268
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({2: 2795, 1: 2564, 0: 2041})

Epoch :  65 loss training:  20.69541708752513 Time :  15103
accuracy train: 0.993713 val: 0.746269 test: 0.720257
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2794, 2: 2565, 1: 2041})

Epoch :  66 loss training:  19.833772286772728 Time :  15200
accuracy train: 0.995698 val: 0.761194 test: 0.719021
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({2: 2796, 1: 2561, 0: 2043})

Epoch :  67 loss training:  19.23389070853591 Time :  15330
accuracy train: 0.994705 val: 0.767164 test: 0.723473
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2788, 1: 2561, 2: 2051})

Epoch :  68 loss training:  18.96053721010685 Time :  15453
accuracy train: 0.995367 val: 0.755224 test: 0.716052
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({1: 2789, 2: 2563, 0: 2048})

Epoch :  69 loss training:  17.868646796792746 Time :  15549
accuracy train: 0.995036 val: 0.749254 test: 0.715558
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({2: 2790, 1: 2561, 0: 2049})

Epoch :  70 loss training:  17.18539970368147 Time :  15682
accuracy train: 0.996691 val: 0.758209 test: 0.722731
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({2: 2790, 1: 2560, 0: 2050})

Epoch :  71 loss training:  16.563566125929356 Time :  15818
accuracy train: 0.996029 val: 0.752239 test: 0.718279
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2795, 1: 2560, 2: 2045})

Epoch :  72 loss training:  16.775284245610237 Time :  15951
accuracy train: 0.996029 val: 0.755224 test: 0.720010
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2797, 2: 2560, 1: 2043})

Epoch :  73 loss training:  16.741635520011187 Time :  16068
accuracy train: 0.996691 val: 0.755224 test: 0.714321
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2797, 1: 2557, 2: 2046})

Epoch :  74 loss training:  16.53051575832069 Time :  16194
accuracy train: 0.998015 val: 0.752239 test: 0.717784
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({1: 2796, 2: 2558, 0: 2046})

Epoch :  75 loss training:  14.69339688681066 Time :  16321
accuracy train: 0.998015 val: 0.749254 test: 0.718526
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({2: 2798, 1: 2555, 0: 2047})

Epoch :  76 loss training:  14.770418120548129 Time :  16435
accuracy train: 0.997022 val: 0.752239 test: 0.720257
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({0: 2804, 1: 2557, 2: 2039})

Epoch :  77 loss training:  15.2008416634053 Time :  16544
accuracy train: 0.997684 val: 0.740299 test: 0.716052
max validation accuracy : 0.767164 max acc epoch : 46 test accuracy : 0.715805
Counter({2: 2808, 1: 2556, 0: 2036})

========================================================================================================================================================================================================
max acc epoch :  46
max validation accuracy :  0.7671641791044777
test accuracy :  0.7158050952263171
last test_accuracy :  0.7160524363096711
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.4, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=791, weight_decay=1e-07)
device :  cuda:0
Counter({2: 2591, 1: 2556, 0: 2253})

Epoch :  1 loss training:  223.453766644001 Time :  16894
accuracy train: 0.607214 val: 0.564179 test: 0.575810
max validation accuracy : 0.564179 max acc epoch : 1 test accuracy : 0.575810
Counter({0: 2858, 1: 2413, 2: 2129})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  152.58133059740067 Time :  17027
accuracy train: 0.698875 val: 0.650746 test: 0.654217
max validation accuracy : 0.650746 max acc epoch : 2 test accuracy : 0.654217
Counter({2: 2705, 0: 2629, 1: 2066})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  135.67450815439224 Time :  17133
accuracy train: 0.736929 val: 0.713433 test: 0.660648
max validation accuracy : 0.713433 max acc epoch : 3 test accuracy : 0.660648
Counter({0: 2689, 1: 2611, 2: 2100})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  111.49829077720642 Time :  17295
accuracy train: 0.775645 val: 0.728358 test: 0.686372
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.686372
Counter({0: 2731, 1: 2559, 2: 2110})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  101.7619099020958 Time :  17410
accuracy train: 0.781602 val: 0.701493 test: 0.695770
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.686372
Counter({2: 2727, 1: 2622, 0: 2051})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  99.31744183599949 Time :  17530
accuracy train: 0.782594 val: 0.707463 test: 0.676725
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.686372
Counter({0: 2735, 1: 2671, 2: 1994})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  88.0319841504097 Time :  17628
accuracy train: 0.811383 val: 0.722388 test: 0.689340
max validation accuracy : 0.728358 max acc epoch : 4 test accuracy : 0.686372
Counter({2: 2743, 1: 2676, 0: 1981})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  84.67527824640274 Time :  17763
accuracy train: 0.827267 val: 0.737313 test: 0.702449
max validation accuracy : 0.737313 max acc epoch : 8 test accuracy : 0.702449
Counter({0: 2734, 1: 2691, 2: 1975})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  81.61432132124901 Time :  17881
accuracy train: 0.833554 val: 0.737313 test: 0.704675
max validation accuracy : 0.737313 max acc epoch : 8 test accuracy : 0.702449
Counter({0: 2742, 1: 2686, 2: 1972})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  77.39787393808365 Time :  17986
accuracy train: 0.847121 val: 0.728358 test: 0.708880
max validation accuracy : 0.737313 max acc epoch : 8 test accuracy : 0.702449
Counter({0: 2736, 1: 2681, 2: 1983})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  74.95010259747505 Time :  18155
accuracy train: 0.848445 val: 0.731343 test: 0.708632
max validation accuracy : 0.737313 max acc epoch : 8 test accuracy : 0.702449
Counter({0: 2734, 1: 2686, 2: 1980})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  73.00178343057632 Time :  18270
accuracy train: 0.850099 val: 0.743284 test: 0.710116
max validation accuracy : 0.743284 max acc epoch : 12 test accuracy : 0.710116
Counter({0: 2737, 1: 2684, 2: 1979})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  68.89527794718742 Time :  18415
accuracy train: 0.858041 val: 0.725373 test: 0.712095
max validation accuracy : 0.743284 max acc epoch : 12 test accuracy : 0.710116
Counter({0: 2739, 1: 2685, 2: 1976})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  70.04624776542187 Time :  18515
accuracy train: 0.862012 val: 0.734328 test: 0.709374
max validation accuracy : 0.743284 max acc epoch : 12 test accuracy : 0.710116
Counter({0: 2739, 1: 2685, 2: 1976})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  69.98028913140297 Time :  18651
accuracy train: 0.857379 val: 0.737313 test: 0.707643
max validation accuracy : 0.743284 max acc epoch : 12 test accuracy : 0.710116
Counter({2: 2731, 1: 2687, 0: 1982})

Epoch :  16 loss training:  69.2495002001524 Time :  18791
accuracy train: 0.860688 val: 0.743284 test: 0.711353
max validation accuracy : 0.743284 max acc epoch : 12 test accuracy : 0.710116
Counter({0: 2733, 1: 2683, 2: 1984})

Epoch :  17 loss training:  66.95402058959007 Time :  18910
accuracy train: 0.872601 val: 0.737313 test: 0.709374
max validation accuracy : 0.743284 max acc epoch : 12 test accuracy : 0.710116
Counter({0: 2733, 1: 2687, 2: 1980})

Epoch :  18 loss training:  65.29021947085857 Time :  19044
accuracy train: 0.872601 val: 0.743284 test: 0.711106
max validation accuracy : 0.743284 max acc epoch : 12 test accuracy : 0.710116
Counter({0: 2742, 1: 2689, 2: 1969})

Epoch :  19 loss training:  64.95199392735958 Time :  19177
accuracy train: 0.879219 val: 0.737313 test: 0.716300
max validation accuracy : 0.743284 max acc epoch : 12 test accuracy : 0.710116
Counter({0: 2746, 2: 2688, 1: 1966})

Epoch :  20 loss training:  62.183464497327805 Time :  19273
accuracy train: 0.886830 val: 0.749254 test: 0.713084
max validation accuracy : 0.749254 max acc epoch : 20 test accuracy : 0.713084
Counter({0: 2746, 1: 2695, 2: 1959})

Epoch :  21 loss training:  61.47231976687908 Time :  19385
accuracy train: 0.887492 val: 0.743284 test: 0.715805
max validation accuracy : 0.749254 max acc epoch : 20 test accuracy : 0.713084
Counter({0: 2742, 2: 2699, 1: 1959})

Epoch :  22 loss training:  61.691950008273125 Time :  19517
accuracy train: 0.891132 val: 0.749254 test: 0.714321
max validation accuracy : 0.749254 max acc epoch : 20 test accuracy : 0.713084
Counter({0: 2738, 1: 2700, 2: 1962})

Epoch :  23 loss training:  60.176826640963554 Time :  19624
accuracy train: 0.893117 val: 0.743284 test: 0.713826
max validation accuracy : 0.749254 max acc epoch : 20 test accuracy : 0.713084
Counter({1: 2739, 2: 2697, 0: 1964})

Epoch :  24 loss training:  59.507639080286026 Time :  19768
accuracy train: 0.901390 val: 0.740299 test: 0.713332
max validation accuracy : 0.749254 max acc epoch : 20 test accuracy : 0.713084
Counter({0: 2744, 2: 2697, 1: 1959})

Epoch :  25 loss training:  56.47679890692234 Time :  19875
accuracy train: 0.903044 val: 0.740299 test: 0.716052
max validation accuracy : 0.749254 max acc epoch : 20 test accuracy : 0.713084
Counter({2: 2744, 1: 2699, 0: 1957})

Epoch :  26 loss training:  55.46420845389366 Time :  19995
accuracy train: 0.903706 val: 0.755224 test: 0.714816
max validation accuracy : 0.755224 max acc epoch : 26 test accuracy : 0.714816
Counter({0: 2749, 1: 2694, 2: 1957})

Epoch :  27 loss training:  53.028175547719 Time :  20128
accuracy train: 0.911317 val: 0.761194 test: 0.712590
max validation accuracy : 0.761194 max acc epoch : 27 test accuracy : 0.712590
Counter({0: 2749, 2: 2694, 1: 1957})

Epoch :  28 loss training:  53.74805298447609 Time :  20249
accuracy train: 0.917604 val: 0.734328 test: 0.717536
max validation accuracy : 0.761194 max acc epoch : 27 test accuracy : 0.712590
Counter({0: 2749, 1: 2692, 2: 1959})

Epoch :  29 loss training:  53.48524737358093 Time :  20353
accuracy train: 0.919259 val: 0.740299 test: 0.720505
max validation accuracy : 0.761194 max acc epoch : 27 test accuracy : 0.712590
Counter({2: 2746, 1: 2691, 0: 1963})

Epoch :  30 loss training:  51.128579169511795 Time :  20468
accuracy train: 0.921906 val: 0.752239 test: 0.714074
max validation accuracy : 0.761194 max acc epoch : 27 test accuracy : 0.712590
Counter({0: 2749, 1: 2689, 2: 1962})

Epoch :  31 loss training:  49.579498663544655 Time :  20593
accuracy train: 0.924222 val: 0.746269 test: 0.715558
max validation accuracy : 0.761194 max acc epoch : 27 test accuracy : 0.712590
Counter({0: 2753, 2: 2687, 1: 1960})

Epoch :  32 loss training:  49.87294405698776 Time :  20708
accuracy train: 0.932826 val: 0.752239 test: 0.714321
max validation accuracy : 0.761194 max acc epoch : 27 test accuracy : 0.712590
Counter({0: 2768, 1: 2685, 2: 1947})

Epoch :  33 loss training:  46.0456307977438 Time :  20842
accuracy train: 0.934480 val: 0.749254 test: 0.716547
max validation accuracy : 0.761194 max acc epoch : 27 test accuracy : 0.712590
Counter({0: 2768, 1: 2686, 2: 1946})

Epoch :  34 loss training:  46.113492131233215 Time :  20956
accuracy train: 0.940106 val: 0.740299 test: 0.716794
max validation accuracy : 0.761194 max acc epoch : 27 test accuracy : 0.712590
Counter({0: 2766, 1: 2695, 2: 1939})

Epoch :  35 loss training:  44.720923863351345 Time :  21069
accuracy train: 0.938782 val: 0.749254 test: 0.715805
max validation accuracy : 0.761194 max acc epoch : 27 test accuracy : 0.712590
Counter({0: 2765, 1: 2694, 2: 1941})

Epoch :  36 loss training:  44.81362123042345 Time :  21215
accuracy train: 0.945400 val: 0.749254 test: 0.711848
max validation accuracy : 0.761194 max acc epoch : 27 test accuracy : 0.712590
Counter({0: 2766, 1: 2693, 2: 1941})

Epoch :  37 loss training:  44.724790312349796 Time :  21340
accuracy train: 0.948379 val: 0.758209 test: 0.711848
max validation accuracy : 0.761194 max acc epoch : 27 test accuracy : 0.712590
Counter({1: 2768, 0: 2697, 2: 1935})

Epoch :  38 loss training:  41.71454322338104 Time :  21452
accuracy train: 0.950695 val: 0.740299 test: 0.714074
max validation accuracy : 0.761194 max acc epoch : 27 test accuracy : 0.712590
Counter({0: 2771, 1: 2701, 2: 1928})

Epoch :  39 loss training:  40.20467407256365 Time :  21581
accuracy train: 0.954997 val: 0.749254 test: 0.711848
max validation accuracy : 0.761194 max acc epoch : 27 test accuracy : 0.712590
Counter({0: 2778, 2: 2700, 1: 1922})

Epoch :  40 loss training:  40.24203631281853 Time :  21708
accuracy train: 0.953673 val: 0.758209 test: 0.715310
max validation accuracy : 0.761194 max acc epoch : 27 test accuracy : 0.712590
Counter({0: 2777, 1: 2699, 2: 1924})

Epoch :  41 loss training:  38.650203227996826 Time :  21819
accuracy train: 0.960291 val: 0.767164 test: 0.715310
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2777, 1: 2707, 2: 1916})

Epoch :  42 loss training:  37.09883137047291 Time :  21953
accuracy train: 0.965255 val: 0.752239 test: 0.719763
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2781, 2: 2710, 1: 1909})

Epoch :  43 loss training:  38.227858409285545 Time :  22083
accuracy train: 0.967902 val: 0.746269 test: 0.718279
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2778, 1: 2724, 2: 1898})

Epoch :  44 loss training:  34.320390574634075 Time :  22208
accuracy train: 0.967571 val: 0.749254 test: 0.717784
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2781, 2: 2723, 1: 1896})

Epoch :  45 loss training:  35.53436080366373 Time :  22334
accuracy train: 0.969887 val: 0.752239 test: 0.717784
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({1: 2777, 0: 2727, 2: 1896})

Epoch :  46 loss training:  35.07480835914612 Time :  22442
accuracy train: 0.968233 val: 0.758209 test: 0.713826
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2773, 2: 2733, 1: 1894})

Epoch :  47 loss training:  31.958041712641716 Time :  22536
accuracy train: 0.977167 val: 0.749254 test: 0.718773
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2769, 1: 2738, 2: 1893})

Epoch :  48 loss training:  32.12684701383114 Time :  22659
accuracy train: 0.976175 val: 0.764179 test: 0.717289
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({2: 2763, 1: 2735, 0: 1902})

Epoch :  49 loss training:  31.519435666501522 Time :  22768
accuracy train: 0.975844 val: 0.764179 test: 0.715063
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2767, 2: 2734, 1: 1899})

Epoch :  50 loss training:  30.54678338766098 Time :  22865
accuracy train: 0.976175 val: 0.752239 test: 0.718526
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2766, 2: 2733, 1: 1901})

Epoch :  51 loss training:  30.531249590218067 Time :  23002
accuracy train: 0.978822 val: 0.758209 test: 0.716300
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2767, 1: 2732, 2: 1901})

Epoch :  52 loss training:  28.03703138232231 Time :  23093
accuracy train: 0.980146 val: 0.755224 test: 0.713332
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2764, 1: 2730, 2: 1906})

Epoch :  53 loss training:  29.393918082118034 Time :  23240
accuracy train: 0.982793 val: 0.752239 test: 0.713332
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2769, 1: 2730, 2: 1901})

Epoch :  54 loss training:  26.458462484180927 Time :  23342
accuracy train: 0.983455 val: 0.752239 test: 0.718526
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({1: 2773, 0: 2720, 2: 1907})

Epoch :  55 loss training:  27.452685741707683 Time :  23477
accuracy train: 0.986433 val: 0.752239 test: 0.718773
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2773, 1: 2720, 2: 1907})

Epoch :  56 loss training:  26.865417767316103 Time :  23578
accuracy train: 0.986433 val: 0.764179 test: 0.716300
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({2: 2774, 1: 2720, 0: 1906})

Epoch :  57 loss training:  25.262457996606827 Time :  23675
accuracy train: 0.986102 val: 0.758209 test: 0.717042
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2782, 1: 2713, 2: 1905})

Epoch :  58 loss training:  25.528812784701586 Time :  23798
accuracy train: 0.988087 val: 0.758209 test: 0.718031
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({1: 2784, 0: 2714, 2: 1902})

Epoch :  59 loss training:  25.037362042814493 Time :  23893
accuracy train: 0.988087 val: 0.746269 test: 0.709869
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2783, 1: 2712, 2: 1905})

Epoch :  60 loss training:  23.464337691664696 Time :  23995
accuracy train: 0.988087 val: 0.743284 test: 0.715063
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2793, 1: 2705, 2: 1902})

Epoch :  61 loss training:  21.713585287332535 Time :  24103
accuracy train: 0.991066 val: 0.755224 test: 0.717784
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2793, 1: 2707, 2: 1900})

Epoch :  62 loss training:  21.65223041176796 Time :  24221
accuracy train: 0.992389 val: 0.746269 test: 0.718526
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2789, 1: 2708, 2: 1903})

Epoch :  63 loss training:  21.08926772326231 Time :  24323
accuracy train: 0.993382 val: 0.749254 test: 0.720257
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2791, 1: 2706, 2: 1903})

Epoch :  64 loss training:  20.420311339199543 Time :  24410
accuracy train: 0.991727 val: 0.755224 test: 0.717536
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({1: 2792, 2: 2704, 0: 1904})

Epoch :  65 loss training:  20.31479885056615 Time :  24532
accuracy train: 0.995036 val: 0.758209 test: 0.719763
max validation accuracy : 0.767164 max acc epoch : 41 test accuracy : 0.715310
Counter({0: 2791, 2: 2703, 1: 1906})

Epoch :  66 loss training:  19.792436882853508 Time :  24625
accuracy train: 0.995036 val: 0.773134 test: 0.720505
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({2: 2796, 1: 2704, 0: 1900})

Epoch :  67 loss training:  19.55698014423251 Time :  24715
accuracy train: 0.994705 val: 0.767164 test: 0.718773
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({1: 2798, 0: 2704, 2: 1898})

Epoch :  68 loss training:  18.87300632894039 Time :  24829
accuracy train: 0.994375 val: 0.758209 test: 0.717536
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2798, 1: 2701, 2: 1901})

Epoch :  69 loss training:  16.153469838202 Time :  24951
accuracy train: 0.996029 val: 0.758209 test: 0.717042
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2800, 1: 2700, 2: 1900})

Epoch :  70 loss training:  18.792133934795856 Time :  25054
accuracy train: 0.995698 val: 0.752239 test: 0.719763
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2806, 1: 2690, 2: 1904})

Epoch :  71 loss training:  16.875509144738317 Time :  25160
accuracy train: 0.995367 val: 0.740299 test: 0.716300
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2805, 1: 2681, 2: 1914})

Epoch :  72 loss training:  16.801919505000114 Time :  25259
accuracy train: 0.995367 val: 0.758209 test: 0.719268
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2807, 1: 2682, 2: 1911})

Epoch :  73 loss training:  16.506078854203224 Time :  25349
accuracy train: 0.996691 val: 0.737313 test: 0.715063
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2808, 1: 2681, 2: 1911})

Epoch :  74 loss training:  15.739265069365501 Time :  25434
accuracy train: 0.996360 val: 0.743284 test: 0.714074
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2811, 1: 2682, 2: 1907})

Epoch :  75 loss training:  14.968488959595561 Time :  25543
accuracy train: 0.997684 val: 0.758209 test: 0.715063
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({1: 2813, 0: 2676, 2: 1911})

Epoch :  76 loss training:  14.933219332247972 Time :  25635
accuracy train: 0.997684 val: 0.764179 test: 0.713332
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2811, 1: 2681, 2: 1908})

Epoch :  77 loss training:  14.24206118285656 Time :  25733
accuracy train: 0.997353 val: 0.758209 test: 0.716547
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({2: 2809, 1: 2683, 0: 1908})

Epoch :  78 loss training:  14.499391697347164 Time :  25827
accuracy train: 0.998015 val: 0.764179 test: 0.712837
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({2: 2808, 1: 2683, 0: 1909})

Epoch :  79 loss training:  13.41805356927216 Time :  25925
accuracy train: 0.998015 val: 0.764179 test: 0.713579
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({1: 2808, 0: 2684, 2: 1908})

Epoch :  80 loss training:  13.076783629134297 Time :  26038
accuracy train: 0.998676 val: 0.752239 test: 0.716052
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2806, 2: 2684, 1: 1910})

Epoch :  81 loss training:  12.984320181421936 Time :  26131
accuracy train: 0.998015 val: 0.749254 test: 0.710116
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2807, 1: 2686, 2: 1907})

Epoch :  82 loss training:  12.956681407056749 Time :  26217
accuracy train: 0.999338 val: 0.758209 test: 0.716300
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({2: 2807, 1: 2686, 0: 1907})

Epoch :  83 loss training:  12.458189561963081 Time :  26313
accuracy train: 0.999007 val: 0.752239 test: 0.716794
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2809, 2: 2684, 1: 1907})

Epoch :  84 loss training:  12.504440432414412 Time :  26422
accuracy train: 0.999338 val: 0.758209 test: 0.715310
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2802, 1: 2684, 2: 1914})

Epoch :  85 loss training:  11.871181673370302 Time :  26533
accuracy train: 0.998015 val: 0.755224 test: 0.717784
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2808, 2: 2680, 1: 1912})

Epoch :  86 loss training:  11.509060863405466 Time :  26616
accuracy train: 0.998345 val: 0.764179 test: 0.716052
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2808, 1: 2681, 2: 1911})

Epoch :  87 loss training:  11.320526853203773 Time :  26732
accuracy train: 1.000000 val: 0.755224 test: 0.713332
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({2: 2811, 1: 2682, 0: 1907})

Epoch :  88 loss training:  10.208094279281795 Time :  26846
accuracy train: 0.998676 val: 0.767164 test: 0.716547
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2814, 1: 2682, 2: 1904})

Epoch :  89 loss training:  11.036514630541205 Time :  26932
accuracy train: 0.999007 val: 0.761194 test: 0.711848
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({1: 2812, 2: 2680, 0: 1908})

Epoch :  90 loss training:  10.128598432056606 Time :  27034
accuracy train: 0.999669 val: 0.770149 test: 0.715063
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2814, 1: 2679, 2: 1907})

Epoch :  91 loss training:  10.47316343523562 Time :  27146
accuracy train: 0.999338 val: 0.770149 test: 0.710364
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2814, 2: 2677, 1: 1909})

Epoch :  92 loss training:  10.401192610152066 Time :  27247
accuracy train: 1.000000 val: 0.755224 test: 0.714321
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2813, 2: 2678, 1: 1909})

Epoch :  93 loss training:  10.073543949052691 Time :  27334
accuracy train: 0.999669 val: 0.761194 test: 0.718031
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2818, 1: 2679, 2: 1903})

Epoch :  94 loss training:  9.176478366367519 Time :  27427
accuracy train: 0.999669 val: 0.758209 test: 0.713826
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({2: 2817, 1: 2679, 0: 1904})

Epoch :  95 loss training:  9.426126806996763 Time :  27554
accuracy train: 1.000000 val: 0.761194 test: 0.715805
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({2: 2817, 1: 2678, 0: 1905})

Epoch :  96 loss training:  9.712574182078242 Time :  27645
accuracy train: 0.999007 val: 0.761194 test: 0.715063
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2817, 1: 2681, 2: 1902})

Epoch :  97 loss training:  8.37014340609312 Time :  27734
accuracy train: 1.000000 val: 0.755224 test: 0.711848
max validation accuracy : 0.773134 max acc epoch : 66 test accuracy : 0.720505
Counter({0: 2828, 1: 2671, 2: 1901})

========================================================================================================================================================================================================
max acc epoch :  66
max validation accuracy :  0.7731343283582089
test accuracy :  0.720504575810042
last test_accuracy :  0.7118476378926539
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='ohsumed', device=0, dropout=0.4, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=791, weight_decay=1e-07)
device :  cuda:0
Counter({2: 2591, 1: 2556, 0: 2253})

Epoch :  1 loss training:  223.47648167610168 Time :  28026
accuracy train: 0.614825 val: 0.564179 test: 0.588672
max validation accuracy : 0.564179 max acc epoch : 1 test accuracy : 0.588672
Counter({0: 2837, 2: 2474, 1: 2089})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  151.57144737243652 Time :  28130
accuracy train: 0.696559 val: 0.647761 test: 0.650754
max validation accuracy : 0.647761 max acc epoch : 2 test accuracy : 0.650754
Counter({0: 2816, 1: 2568, 2: 2016})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  135.66028732061386 Time :  28247
accuracy train: 0.731635 val: 0.692537 test: 0.653970
max validation accuracy : 0.692537 max acc epoch : 3 test accuracy : 0.653970
Counter({2: 2764, 0: 2499, 1: 2137})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  111.68775841593742 Time :  28351
accuracy train: 0.772667 val: 0.710448 test: 0.684887
max validation accuracy : 0.710448 max acc epoch : 4 test accuracy : 0.684887
Counter({1: 2759, 2: 2496, 0: 2145})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  101.74185520410538 Time :  28465
accuracy train: 0.777962 val: 0.698507 test: 0.693544
max validation accuracy : 0.710448 max acc epoch : 4 test accuracy : 0.684887
Counter({0: 2723, 2: 2593, 1: 2084})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  100.04794353246689 Time :  28578
accuracy train: 0.788882 val: 0.701493 test: 0.682661
max validation accuracy : 0.710448 max acc epoch : 4 test accuracy : 0.684887
Counter({1: 2720, 0: 2621, 2: 2059})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  91.01656636595726 Time :  28678
accuracy train: 0.811383 val: 0.716418 test: 0.692802
max validation accuracy : 0.716418 max acc epoch : 7 test accuracy : 0.692802
Counter({0: 2733, 1: 2629, 2: 2038})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  85.43221142888069 Time :  28777
accuracy train: 0.830907 val: 0.725373 test: 0.700965
max validation accuracy : 0.725373 max acc epoch : 8 test accuracy : 0.700965
Counter({0: 2754, 1: 2634, 2: 2012})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  80.94069069623947 Time :  28892
accuracy train: 0.830907 val: 0.743284 test: 0.703191
max validation accuracy : 0.743284 max acc epoch : 9 test accuracy : 0.703191
Counter({0: 2759, 1: 2632, 2: 2009})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  76.12763020396233 Time :  29017
accuracy train: 0.844474 val: 0.743284 test: 0.703438
max validation accuracy : 0.743284 max acc epoch : 9 test accuracy : 0.703191
Counter({0: 2757, 2: 2632, 1: 2011})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  74.46230772137642 Time :  29121
accuracy train: 0.842819 val: 0.749254 test: 0.703685
max validation accuracy : 0.749254 max acc epoch : 11 test accuracy : 0.703685
Counter({0: 2757, 1: 2631, 2: 2012})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  73.63900887966156 Time :  29207
accuracy train: 0.850430 val: 0.731343 test: 0.708880
max validation accuracy : 0.749254 max acc epoch : 11 test accuracy : 0.703685
Counter({1: 2761, 2: 2630, 0: 2009})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  70.49636861681938 Time :  29297
accuracy train: 0.857379 val: 0.743284 test: 0.711848
max validation accuracy : 0.749254 max acc epoch : 11 test accuracy : 0.703685
Counter({0: 2763, 1: 2633, 2: 2004})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  70.25450022518635 Time :  29402
accuracy train: 0.861350 val: 0.734328 test: 0.709869
max validation accuracy : 0.749254 max acc epoch : 11 test accuracy : 0.703685
Counter({0: 2766, 1: 2631, 2: 2003})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  70.52908842265606 Time :  29507
accuracy train: 0.858041 val: 0.743284 test: 0.707643
max validation accuracy : 0.749254 max acc epoch : 11 test accuracy : 0.703685
Counter({0: 2770, 1: 2629, 2: 2001})

Epoch :  16 loss training:  67.11044296622276 Time :  29606
accuracy train: 0.864328 val: 0.737313 test: 0.710611
max validation accuracy : 0.749254 max acc epoch : 11 test accuracy : 0.703685
Counter({0: 2773, 1: 2632, 2: 1995})

Epoch :  17 loss training:  66.88934303820133 Time :  29702
accuracy train: 0.871277 val: 0.746269 test: 0.710116
max validation accuracy : 0.749254 max acc epoch : 11 test accuracy : 0.703685
Counter({0: 2774, 1: 2631, 2: 1995})

Epoch :  18 loss training:  66.6322010755539 Time :  29810
accuracy train: 0.873594 val: 0.743284 test: 0.710116
max validation accuracy : 0.749254 max acc epoch : 11 test accuracy : 0.703685
Counter({0: 2777, 1: 2631, 2: 1992})

Epoch :  19 loss training:  65.77293221652508 Time :  29936
accuracy train: 0.880212 val: 0.734328 test: 0.709869
max validation accuracy : 0.749254 max acc epoch : 11 test accuracy : 0.703685
Counter({1: 2781, 2: 2628, 0: 1991})

Epoch :  20 loss training:  63.607409954071045 Time :  30027
accuracy train: 0.881205 val: 0.743284 test: 0.710611
max validation accuracy : 0.749254 max acc epoch : 11 test accuracy : 0.703685
Counter({0: 2780, 1: 2630, 2: 1990})

Epoch :  21 loss training:  62.382151052355766 Time :  30155
accuracy train: 0.886499 val: 0.743284 test: 0.706653
max validation accuracy : 0.749254 max acc epoch : 11 test accuracy : 0.703685
Counter({1: 2776, 2: 2628, 0: 1996})

Epoch :  22 loss training:  61.73716001212597 Time :  30263
accuracy train: 0.889808 val: 0.746269 test: 0.710611
max validation accuracy : 0.749254 max acc epoch : 11 test accuracy : 0.703685
Counter({1: 2774, 0: 2628, 2: 1998})

Epoch :  23 loss training:  58.63653567433357 Time :  30362
accuracy train: 0.892786 val: 0.734328 test: 0.714816
max validation accuracy : 0.749254 max acc epoch : 11 test accuracy : 0.703685
Counter({0: 2777, 1: 2627, 2: 1996})

Epoch :  24 loss training:  59.34061689674854 Time :  30473
accuracy train: 0.899404 val: 0.743284 test: 0.713826
max validation accuracy : 0.749254 max acc epoch : 11 test accuracy : 0.703685
Counter({0: 2777, 2: 2625, 1: 1998})

Epoch :  25 loss training:  57.215024530887604 Time :  30584
accuracy train: 0.906353 val: 0.752239 test: 0.713579
max validation accuracy : 0.752239 max acc epoch : 25 test accuracy : 0.713579
Counter({1: 2775, 0: 2627, 2: 1998})

Epoch :  26 loss training:  56.07700705528259 Time :  30679
accuracy train: 0.904368 val: 0.749254 test: 0.711106
max validation accuracy : 0.752239 max acc epoch : 25 test accuracy : 0.713579
Counter({0: 2786, 1: 2615, 2: 1999})

Epoch :  27 loss training:  54.60648746788502 Time :  30775
accuracy train: 0.908008 val: 0.752239 test: 0.709622
max validation accuracy : 0.752239 max acc epoch : 25 test accuracy : 0.713579
Counter({1: 2785, 2: 2620, 0: 1995})

Epoch :  28 loss training:  52.90702970325947 Time :  30870
accuracy train: 0.917273 val: 0.755224 test: 0.713332
max validation accuracy : 0.755224 max acc epoch : 28 test accuracy : 0.713332
Counter({1: 2785, 2: 2620, 0: 1995})

Epoch :  29 loss training:  51.867684707045555 Time :  30980
accuracy train: 0.916942 val: 0.740299 test: 0.715558
max validation accuracy : 0.755224 max acc epoch : 28 test accuracy : 0.713332
Counter({0: 2784, 2: 2622, 1: 1994})

Epoch :  30 loss training:  50.25167232751846 Time :  31091
accuracy train: 0.925546 val: 0.752239 test: 0.713332
max validation accuracy : 0.755224 max acc epoch : 28 test accuracy : 0.713332
Counter({0: 2782, 1: 2627, 2: 1991})

Epoch :  31 loss training:  49.83633528649807 Time :  31191
accuracy train: 0.923891 val: 0.761194 test: 0.715310
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({1: 2783, 2: 2624, 0: 1993})

Epoch :  32 loss training:  48.972116120159626 Time :  31309
accuracy train: 0.926539 val: 0.749254 test: 0.713579
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({1: 2784, 2: 2622, 0: 1994})

Epoch :  33 loss training:  48.760882534086704 Time :  31418
accuracy train: 0.932164 val: 0.749254 test: 0.715063
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({0: 2789, 1: 2621, 2: 1990})

Epoch :  34 loss training:  47.53657205402851 Time :  31524
accuracy train: 0.934150 val: 0.746269 test: 0.715805
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({0: 2788, 2: 2633, 1: 1979})

Epoch :  35 loss training:  47.4230088442564 Time :  31620
accuracy train: 0.934150 val: 0.740299 test: 0.712095
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({0: 2787, 1: 2634, 2: 1979})

Epoch :  36 loss training:  45.38206070661545 Time :  31711
accuracy train: 0.943084 val: 0.755224 test: 0.720257
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({2: 2789, 1: 2633, 0: 1978})

Epoch :  37 loss training:  43.4180763065815 Time :  31807
accuracy train: 0.946062 val: 0.746269 test: 0.715805
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({1: 2798, 2: 2624, 0: 1978})

Epoch :  38 loss training:  41.203509636223316 Time :  31878
accuracy train: 0.950695 val: 0.743284 test: 0.720010
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({0: 2799, 1: 2629, 2: 1972})

Epoch :  39 loss training:  39.90278020501137 Time :  31952
accuracy train: 0.954004 val: 0.758209 test: 0.714816
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({2: 2810, 1: 2646, 0: 1944})

Epoch :  40 loss training:  40.427893422544 Time :  32039
accuracy train: 0.955328 val: 0.752239 test: 0.721247
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({0: 2810, 2: 2644, 1: 1946})

Epoch :  41 loss training:  39.37969736754894 Time :  32120
accuracy train: 0.956651 val: 0.752239 test: 0.718279
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({1: 2816, 2: 2638, 0: 1946})

Epoch :  42 loss training:  38.53371089696884 Time :  32205
accuracy train: 0.958637 val: 0.743284 test: 0.718526
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({0: 2810, 1: 2642, 2: 1948})

Epoch :  43 loss training:  37.32640542089939 Time :  32288
accuracy train: 0.965917 val: 0.743284 test: 0.721247
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({2: 2811, 1: 2637, 0: 1952})

Epoch :  44 loss training:  36.58076561242342 Time :  32374
accuracy train: 0.962938 val: 0.755224 test: 0.715063
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({0: 2807, 1: 2641, 2: 1952})

Epoch :  45 loss training:  36.89025504142046 Time :  32468
accuracy train: 0.968564 val: 0.752239 test: 0.714074
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({2: 2800, 1: 2641, 0: 1959})

Epoch :  46 loss training:  36.566241540014744 Time :  32565
accuracy train: 0.968233 val: 0.749254 test: 0.712590
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({0: 2797, 1: 2641, 2: 1962})

Epoch :  47 loss training:  34.590054638683796 Time :  32655
accuracy train: 0.969557 val: 0.734328 test: 0.716547
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({0: 2802, 1: 2638, 2: 1960})

Epoch :  48 loss training:  31.878669515252113 Time :  32734
accuracy train: 0.973197 val: 0.752239 test: 0.719515
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({2: 2805, 1: 2640, 0: 1955})

Epoch :  49 loss training:  31.19646204262972 Time :  32838
accuracy train: 0.973858 val: 0.740299 test: 0.717042
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({2: 2808, 0: 2644, 1: 1948})

Epoch :  50 loss training:  32.07134824991226 Time :  32913
accuracy train: 0.977498 val: 0.749254 test: 0.717289
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({0: 2814, 2: 2649, 1: 1937})

Epoch :  51 loss training:  29.98778010159731 Time :  33003
accuracy train: 0.979484 val: 0.761194 test: 0.716052
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({0: 2818, 1: 2650, 2: 1932})

Epoch :  52 loss training:  30.08158929646015 Time :  33090
accuracy train: 0.980477 val: 0.743284 test: 0.717042
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({0: 2824, 1: 2648, 2: 1928})

Epoch :  53 loss training:  28.84999790787697 Time :  33183
accuracy train: 0.984116 val: 0.746269 test: 0.718773
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({2: 2820, 1: 2653, 0: 1927})

Epoch :  54 loss training:  28.34482443332672 Time :  33273
accuracy train: 0.983455 val: 0.749254 test: 0.720505
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({2: 2820, 1: 2648, 0: 1932})

Epoch :  55 loss training:  27.707354098558426 Time :  33357
accuracy train: 0.985109 val: 0.749254 test: 0.720010
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({0: 2811, 1: 2650, 2: 1939})

Epoch :  56 loss training:  26.90701437741518 Time :  33440
accuracy train: 0.986433 val: 0.752239 test: 0.718526
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({0: 2813, 1: 2654, 2: 1933})

Epoch :  57 loss training:  24.772002279758453 Time :  33517
accuracy train: 0.986764 val: 0.731343 test: 0.716547
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({1: 2811, 2: 2653, 0: 1936})

Epoch :  58 loss training:  24.27605477720499 Time :  33598
accuracy train: 0.988087 val: 0.734328 test: 0.714568
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({0: 2817, 1: 2646, 2: 1937})

Epoch :  59 loss training:  24.389350425451994 Time :  33685
accuracy train: 0.986764 val: 0.734328 test: 0.710858
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({1: 2816, 2: 2643, 0: 1941})

Epoch :  60 loss training:  22.184806931763887 Time :  33760
accuracy train: 0.988418 val: 0.731343 test: 0.712342
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({2: 2817, 0: 2644, 1: 1939})

Epoch :  61 loss training:  22.89451789110899 Time :  33833
accuracy train: 0.989080 val: 0.752239 test: 0.718279
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({0: 2818, 1: 2643, 2: 1939})

Epoch :  62 loss training:  22.799499440938234 Time :  33924
accuracy train: 0.992389 val: 0.746269 test: 0.714321
max validation accuracy : 0.761194 max acc epoch : 31 test accuracy : 0.715310
Counter({2: 2811, 1: 2646, 0: 1943})

========================================================================================================================================================================================================
max acc epoch :  31
max validation accuracy :  0.7611940298507462
test accuracy :  0.7153104130596092
last test_accuracy :  0.7143210487261934
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.77612 	 test_accuracy : 0.71976 	 max_acc epoch :  42 	 last test_accuracy : 0.71160
k :  1 	 val_accuracy : 0.76716 	 test_accuracy : 0.71581 	 max_acc epoch :  46 	 last test_accuracy : 0.71605
k :  2 	 val_accuracy : 0.77313 	 test_accuracy : 0.72050 	 max_acc epoch :  66 	 last test_accuracy : 0.71185
k :  3 	 val_accuracy : 0.76119 	 test_accuracy : 0.71531 	 max_acc epoch :  31 	 last test_accuracy : 0.71432

avg :  	 val_accuracy : 0.76940 	 test_accuracy : 0.71785 	 last_accuracy : 0.71346
