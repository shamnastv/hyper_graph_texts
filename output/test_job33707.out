

date and time :  Sun May 23 20:52:35 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.4, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=552, weight_decay=1e-07)
device :  cuda:0
Counter({0: 4230, 2: 2303, 1: 1158})

Epoch :  1 loss training:  45.67715668678284 Time :  171
accuracy train: 0.968491 val: 0.934545 test: 0.953425
max validation accuracy : 0.934545 max acc epoch : 1 test accuracy : 0.953425
Counter({1: 3677, 0: 2457, 2: 1557})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.46542526036501 Time :  251
accuracy train: 0.972127 val: 0.938182 test: 0.951598
max validation accuracy : 0.938182 max acc epoch : 2 test accuracy : 0.951598
Counter({1: 3760, 0: 2467, 2: 1464})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.359009139239788 Time :  354
accuracy train: 0.975560 val: 0.947273 test: 0.954795
max validation accuracy : 0.947273 max acc epoch : 3 test accuracy : 0.954795
Counter({2: 3795, 1: 2442, 0: 1454})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.14744739443995 Time :  453
accuracy train: 0.979802 val: 0.952727 test: 0.969406
max validation accuracy : 0.952727 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3821, 0: 2429, 2: 1441})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.458550281822681 Time :  549
accuracy train: 0.981620 val: 0.949091 test: 0.965753
max validation accuracy : 0.952727 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3841, 2: 2411, 0: 1439})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.26734532462433 Time :  627
accuracy train: 0.984246 val: 0.949091 test: 0.966667
max validation accuracy : 0.952727 max acc epoch : 4 test accuracy : 0.969406
Counter({2: 3854, 0: 2397, 1: 1440})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  8.681628172751516 Time :  706
accuracy train: 0.986871 val: 0.952727 test: 0.968037
max validation accuracy : 0.952727 max acc epoch : 4 test accuracy : 0.969406
Counter({1: 3857, 0: 2393, 2: 1441})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  8.313673261553049 Time :  793
accuracy train: 0.987881 val: 0.956364 test: 0.964840
max validation accuracy : 0.956364 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3865, 0: 2388, 2: 1438})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  8.257649038452655 Time :  885
accuracy train: 0.989295 val: 0.952727 test: 0.965297
max validation accuracy : 0.956364 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3864, 0: 2387, 2: 1440})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.590622250107117 Time :  994
accuracy train: 0.990507 val: 0.954545 test: 0.968493
max validation accuracy : 0.956364 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3865, 0: 2387, 2: 1439})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  6.096611146116629 Time :  1067
accuracy train: 0.991315 val: 0.954545 test: 0.967580
max validation accuracy : 0.956364 max acc epoch : 8 test accuracy : 0.964840
Counter({1: 3865, 2: 2387, 0: 1439})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  6.8270951573504135 Time :  1137
accuracy train: 0.992123 val: 0.963636 test: 0.963927
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.963927
Counter({1: 3866, 2: 2385, 0: 1440})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  6.589358982630074 Time :  1219
accuracy train: 0.989093 val: 0.950909 test: 0.965297
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.963927
Counter({1: 3869, 0: 2381, 2: 1441})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  5.8458095010137185 Time :  1294
accuracy train: 0.987881 val: 0.952727 test: 0.965753
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.963927
Counter({2: 3870, 0: 2381, 1: 1440})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  5.888862976105884 Time :  1381
accuracy train: 0.991719 val: 0.961818 test: 0.967123
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.963927
Counter({1: 3879, 0: 2374, 2: 1438})

Epoch :  16 loss training:  5.335977590992115 Time :  1454
accuracy train: 0.992527 val: 0.956364 test: 0.966667
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.963927
Counter({1: 3879, 0: 2374, 2: 1438})

Epoch :  17 loss training:  5.621590158436447 Time :  1522
accuracy train: 0.990507 val: 0.954545 test: 0.965753
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.963927
Counter({1: 3881, 0: 2374, 2: 1436})

Epoch :  18 loss training:  5.262067781877704 Time :  1589
accuracy train: 0.991113 val: 0.954545 test: 0.964384
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.963927
Counter({1: 3881, 0: 2374, 2: 1436})

Epoch :  19 loss training:  5.690686527872458 Time :  1679
accuracy train: 0.992325 val: 0.956364 test: 0.968493
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.963927
Counter({1: 3883, 0: 2371, 2: 1437})

Epoch :  20 loss training:  4.8720267955213785 Time :  1772
accuracy train: 0.993133 val: 0.956364 test: 0.970320
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.963927
Counter({1: 3883, 0: 2371, 2: 1437})

Epoch :  21 loss training:  4.796790030319244 Time :  1850
accuracy train: 0.993133 val: 0.963636 test: 0.969406
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.963927
Counter({1: 3892, 2: 2364, 0: 1435})

Epoch :  22 loss training:  4.137547368882224 Time :  1926
accuracy train: 0.992325 val: 0.958182 test: 0.969406
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.963927
Counter({1: 3892, 2: 2364, 0: 1435})

Epoch :  23 loss training:  5.083441691589542 Time :  2013
accuracy train: 0.993739 val: 0.960000 test: 0.968493
max validation accuracy : 0.963636 max acc epoch : 12 test accuracy : 0.963927
Counter({1: 3893, 0: 2363, 2: 1435})

Epoch :  24 loss training:  4.50569998472929 Time :  2109
accuracy train: 0.993537 val: 0.965455 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3898, 2: 2361, 0: 1432})

Epoch :  25 loss training:  3.9486521504586563 Time :  2189
accuracy train: 0.993133 val: 0.954545 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3898, 0: 2361, 2: 1432})

Epoch :  26 loss training:  3.969328965060413 Time :  2267
accuracy train: 0.993739 val: 0.960000 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3901, 0: 2358, 2: 1432})

Epoch :  27 loss training:  4.145086604228709 Time :  2353
accuracy train: 0.994547 val: 0.961818 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({0: 3901, 1: 2358, 2: 1432})

Epoch :  28 loss training:  4.4363623689860106 Time :  2441
accuracy train: 0.994951 val: 0.956364 test: 0.971689
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3902, 2: 2357, 0: 1432})

Epoch :  29 loss training:  3.7745161195052788 Time :  2536
accuracy train: 0.994951 val: 0.956364 test: 0.971689
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3903, 0: 2358, 2: 1430})

Epoch :  30 loss training:  3.8554665442206897 Time :  2606
accuracy train: 0.994547 val: 0.958182 test: 0.968037
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3904, 0: 2358, 2: 1429})

Epoch :  31 loss training:  3.6798714388278313 Time :  2675
accuracy train: 0.993739 val: 0.954545 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3906, 0: 2356, 2: 1429})

Epoch :  32 loss training:  3.239722972852178 Time :  2743
accuracy train: 0.994951 val: 0.961818 test: 0.968493
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3908, 0: 2354, 2: 1429})

Epoch :  33 loss training:  3.364540188864339 Time :  2820
accuracy train: 0.995354 val: 0.958182 test: 0.971689
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3910, 0: 2352, 2: 1429})

Epoch :  34 loss training:  4.242751246143598 Time :  2913
accuracy train: 0.995152 val: 0.960000 test: 0.967580
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3913, 2: 2347, 0: 1431})

Epoch :  35 loss training:  3.3217560300254263 Time :  2986
accuracy train: 0.994951 val: 0.960000 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({2: 3913, 0: 2345, 1: 1433})

Epoch :  36 loss training:  3.041537667333614 Time :  3063
accuracy train: 0.994951 val: 0.954545 test: 0.968037
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({2: 3914, 0: 2343, 1: 1434})

Epoch :  37 loss training:  3.062901097058784 Time :  3135
accuracy train: 0.995556 val: 0.954545 test: 0.971689
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3914, 0: 2341, 2: 1436})

Epoch :  38 loss training:  3.032691215252271 Time :  3207
accuracy train: 0.995960 val: 0.958182 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3915, 0: 2338, 2: 1438})

Epoch :  39 loss training:  2.626039167458657 Time :  3278
accuracy train: 0.995354 val: 0.956364 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3915, 0: 2338, 2: 1438})

Epoch :  40 loss training:  2.6505524855456315 Time :  3347
accuracy train: 0.996162 val: 0.954545 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3915, 0: 2338, 2: 1438})

Epoch :  41 loss training:  2.795794698118698 Time :  3419
accuracy train: 0.995960 val: 0.952727 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3916, 0: 2336, 2: 1439})

Epoch :  42 loss training:  2.3538680360652506 Time :  3492
accuracy train: 0.995960 val: 0.950909 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3916, 0: 2336, 2: 1439})

Epoch :  43 loss training:  2.570348442532122 Time :  3563
accuracy train: 0.996364 val: 0.949091 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3916, 0: 2337, 2: 1438})

Epoch :  44 loss training:  2.5979661609162576 Time :  3643
accuracy train: 0.995960 val: 0.956364 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3916, 0: 2336, 2: 1439})

Epoch :  45 loss training:  2.5588132995180786 Time :  3724
accuracy train: 0.995758 val: 0.956364 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3917, 0: 2336, 2: 1438})

Epoch :  46 loss training:  2.5087258073908743 Time :  3793
accuracy train: 0.995758 val: 0.956364 test: 0.968493
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3917, 0: 2335, 2: 1439})

Epoch :  47 loss training:  2.380585956852883 Time :  3864
accuracy train: 0.995960 val: 0.952727 test: 0.968037
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3916, 0: 2337, 2: 1438})

Epoch :  48 loss training:  2.5295838289603125 Time :  3940
accuracy train: 0.996364 val: 0.952727 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3918, 0: 2336, 2: 1437})

Epoch :  49 loss training:  2.332480565208243 Time :  4015
accuracy train: 0.996364 val: 0.956364 test: 0.968493
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3918, 2: 2336, 0: 1437})

Epoch :  50 loss training:  2.0139703312597703 Time :  4100
accuracy train: 0.996364 val: 0.954545 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3918, 0: 2336, 2: 1437})

Epoch :  51 loss training:  2.1819745504762977 Time :  4169
accuracy train: 0.996566 val: 0.954545 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3918, 2: 2335, 0: 1438})

Epoch :  52 loss training:  1.8684956541401334 Time :  4235
accuracy train: 0.996768 val: 0.956364 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({2: 3918, 1: 2334, 0: 1439})

Epoch :  53 loss training:  2.4942303484422155 Time :  4302
accuracy train: 0.996364 val: 0.954545 test: 0.966667
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({2: 3919, 1: 2336, 0: 1436})

Epoch :  54 loss training:  2.191144636584795 Time :  4382
accuracy train: 0.996364 val: 0.954545 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3919, 0: 2333, 2: 1439})

Epoch :  55 loss training:  2.152341389504727 Time :  4470
accuracy train: 0.996566 val: 0.958182 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3920, 0: 2332, 2: 1439})

========================================================================================================================================================================================================
max acc epoch :  24
max validation accuracy :  0.9654545454545455
test accuracy :  0.9698630136986301
last test_accuracy :  0.9689497716894977
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.4, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=552, weight_decay=1e-07)
device :  cuda:0
Counter({2: 4230, 0: 2303, 1: 1158})

Epoch :  1 loss training:  45.55476069170982 Time :  4661
accuracy train: 0.963442 val: 0.932727 test: 0.952055
max validation accuracy : 0.932727 max acc epoch : 1 test accuracy : 0.952055
Counter({1: 3686, 0: 2430, 2: 1575})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.18739954289049 Time :  4745
accuracy train: 0.970107 val: 0.932727 test: 0.949315
max validation accuracy : 0.932727 max acc epoch : 1 test accuracy : 0.952055
Counter({2: 3764, 1: 2836, 0: 1091})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.249578084331006 Time :  4857
accuracy train: 0.976166 val: 0.945455 test: 0.957534
max validation accuracy : 0.945455 max acc epoch : 3 test accuracy : 0.957534
Counter({1: 3775, 0: 2466, 2: 1450})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.45222503412515 Time :  4949
accuracy train: 0.981418 val: 0.945455 test: 0.973516
max validation accuracy : 0.945455 max acc epoch : 3 test accuracy : 0.957534
Counter({2: 3782, 1: 2457, 0: 1452})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.937900809571147 Time :  5017
accuracy train: 0.980408 val: 0.947273 test: 0.964384
max validation accuracy : 0.947273 max acc epoch : 5 test accuracy : 0.964384
Counter({1: 3791, 2: 2451, 0: 1449})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.687935329275206 Time :  5096
accuracy train: 0.978792 val: 0.945455 test: 0.964840
max validation accuracy : 0.947273 max acc epoch : 5 test accuracy : 0.964384
Counter({1: 3804, 0: 2422, 2: 1465})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  9.403409345308319 Time :  5177
accuracy train: 0.987275 val: 0.949091 test: 0.970320
max validation accuracy : 0.949091 max acc epoch : 7 test accuracy : 0.970320
Counter({0: 3817, 1: 2412, 2: 1462})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  9.087775721680373 Time :  5266
accuracy train: 0.989295 val: 0.960000 test: 0.964384
max validation accuracy : 0.960000 max acc epoch : 8 test accuracy : 0.964384
Counter({1: 3822, 2: 2413, 0: 1456})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  8.299501183442771 Time :  5343
accuracy train: 0.988487 val: 0.958182 test: 0.968037
max validation accuracy : 0.960000 max acc epoch : 8 test accuracy : 0.964384
Counter({1: 3827, 0: 2411, 2: 1453})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  7.029610248282552 Time :  5422
accuracy train: 0.989901 val: 0.950909 test: 0.970776
max validation accuracy : 0.960000 max acc epoch : 8 test accuracy : 0.964384
Counter({1: 3828, 0: 2411, 2: 1452})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  6.32943013869226 Time :  5496
accuracy train: 0.991315 val: 0.958182 test: 0.969406
max validation accuracy : 0.960000 max acc epoch : 8 test accuracy : 0.964384
Counter({1: 3836, 0: 2404, 2: 1451})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  7.2085284953936934 Time :  5567
accuracy train: 0.991517 val: 0.958182 test: 0.968950
max validation accuracy : 0.960000 max acc epoch : 8 test accuracy : 0.964384
Counter({1: 3844, 2: 2400, 0: 1447})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  6.88492384320125 Time :  5654
accuracy train: 0.988487 val: 0.952727 test: 0.969406
max validation accuracy : 0.960000 max acc epoch : 8 test accuracy : 0.964384
Counter({2: 3850, 0: 2394, 1: 1447})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  5.877847662079148 Time :  5723
accuracy train: 0.989093 val: 0.956364 test: 0.969406
max validation accuracy : 0.960000 max acc epoch : 8 test accuracy : 0.964384
Counter({1: 3850, 0: 2394, 2: 1447})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  5.953629041207023 Time :  5789
accuracy train: 0.990507 val: 0.960000 test: 0.968950
max validation accuracy : 0.960000 max acc epoch : 8 test accuracy : 0.964384
Counter({1: 3858, 0: 2388, 2: 1445})

Epoch :  16 loss training:  5.6646486558020115 Time :  5870
accuracy train: 0.991921 val: 0.960000 test: 0.968493
max validation accuracy : 0.960000 max acc epoch : 8 test accuracy : 0.964384
Counter({1: 3858, 0: 2388, 2: 1445})

Epoch :  17 loss training:  5.587739136302844 Time :  5945
accuracy train: 0.990305 val: 0.958182 test: 0.968493
max validation accuracy : 0.960000 max acc epoch : 8 test accuracy : 0.964384
Counter({1: 3859, 0: 2385, 2: 1447})

Epoch :  18 loss training:  5.451774063054472 Time :  6024
accuracy train: 0.991921 val: 0.958182 test: 0.968493
max validation accuracy : 0.960000 max acc epoch : 8 test accuracy : 0.964384
Counter({1: 3861, 2: 2383, 0: 1447})

Epoch :  19 loss training:  5.6770860909018666 Time :  6095
accuracy train: 0.991517 val: 0.961818 test: 0.968493
max validation accuracy : 0.961818 max acc epoch : 19 test accuracy : 0.968493
Counter({0: 3862, 1: 2382, 2: 1447})

Epoch :  20 loss training:  5.168791797244921 Time :  6170
accuracy train: 0.992325 val: 0.960000 test: 0.970776
max validation accuracy : 0.961818 max acc epoch : 19 test accuracy : 0.968493
Counter({1: 3864, 0: 2380, 2: 1447})

Epoch :  21 loss training:  4.658321818918921 Time :  6243
accuracy train: 0.992527 val: 0.965455 test: 0.968493
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({0: 3872, 1: 2376, 2: 1443})

Epoch :  22 loss training:  4.474190353881568 Time :  6317
accuracy train: 0.991315 val: 0.958182 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3872, 0: 2377, 2: 1442})

Epoch :  23 loss training:  5.248925371095538 Time :  6400
accuracy train: 0.993739 val: 0.958182 test: 0.968493
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3874, 2: 2376, 0: 1441})

Epoch :  24 loss training:  4.493317058077082 Time :  6478
accuracy train: 0.993739 val: 0.965455 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3876, 0: 2377, 2: 1438})

Epoch :  25 loss training:  4.356967181083746 Time :  6550
accuracy train: 0.993739 val: 0.960000 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({2: 3876, 1: 2377, 0: 1438})

Epoch :  26 loss training:  4.1123199734138325 Time :  6623
accuracy train: 0.994143 val: 0.961818 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3877, 0: 2376, 2: 1438})

Epoch :  27 loss training:  4.390032497351058 Time :  6703
accuracy train: 0.995152 val: 0.958182 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3882, 0: 2371, 2: 1438})

Epoch :  28 loss training:  4.491218022885732 Time :  6787
accuracy train: 0.994345 val: 0.954545 test: 0.972603
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({0: 3886, 1: 2368, 2: 1437})

Epoch :  29 loss training:  3.9822952138492838 Time :  6853
accuracy train: 0.994547 val: 0.956364 test: 0.972603
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3889, 0: 2365, 2: 1437})

Epoch :  30 loss training:  3.913234025007114 Time :  6915
accuracy train: 0.994345 val: 0.958182 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3889, 0: 2364, 2: 1438})

Epoch :  31 loss training:  3.7997091907891445 Time :  6983
accuracy train: 0.994547 val: 0.956364 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3890, 0: 2363, 2: 1438})

Epoch :  32 loss training:  3.4633890483528376 Time :  7053
accuracy train: 0.995354 val: 0.963636 test: 0.968037
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3896, 0: 2357, 2: 1438})

Epoch :  33 loss training:  3.2511463774135336 Time :  7121
accuracy train: 0.994951 val: 0.960000 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3898, 0: 2356, 2: 1437})

Epoch :  34 loss training:  4.43866634281585 Time :  7195
accuracy train: 0.995354 val: 0.965455 test: 0.968037
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3902, 0: 2350, 2: 1439})

Epoch :  35 loss training:  3.551596214994788 Time :  7271
accuracy train: 0.995354 val: 0.958182 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({0: 3903, 1: 2347, 2: 1441})

Epoch :  36 loss training:  3.1326169432140887 Time :  7345
accuracy train: 0.995556 val: 0.960000 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3903, 0: 2346, 2: 1442})

Epoch :  37 loss training:  3.155082141282037 Time :  7420
accuracy train: 0.995354 val: 0.960000 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3906, 0: 2344, 2: 1441})

Epoch :  38 loss training:  3.005022839468438 Time :  7490
accuracy train: 0.995556 val: 0.961818 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3907, 0: 2342, 2: 1442})

Epoch :  39 loss training:  2.81707092031138 Time :  7570
accuracy train: 0.994547 val: 0.956364 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3907, 2: 2339, 0: 1445})

Epoch :  40 loss training:  2.9383329870179296 Time :  7643
accuracy train: 0.995556 val: 0.954545 test: 0.972603
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({2: 3907, 0: 2335, 1: 1449})

Epoch :  41 loss training:  3.1449696319759823 Time :  7722
accuracy train: 0.995152 val: 0.958182 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3908, 0: 2334, 2: 1449})

Epoch :  42 loss training:  2.4509404255077243 Time :  7796
accuracy train: 0.995960 val: 0.956364 test: 0.968493
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3908, 0: 2334, 2: 1449})

Epoch :  43 loss training:  2.6960109119536355 Time :  7881
accuracy train: 0.995960 val: 0.956364 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3908, 2: 2334, 0: 1449})

Epoch :  44 loss training:  2.6876719852152746 Time :  7959
accuracy train: 0.995556 val: 0.956364 test: 0.972603
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3908, 0: 2334, 2: 1449})

Epoch :  45 loss training:  2.7408410268253647 Time :  8029
accuracy train: 0.995758 val: 0.954545 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3908, 0: 2325, 2: 1458})

Epoch :  46 loss training:  2.5457486688392237 Time :  8105
accuracy train: 0.995758 val: 0.954545 test: 0.968493
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3908, 0: 2325, 2: 1458})

Epoch :  47 loss training:  2.5399068339029327 Time :  8174
accuracy train: 0.996162 val: 0.954545 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3908, 0: 2326, 2: 1457})

Epoch :  48 loss training:  2.6611544591141865 Time :  8245
accuracy train: 0.995960 val: 0.954545 test: 0.969406
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3909, 0: 2325, 2: 1457})

Epoch :  49 loss training:  2.4118292622151785 Time :  8324
accuracy train: 0.996566 val: 0.952727 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3908, 0: 2327, 2: 1456})

Epoch :  50 loss training:  2.06471983139636 Time :  8395
accuracy train: 0.996364 val: 0.958182 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3908, 0: 2327, 2: 1456})

Epoch :  51 loss training:  2.148741816286929 Time :  8466
accuracy train: 0.996364 val: 0.954545 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3908, 2: 2327, 0: 1456})

Epoch :  52 loss training:  1.889463349187281 Time :  8536
accuracy train: 0.995960 val: 0.956364 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 21 test accuracy : 0.968493
Counter({1: 3908, 0: 2325, 2: 1458})

========================================================================================================================================================================================================
max acc epoch :  21
max validation accuracy :  0.9654545454545455
test accuracy :  0.9684931506849315
last test_accuracy :  0.9712328767123287
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.4, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=552, weight_decay=1e-07)
device :  cuda:0
Counter({2: 4230, 0: 2303, 1: 1158})

Epoch :  1 loss training:  45.56815877370536 Time :  8743
accuracy train: 0.962028 val: 0.936364 test: 0.951598
max validation accuracy : 0.936364 max acc epoch : 1 test accuracy : 0.951598
Counter({1: 3669, 0: 2435, 2: 1587})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.33087487705052 Time :  8821
accuracy train: 0.970107 val: 0.940000 test: 0.948402
max validation accuracy : 0.940000 max acc epoch : 2 test accuracy : 0.948402
Counter({1: 3755, 2: 2855, 0: 1081})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.576830920763314 Time :  8906
accuracy train: 0.972329 val: 0.940000 test: 0.950228
max validation accuracy : 0.940000 max acc epoch : 2 test accuracy : 0.948402
Counter({2: 3757, 0: 2469, 1: 1465})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.4859042505268 Time :  9004
accuracy train: 0.980004 val: 0.950909 test: 0.972146
max validation accuracy : 0.950909 max acc epoch : 4 test accuracy : 0.972146
Counter({0: 3755, 1: 2451, 2: 1485})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.805530447978526 Time :  9086
accuracy train: 0.982024 val: 0.956364 test: 0.966667
max validation accuracy : 0.956364 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3801, 0: 2434, 2: 1456})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.6655849062372 Time :  9164
accuracy train: 0.979802 val: 0.945455 test: 0.967580
max validation accuracy : 0.956364 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3806, 0: 2425, 2: 1460})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  9.20793753140606 Time :  9237
accuracy train: 0.986669 val: 0.949091 test: 0.966667
max validation accuracy : 0.956364 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3814, 0: 2417, 2: 1460})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  9.019583868794143 Time :  9307
accuracy train: 0.988285 val: 0.952727 test: 0.964384
max validation accuracy : 0.956364 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3820, 0: 2415, 2: 1456})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  8.110975729068741 Time :  9388
accuracy train: 0.988891 val: 0.947273 test: 0.968493
max validation accuracy : 0.956364 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3825, 2: 2411, 0: 1455})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.973392756655812 Time :  9469
accuracy train: 0.990507 val: 0.952727 test: 0.969863
max validation accuracy : 0.956364 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3831, 0: 2409, 2: 1451})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  6.12386826146394 Time :  9538
accuracy train: 0.992325 val: 0.952727 test: 0.969863
max validation accuracy : 0.956364 max acc epoch : 5 test accuracy : 0.966667
Counter({1: 3841, 2: 2405, 0: 1445})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  7.087715312605724 Time :  9610
accuracy train: 0.991921 val: 0.958182 test: 0.968950
max validation accuracy : 0.958182 max acc epoch : 12 test accuracy : 0.968950
Counter({2: 3847, 1: 2403, 0: 1441})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  6.690908437594771 Time :  9680
accuracy train: 0.988285 val: 0.949091 test: 0.968950
max validation accuracy : 0.958182 max acc epoch : 12 test accuracy : 0.968950
Counter({1: 3850, 0: 2400, 2: 1441})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  5.8914766614325345 Time :  9755
accuracy train: 0.989901 val: 0.950909 test: 0.968493
max validation accuracy : 0.958182 max acc epoch : 12 test accuracy : 0.968950
Counter({1: 3850, 0: 2400, 2: 1441})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  5.787074516876601 Time :  9826
accuracy train: 0.991517 val: 0.954545 test: 0.970320
max validation accuracy : 0.958182 max acc epoch : 12 test accuracy : 0.968950
Counter({1: 3856, 0: 2394, 2: 1441})

Epoch :  16 loss training:  5.773911794065498 Time :  9894
accuracy train: 0.992527 val: 0.952727 test: 0.970776
max validation accuracy : 0.958182 max acc epoch : 12 test accuracy : 0.968950
Counter({1: 3861, 0: 2389, 2: 1441})

Epoch :  17 loss training:  5.617201833520085 Time :  9980
accuracy train: 0.991719 val: 0.954545 test: 0.969406
max validation accuracy : 0.958182 max acc epoch : 12 test accuracy : 0.968950
Counter({2: 3865, 0: 2385, 1: 1441})

Epoch :  18 loss training:  5.384886246989481 Time :  10056
accuracy train: 0.991719 val: 0.952727 test: 0.969863
max validation accuracy : 0.958182 max acc epoch : 12 test accuracy : 0.968950
Counter({1: 3867, 0: 2383, 2: 1441})

Epoch :  19 loss training:  5.781153172487393 Time :  10141
accuracy train: 0.992325 val: 0.956364 test: 0.971233
max validation accuracy : 0.958182 max acc epoch : 12 test accuracy : 0.968950
Counter({2: 3869, 1: 2381, 0: 1441})

Epoch :  20 loss training:  5.413770500919782 Time :  10215
accuracy train: 0.992729 val: 0.956364 test: 0.970320
max validation accuracy : 0.958182 max acc epoch : 12 test accuracy : 0.968950
Counter({1: 3874, 0: 2376, 2: 1441})

Epoch :  21 loss training:  4.783298854366876 Time :  10294
accuracy train: 0.992931 val: 0.960000 test: 0.971233
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.971233
Counter({1: 3877, 0: 2373, 2: 1441})

Epoch :  22 loss training:  4.424864067230374 Time :  10392
accuracy train: 0.992123 val: 0.952727 test: 0.972146
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.971233
Counter({1: 3877, 0: 2373, 2: 1441})

Epoch :  23 loss training:  4.931276084273122 Time :  10486
accuracy train: 0.993537 val: 0.956364 test: 0.970320
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.971233
Counter({1: 3879, 0: 2372, 2: 1440})

Epoch :  24 loss training:  4.550281742820516 Time :  10583
accuracy train: 0.993739 val: 0.960000 test: 0.972146
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.971233
Counter({1: 3883, 0: 2368, 2: 1440})

Epoch :  25 loss training:  4.130916203605011 Time :  10674
accuracy train: 0.992931 val: 0.952727 test: 0.971689
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.971233
Counter({1: 3884, 0: 2368, 2: 1439})

Epoch :  26 loss training:  4.020360715338029 Time :  10759
accuracy train: 0.995152 val: 0.958182 test: 0.972603
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.971233
Counter({1: 3885, 0: 2369, 2: 1437})

Epoch :  27 loss training:  4.232257335155737 Time :  10854
accuracy train: 0.995354 val: 0.956364 test: 0.972146
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.971233
Counter({1: 3887, 0: 2367, 2: 1437})

Epoch :  28 loss training:  4.385137308505364 Time :  10956
accuracy train: 0.995354 val: 0.952727 test: 0.970776
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.971233
Counter({1: 3893, 2: 2360, 0: 1438})

Epoch :  29 loss training:  3.7597926182788797 Time :  11066
accuracy train: 0.995354 val: 0.950909 test: 0.972603
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.971233
Counter({1: 3895, 0: 2358, 2: 1438})

Epoch :  30 loss training:  3.7729940488934517 Time :  11151
accuracy train: 0.995354 val: 0.954545 test: 0.971233
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.971233
Counter({1: 3897, 0: 2354, 2: 1440})

Epoch :  31 loss training:  3.621427102945745 Time :  11247
accuracy train: 0.994345 val: 0.954545 test: 0.969406
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.971233
Counter({1: 3897, 2: 2353, 0: 1441})

Epoch :  32 loss training:  3.3771490016952157 Time :  11347
accuracy train: 0.994951 val: 0.960000 test: 0.972146
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.971233
Counter({1: 3902, 0: 2347, 2: 1442})

Epoch :  33 loss training:  3.1748275924474 Time :  11454
accuracy train: 0.994951 val: 0.956364 test: 0.971233
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.971233
Counter({1: 3905, 0: 2343, 2: 1443})

Epoch :  34 loss training:  4.499102936824784 Time :  11538
accuracy train: 0.995152 val: 0.960000 test: 0.970320
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.971233
Counter({0: 3906, 1: 2342, 2: 1443})

Epoch :  35 loss training:  3.550495677976869 Time :  11622
accuracy train: 0.995152 val: 0.952727 test: 0.970320
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.971233
Counter({1: 3906, 0: 2335, 2: 1450})

Epoch :  36 loss training:  3.118259410315659 Time :  11709
accuracy train: 0.995354 val: 0.949091 test: 0.967580
max validation accuracy : 0.960000 max acc epoch : 21 test accuracy : 0.971233
Counter({0: 3906, 1: 2335, 2: 1450})

Epoch :  37 loss training:  3.2339682969031855 Time :  11807
accuracy train: 0.995556 val: 0.961818 test: 0.970776
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3909, 2: 2332, 0: 1450})

Epoch :  38 loss training:  2.992505971866194 Time :  11922
accuracy train: 0.995960 val: 0.960000 test: 0.968950
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3909, 2: 2333, 0: 1449})

Epoch :  39 loss training:  2.8806699539418332 Time :  12030
accuracy train: 0.994547 val: 0.954545 test: 0.969863
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({0: 3909, 1: 2332, 2: 1450})

Epoch :  40 loss training:  2.768848758249078 Time :  12115
accuracy train: 0.995960 val: 0.952727 test: 0.970776
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3910, 0: 2332, 2: 1449})

Epoch :  41 loss training:  3.1409553606936242 Time :  12203
accuracy train: 0.995960 val: 0.954545 test: 0.970776
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3911, 0: 2329, 2: 1451})

Epoch :  42 loss training:  2.5049256395432167 Time :  12298
accuracy train: 0.995758 val: 0.952727 test: 0.970320
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3911, 2: 2330, 0: 1450})

Epoch :  43 loss training:  2.6971443571383134 Time :  12374
accuracy train: 0.995758 val: 0.950909 test: 0.969863
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3911, 0: 2330, 2: 1450})

Epoch :  44 loss training:  2.6582001914212015 Time :  12469
accuracy train: 0.995960 val: 0.954545 test: 0.969406
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3911, 2: 2329, 0: 1451})

Epoch :  45 loss training:  2.5472090939292684 Time :  12555
accuracy train: 0.995960 val: 0.954545 test: 0.968950
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3912, 2: 2329, 0: 1450})

Epoch :  46 loss training:  2.433416908432264 Time :  12635
accuracy train: 0.995960 val: 0.952727 test: 0.968037
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3912, 0: 2329, 2: 1450})

Epoch :  47 loss training:  2.6752421687124297 Time :  12714
accuracy train: 0.995556 val: 0.952727 test: 0.968037
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3912, 2: 2329, 0: 1450})

Epoch :  48 loss training:  2.7777568476158194 Time :  12799
accuracy train: 0.996364 val: 0.950909 test: 0.970776
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3914, 2: 2328, 0: 1449})

Epoch :  49 loss training:  2.5335065333056264 Time :  12876
accuracy train: 0.996566 val: 0.954545 test: 0.968493
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3914, 0: 2327, 2: 1450})

Epoch :  50 loss training:  2.0105756370467134 Time :  12978
accuracy train: 0.996566 val: 0.954545 test: 0.970320
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3914, 2: 2327, 0: 1450})

Epoch :  51 loss training:  2.3183847178152064 Time :  13056
accuracy train: 0.996566 val: 0.952727 test: 0.970776
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({0: 3914, 1: 2327, 2: 1450})

Epoch :  52 loss training:  1.929188807727769 Time :  13131
accuracy train: 0.996162 val: 0.954545 test: 0.971233
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3913, 0: 2328, 2: 1450})

Epoch :  53 loss training:  2.557376612268854 Time :  13215
accuracy train: 0.996162 val: 0.952727 test: 0.967123
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3913, 0: 2328, 2: 1450})

Epoch :  54 loss training:  2.2258866810589097 Time :  13295
accuracy train: 0.996768 val: 0.950909 test: 0.969406
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({0: 3913, 1: 2325, 2: 1453})

Epoch :  55 loss training:  2.107923914998537 Time :  13404
accuracy train: 0.996768 val: 0.956364 test: 0.969406
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({0: 3914, 1: 2323, 2: 1454})

Epoch :  56 loss training:  2.1680267627816647 Time :  13490
accuracy train: 0.996566 val: 0.954545 test: 0.968493
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3913, 0: 2324, 2: 1454})

Epoch :  57 loss training:  1.933006218954688 Time :  13587
accuracy train: 0.996768 val: 0.952727 test: 0.968950
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3913, 0: 2324, 2: 1454})

Epoch :  58 loss training:  1.9251070172467735 Time :  13671
accuracy train: 0.996768 val: 0.949091 test: 0.968950
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3913, 0: 2324, 2: 1454})

Epoch :  59 loss training:  2.2145435156999156 Time :  13760
accuracy train: 0.996566 val: 0.952727 test: 0.968950
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3913, 0: 2323, 2: 1455})

Epoch :  60 loss training:  1.5941001723404042 Time :  13843
accuracy train: 0.996364 val: 0.952727 test: 0.968493
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3913, 0: 2323, 2: 1455})

Epoch :  61 loss training:  1.9158280634583207 Time :  13939
accuracy train: 0.996970 val: 0.949091 test: 0.968950
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3913, 0: 2323, 2: 1455})

Epoch :  62 loss training:  1.7393147252150811 Time :  14038
accuracy train: 0.996768 val: 0.952727 test: 0.968037
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3912, 0: 2324, 2: 1455})

Epoch :  63 loss training:  1.8900025557231857 Time :  14133
accuracy train: 0.996768 val: 0.949091 test: 0.967580
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3912, 0: 2323, 2: 1456})

Epoch :  64 loss training:  1.9113047403370729 Time :  14216
accuracy train: 0.996768 val: 0.943636 test: 0.970320
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3913, 0: 2323, 2: 1455})

Epoch :  65 loss training:  1.9403975340974284 Time :  14314
accuracy train: 0.997172 val: 0.950909 test: 0.968950
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({0: 3913, 1: 2324, 2: 1454})

Epoch :  66 loss training:  1.6917528224294074 Time :  14406
accuracy train: 0.997172 val: 0.947273 test: 0.967123
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3913, 0: 2324, 2: 1454})

Epoch :  67 loss training:  1.6423455713593285 Time :  14497
accuracy train: 0.996970 val: 0.950909 test: 0.969863
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3910, 0: 2321, 2: 1460})

Epoch :  68 loss training:  1.7498445743567572 Time :  14596
accuracy train: 0.996768 val: 0.949091 test: 0.969863
max validation accuracy : 0.961818 max acc epoch : 37 test accuracy : 0.970776
Counter({1: 3911, 0: 2320, 2: 1460})

========================================================================================================================================================================================================
max acc epoch :  37
max validation accuracy :  0.9618181818181818
test accuracy :  0.9707762557077626
last test_accuracy :  0.9698630136986301
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.4, early_stop=30, epochs=400, filename='', hidden_dim=200, lda=False, lr=0.001, num_Exp=4, num_clusters=3, num_layers=3, num_mlp_layers=1, random_vec=False, seed=552, weight_decay=1e-07)
device :  cuda:0
Counter({2: 4230, 0: 2303, 1: 1158})

Epoch :  1 loss training:  45.58147898875177 Time :  14825
accuracy train: 0.962432 val: 0.936364 test: 0.951598
max validation accuracy : 0.936364 max acc epoch : 1 test accuracy : 0.951598
Counter({1: 3675, 0: 2442, 2: 1574})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.275258260779083 Time :  14928
accuracy train: 0.971521 val: 0.941818 test: 0.949315
max validation accuracy : 0.941818 max acc epoch : 2 test accuracy : 0.949315
Counter({2: 3758, 1: 2848, 0: 1085})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.433245273306966 Time :  15022
accuracy train: 0.973743 val: 0.950909 test: 0.954338
max validation accuracy : 0.950909 max acc epoch : 3 test accuracy : 0.954338
Counter({1: 3764, 2: 2533, 0: 1394})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.575321227079257 Time :  15119
accuracy train: 0.980408 val: 0.947273 test: 0.972603
max validation accuracy : 0.950909 max acc epoch : 3 test accuracy : 0.954338
Counter({1: 3762, 0: 2480, 2: 1449})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  11.331411364022642 Time :  15206
accuracy train: 0.981418 val: 0.950909 test: 0.961187
max validation accuracy : 0.950909 max acc epoch : 3 test accuracy : 0.954338
Counter({2: 3784, 1: 2447, 0: 1460})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.587249566800892 Time :  15296
accuracy train: 0.982428 val: 0.949091 test: 0.968950
max validation accuracy : 0.950909 max acc epoch : 3 test accuracy : 0.954338
Counter({1: 3794, 0: 2429, 2: 1468})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  9.416669754777104 Time :  15379
accuracy train: 0.986669 val: 0.947273 test: 0.967123
max validation accuracy : 0.950909 max acc epoch : 3 test accuracy : 0.954338
Counter({1: 3803, 2: 2429, 0: 1459})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  9.230999923078343 Time :  15471
accuracy train: 0.989699 val: 0.954545 test: 0.963470
max validation accuracy : 0.954545 max acc epoch : 8 test accuracy : 0.963470
Counter({1: 3811, 0: 2419, 2: 1461})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  8.2897717023734 Time :  15566
accuracy train: 0.989093 val: 0.956364 test: 0.967580
max validation accuracy : 0.956364 max acc epoch : 9 test accuracy : 0.967580
Counter({1: 3820, 0: 2413, 2: 1458})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.940408465219662 Time :  15663
accuracy train: 0.990507 val: 0.954545 test: 0.968950
max validation accuracy : 0.956364 max acc epoch : 9 test accuracy : 0.967580
Counter({1: 3821, 0: 2412, 2: 1458})
Epoch-10 lr: 0.000125

Epoch :  11 loss training:  6.163762742653489 Time :  15755
accuracy train: 0.991315 val: 0.956364 test: 0.968493
max validation accuracy : 0.956364 max acc epoch : 9 test accuracy : 0.967580
Counter({1: 3827, 2: 2410, 0: 1454})
Epoch-11 lr: 0.000125

Epoch :  12 loss training:  7.193156523280777 Time :  15856
accuracy train: 0.990305 val: 0.956364 test: 0.965753
max validation accuracy : 0.956364 max acc epoch : 9 test accuracy : 0.967580
Counter({1: 3831, 2: 2404, 0: 1456})
Epoch-12 lr: 6.25e-05

Epoch :  13 loss training:  6.80401283595711 Time :  15967
accuracy train: 0.989093 val: 0.952727 test: 0.967123
max validation accuracy : 0.956364 max acc epoch : 9 test accuracy : 0.967580
Counter({1: 3835, 2: 2398, 0: 1458})
Epoch-13 lr: 6.25e-05

Epoch :  14 loss training:  5.851929852971807 Time :  16049
accuracy train: 0.989901 val: 0.952727 test: 0.968037
max validation accuracy : 0.956364 max acc epoch : 9 test accuracy : 0.967580
Counter({1: 3843, 0: 2389, 2: 1459})
Epoch-14 lr: 6.25e-05

Epoch :  15 loss training:  5.8720347644994035 Time :  16161
accuracy train: 0.990911 val: 0.958182 test: 0.966667
max validation accuracy : 0.958182 max acc epoch : 15 test accuracy : 0.966667
Counter({1: 3847, 0: 2388, 2: 1456})

Epoch :  16 loss training:  5.722518612979911 Time :  16245
accuracy train: 0.992123 val: 0.956364 test: 0.968493
max validation accuracy : 0.958182 max acc epoch : 15 test accuracy : 0.966667
Counter({1: 3848, 0: 2386, 2: 1457})

Epoch :  17 loss training:  5.644989296095446 Time :  16352
accuracy train: 0.990911 val: 0.954545 test: 0.969406
max validation accuracy : 0.958182 max acc epoch : 15 test accuracy : 0.966667
Counter({1: 3848, 0: 2384, 2: 1459})

Epoch :  18 loss training:  5.479596866876818 Time :  16438
accuracy train: 0.991921 val: 0.960000 test: 0.966210
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.966210
Counter({1: 3851, 2: 2382, 0: 1458})

Epoch :  19 loss training:  5.455727995373309 Time :  16534
accuracy train: 0.992123 val: 0.954545 test: 0.968950
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.966210
Counter({1: 3859, 2: 2374, 0: 1458})

Epoch :  20 loss training:  5.30389784113504 Time :  16639
accuracy train: 0.992931 val: 0.958182 test: 0.969863
max validation accuracy : 0.960000 max acc epoch : 18 test accuracy : 0.966210
Counter({1: 3863, 0: 2370, 2: 1458})

Epoch :  21 loss training:  4.748591125709936 Time :  16740
accuracy train: 0.993335 val: 0.961818 test: 0.971233
max validation accuracy : 0.961818 max acc epoch : 21 test accuracy : 0.971233
Counter({1: 3865, 0: 2368, 2: 1458})

Epoch :  22 loss training:  4.338554490823299 Time :  16848
accuracy train: 0.991921 val: 0.961818 test: 0.969863
max validation accuracy : 0.961818 max acc epoch : 21 test accuracy : 0.971233
Counter({1: 3866, 0: 2367, 2: 1458})

Epoch :  23 loss training:  5.17758350726217 Time :  16944
accuracy train: 0.993537 val: 0.961818 test: 0.969406
max validation accuracy : 0.961818 max acc epoch : 21 test accuracy : 0.971233
Counter({0: 3870, 2: 2365, 1: 1456})

Epoch :  24 loss training:  4.60710202564951 Time :  17044
accuracy train: 0.993739 val: 0.965455 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3876, 0: 2364, 2: 1451})

Epoch :  25 loss training:  4.159710321109742 Time :  17133
accuracy train: 0.993537 val: 0.958182 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3877, 0: 2363, 2: 1451})

Epoch :  26 loss training:  4.039081690483727 Time :  17222
accuracy train: 0.995152 val: 0.954545 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3878, 0: 2362, 2: 1451})

Epoch :  27 loss training:  4.206732144288253 Time :  17305
accuracy train: 0.995354 val: 0.960000 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3878, 0: 2361, 2: 1452})

Epoch :  28 loss training:  4.405547420261428 Time :  17393
accuracy train: 0.994951 val: 0.954545 test: 0.973973
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3883, 0: 2358, 2: 1450})

Epoch :  29 loss training:  3.8742069035652094 Time :  17472
accuracy train: 0.995152 val: 0.952727 test: 0.972603
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3884, 0: 2357, 2: 1450})

Epoch :  30 loss training:  4.123608434281778 Time :  17549
accuracy train: 0.994951 val: 0.961818 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3886, 0: 2355, 2: 1450})

Epoch :  31 loss training:  3.714930410904344 Time :  17634
accuracy train: 0.994143 val: 0.954545 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3887, 0: 2354, 2: 1450})

Epoch :  32 loss training:  3.317175022093579 Time :  17723
accuracy train: 0.995354 val: 0.963636 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3895, 0: 2344, 2: 1452})

Epoch :  33 loss training:  3.2372985711554065 Time :  17809
accuracy train: 0.994951 val: 0.963636 test: 0.972146
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3896, 0: 2344, 2: 1451})

Epoch :  34 loss training:  4.432319340470713 Time :  17895
accuracy train: 0.995152 val: 0.961818 test: 0.968037
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3902, 0: 2337, 2: 1452})

Epoch :  35 loss training:  3.4582838234491646 Time :  17985
accuracy train: 0.994547 val: 0.956364 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3902, 0: 2330, 2: 1459})

Epoch :  36 loss training:  3.117140674847178 Time :  18074
accuracy train: 0.994749 val: 0.956364 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3902, 0: 2331, 2: 1458})

Epoch :  37 loss training:  3.2051833790028468 Time :  18163
accuracy train: 0.995152 val: 0.958182 test: 0.973059
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({0: 3902, 1: 2330, 2: 1459})

Epoch :  38 loss training:  3.1527942892862484 Time :  18250
accuracy train: 0.996162 val: 0.958182 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3902, 2: 2330, 0: 1459})

Epoch :  39 loss training:  2.8459006818011403 Time :  18336
accuracy train: 0.994345 val: 0.954545 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3902, 0: 2330, 2: 1459})

Epoch :  40 loss training:  2.793746578565333 Time :  18430
accuracy train: 0.995758 val: 0.958182 test: 0.972146
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3903, 2: 2329, 0: 1459})

Epoch :  41 loss training:  2.9693027270841412 Time :  18515
accuracy train: 0.996162 val: 0.965455 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3904, 0: 2327, 2: 1460})

Epoch :  42 loss training:  2.3578850920312107 Time :  18601
accuracy train: 0.994749 val: 0.956364 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3904, 0: 2327, 2: 1460})

Epoch :  43 loss training:  2.650861360831186 Time :  18694
accuracy train: 0.995960 val: 0.952727 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3903, 0: 2328, 2: 1460})

Epoch :  44 loss training:  2.6073778085701633 Time :  18783
accuracy train: 0.995960 val: 0.954545 test: 0.971689
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3903, 0: 2327, 2: 1461})

Epoch :  45 loss training:  2.6881225606193766 Time :  18877
accuracy train: 0.995556 val: 0.958182 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3904, 0: 2326, 2: 1461})

Epoch :  46 loss training:  2.557772161846515 Time :  18958
accuracy train: 0.995556 val: 0.956364 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3904, 2: 2327, 0: 1460})

Epoch :  47 loss training:  2.507093138381606 Time :  19038
accuracy train: 0.995354 val: 0.954545 test: 0.968950
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3903, 0: 2328, 2: 1460})

Epoch :  48 loss training:  2.7485427852661815 Time :  19127
accuracy train: 0.996162 val: 0.956364 test: 0.973059
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3904, 0: 2328, 2: 1459})

Epoch :  49 loss training:  2.612862201523967 Time :  19201
accuracy train: 0.996566 val: 0.958182 test: 0.969863
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3904, 2: 2327, 0: 1460})

Epoch :  50 loss training:  2.1376364671741612 Time :  19288
accuracy train: 0.996768 val: 0.958182 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3904, 0: 2327, 2: 1460})

Epoch :  51 loss training:  2.075559696997516 Time :  19371
accuracy train: 0.996364 val: 0.958182 test: 0.971233
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3905, 0: 2325, 2: 1461})

Epoch :  52 loss training:  1.8400735037284903 Time :  19463
accuracy train: 0.996566 val: 0.954545 test: 0.973516
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3905, 2: 2325, 0: 1461})

Epoch :  53 loss training:  2.58041936691734 Time :  19541
accuracy train: 0.996162 val: 0.956364 test: 0.968037
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3905, 2: 2325, 0: 1461})

Epoch :  54 loss training:  2.1914862676203484 Time :  19628
accuracy train: 0.996364 val: 0.954545 test: 0.970776
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3905, 0: 2324, 2: 1462})

Epoch :  55 loss training:  2.1875427826598752 Time :  19725
accuracy train: 0.996364 val: 0.956364 test: 0.970320
max validation accuracy : 0.965455 max acc epoch : 24 test accuracy : 0.969863
Counter({1: 3907, 2: 2314, 0: 1470})

========================================================================================================================================================================================================
max acc epoch :  24
max validation accuracy :  0.9654545454545455
test accuracy :  0.9698630136986301
last test_accuracy :  0.9703196347031964
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 val_accuracy : 0.96545 	 test_accuracy : 0.96986 	 max_acc epoch :  24 	 last test_accuracy : 0.96895
k :  1 	 val_accuracy : 0.96545 	 test_accuracy : 0.96849 	 max_acc epoch :  21 	 last test_accuracy : 0.97123
k :  2 	 val_accuracy : 0.96182 	 test_accuracy : 0.97078 	 max_acc epoch :  37 	 last test_accuracy : 0.96986
k :  3 	 val_accuracy : 0.96545 	 test_accuracy : 0.96986 	 max_acc epoch :  24 	 last test_accuracy : 0.97032

avg :  	 val_accuracy : 0.96455 	 test_accuracy : 0.96975 	 last_accuracy : 0.97009
