

date and time :  Mon Jun 14 16:11:43 2021
itr : 0
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=114, tsne=False, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  42.51280737295747 Time :  129
accuracy train: 0.962634 val: 0.961818 test: 0.955708
max validation accuracy : 0.961818 max acc epoch : 1 test accuracy : 0.955708
Counter({0: 4064, 1: 3627})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.4275643825531 Time :  170
accuracy train: 0.973137 val: 0.970909 test: 0.953425
max validation accuracy : 0.970909 max acc epoch : 2 test accuracy : 0.953425
Counter({1: 4002, 0: 3689})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  16.214701927267015 Time :  207
accuracy train: 0.970915 val: 0.965455 test: 0.953881
max validation accuracy : 0.970909 max acc epoch : 2 test accuracy : 0.953425
Counter({1: 3920, 0: 3771})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.200462384615093 Time :  244
accuracy train: 0.980610 val: 0.965455 test: 0.965297
max validation accuracy : 0.970909 max acc epoch : 2 test accuracy : 0.953425
Counter({0: 3930, 1: 3761})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.540592660196126 Time :  277
accuracy train: 0.982630 val: 0.978182 test: 0.970320
max validation accuracy : 0.978182 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3912, 1: 3779})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.239210554398596 Time :  320
accuracy train: 0.980206 val: 0.969091 test: 0.971233
max validation accuracy : 0.978182 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3918, 0: 3773})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.479837743099779 Time :  354
accuracy train: 0.983438 val: 0.970909 test: 0.967580
max validation accuracy : 0.978182 max acc epoch : 5 test accuracy : 0.970320
Counter({0: 3892, 1: 3799})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.223172076977789 Time :  393
accuracy train: 0.988891 val: 0.978182 test: 0.968950
max validation accuracy : 0.978182 max acc epoch : 5 test accuracy : 0.970320
Counter({1: 3888, 0: 3803})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.935137967811897 Time :  425
accuracy train: 0.990305 val: 0.980000 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.970776
Counter({1: 3877, 0: 3814})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.032240386819467 Time :  460
accuracy train: 0.991719 val: 0.978182 test: 0.972146
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.970776
Counter({0: 3875, 1: 3816})

Epoch :  11 loss training:  5.650908703217283 Time :  498
accuracy train: 0.991921 val: 0.980000 test: 0.968493
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.970776
Counter({1: 3866, 0: 3825})

Epoch :  12 loss training:  5.173289538943209 Time :  535
accuracy train: 0.992123 val: 0.983636 test: 0.972603
max validation accuracy : 0.983636 max acc epoch : 12 test accuracy : 0.972603
Counter({1: 3855, 0: 3836})

Epoch :  13 loss training:  4.921013104147278 Time :  572
accuracy train: 0.993537 val: 0.983636 test: 0.974429
max validation accuracy : 0.983636 max acc epoch : 12 test accuracy : 0.972603
Counter({0: 3855, 1: 3836})

Epoch :  14 loss training:  4.892367557855323 Time :  606
accuracy train: 0.992931 val: 0.981818 test: 0.973059
max validation accuracy : 0.983636 max acc epoch : 12 test accuracy : 0.972603
Counter({1: 3851, 0: 3840})

Epoch :  15 loss training:  4.585647774161771 Time :  642
accuracy train: 0.992931 val: 0.976364 test: 0.976256
max validation accuracy : 0.983636 max acc epoch : 12 test accuracy : 0.972603
Counter({1: 3861, 0: 3830})

Epoch :  16 loss training:  4.278526124777272 Time :  680
accuracy train: 0.993941 val: 0.981818 test: 0.973516
max validation accuracy : 0.983636 max acc epoch : 12 test accuracy : 0.972603
Counter({1: 3855, 0: 3836})

Epoch :  17 loss training:  4.224306344054639 Time :  719
accuracy train: 0.994547 val: 0.985455 test: 0.973516
max validation accuracy : 0.985455 max acc epoch : 17 test accuracy : 0.973516
Counter({0: 3864, 1: 3827})

Epoch :  18 loss training:  4.043061935924925 Time :  762
accuracy train: 0.994547 val: 0.983636 test: 0.975799
max validation accuracy : 0.985455 max acc epoch : 17 test accuracy : 0.973516
Counter({1: 3869, 0: 3822})

Epoch :  19 loss training:  3.454733212129213 Time :  801
accuracy train: 0.994345 val: 0.978182 test: 0.975799
max validation accuracy : 0.985455 max acc epoch : 17 test accuracy : 0.973516
Counter({0: 3866, 1: 3825})

Epoch :  20 loss training:  3.7117329142056406 Time :  845
accuracy train: 0.994951 val: 0.978182 test: 0.972146
max validation accuracy : 0.985455 max acc epoch : 17 test accuracy : 0.973516
Counter({1: 3866, 0: 3825})

Epoch :  21 loss training:  3.0302930835750885 Time :  882
accuracy train: 0.995354 val: 0.978182 test: 0.971689
max validation accuracy : 0.985455 max acc epoch : 17 test accuracy : 0.973516
Counter({0: 3874, 1: 3817})

Epoch :  22 loss training:  3.057694165443536 Time :  920
accuracy train: 0.995960 val: 0.980000 test: 0.970776
max validation accuracy : 0.985455 max acc epoch : 17 test accuracy : 0.973516
Counter({1: 3883, 0: 3808})

Epoch :  23 loss training:  3.1292991418158635 Time :  953
accuracy train: 0.995758 val: 0.978182 test: 0.972603
max validation accuracy : 0.985455 max acc epoch : 17 test accuracy : 0.973516
Counter({1: 3879, 0: 3812})

Epoch :  24 loss training:  2.411746300989762 Time :  991
accuracy train: 0.995556 val: 0.980000 test: 0.974429
max validation accuracy : 0.985455 max acc epoch : 17 test accuracy : 0.973516
Counter({0: 3889, 1: 3802})

Epoch :  25 loss training:  2.553639662306523 Time :  1027
accuracy train: 0.996162 val: 0.985455 test: 0.972603
max validation accuracy : 0.985455 max acc epoch : 17 test accuracy : 0.973516
Counter({0: 3891, 1: 3800})

Epoch :  26 loss training:  2.3541904329904355 Time :  1064
accuracy train: 0.995960 val: 0.978182 test: 0.976256
max validation accuracy : 0.985455 max acc epoch : 17 test accuracy : 0.973516
Counter({1: 3893, 0: 3798})

Epoch :  27 loss training:  2.361945722834207 Time :  1102
accuracy train: 0.995152 val: 0.976364 test: 0.975342
max validation accuracy : 0.985455 max acc epoch : 17 test accuracy : 0.973516
Counter({0: 3892, 1: 3799})

Epoch :  28 loss training:  2.312610960158054 Time :  1139
accuracy train: 0.995556 val: 0.976364 test: 0.973516
max validation accuracy : 0.985455 max acc epoch : 17 test accuracy : 0.973516
Counter({0: 3899, 1: 3792})

========================================================================================================================================================================================================
best acc epoch :  17
validation accuracy :  0.9854545454545455
test accuracy :  0.9735159817351599
last test_accuracy :  0.9735159817351599
second best val :  0.9836363636363636
second best test :  0.9726027397260274
max gap 5
========================================================================================================================================================================================================

itr : 1
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=998, tsne=False, weight_decay=0)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  41.35733220144175 Time :  1272
accuracy train: 0.959200 val: 0.941818 test: 0.964840
max validation accuracy : 0.941818 max acc epoch : 1 test accuracy : 0.964840
Counter({1: 4098, 0: 3593})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.829388947044208 Time :  1317
accuracy train: 0.972935 val: 0.956364 test: 0.955251
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.955251
Counter({1: 3916, 0: 3775})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  15.010921559296548 Time :  1353
accuracy train: 0.974349 val: 0.954545 test: 0.968950
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.955251
Counter({1: 3983, 0: 3708})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.245734282303602 Time :  1385
accuracy train: 0.986063 val: 0.963636 test: 0.971233
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.971233
Counter({0: 3873, 1: 3818})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  7.515089565189555 Time :  1423
accuracy train: 0.977984 val: 0.958182 test: 0.971689
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.971233
Counter({1: 3933, 0: 3758})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.519264581846073 Time :  1469
accuracy train: 0.986669 val: 0.961818 test: 0.963014
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.971233
Counter({0: 3880, 1: 3811})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.226531274151057 Time :  1505
accuracy train: 0.988487 val: 0.963636 test: 0.966210
max validation accuracy : 0.963636 max acc epoch : 4 test accuracy : 0.971233
Counter({0: 3869, 1: 3822})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.172902542632073 Time :  1549
accuracy train: 0.989497 val: 0.967273 test: 0.973973
max validation accuracy : 0.967273 max acc epoch : 8 test accuracy : 0.973973
Counter({0: 3867, 1: 3824})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.067996955243871 Time :  1576
accuracy train: 0.991113 val: 0.965455 test: 0.976256
max validation accuracy : 0.967273 max acc epoch : 8 test accuracy : 0.973973
Counter({1: 3851, 0: 3840})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.307100883801468 Time :  1613
accuracy train: 0.991113 val: 0.970909 test: 0.977169
max validation accuracy : 0.970909 max acc epoch : 10 test accuracy : 0.977169
Counter({1: 3850, 0: 3841})

Epoch :  11 loss training:  4.705749490240123 Time :  1653
accuracy train: 0.992325 val: 0.958182 test: 0.973059
max validation accuracy : 0.970909 max acc epoch : 10 test accuracy : 0.977169
Counter({1: 3856, 0: 3835})

Epoch :  12 loss training:  4.590984633658081 Time :  1693
accuracy train: 0.993335 val: 0.965455 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 10 test accuracy : 0.977169
Counter({0: 3856, 1: 3835})

Epoch :  13 loss training:  4.485134867602028 Time :  1731
accuracy train: 0.993941 val: 0.970909 test: 0.975799
max validation accuracy : 0.970909 max acc epoch : 10 test accuracy : 0.977169
Counter({1: 3857, 0: 3834})

Epoch :  14 loss training:  4.307993128837552 Time :  1771
accuracy train: 0.994143 val: 0.967273 test: 0.973516
max validation accuracy : 0.970909 max acc epoch : 10 test accuracy : 0.977169
Counter({1: 3863, 0: 3828})

Epoch :  15 loss training:  4.1685934567358345 Time :  1810
accuracy train: 0.994547 val: 0.965455 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 10 test accuracy : 0.977169
Counter({0: 3860, 1: 3831})

Epoch :  16 loss training:  3.491767355793854 Time :  1848
accuracy train: 0.994749 val: 0.967273 test: 0.972146
max validation accuracy : 0.970909 max acc epoch : 10 test accuracy : 0.977169
Counter({0: 3877, 1: 3814})

Epoch :  17 loss training:  3.2495592458581086 Time :  1882
accuracy train: 0.995152 val: 0.967273 test: 0.974886
max validation accuracy : 0.970909 max acc epoch : 10 test accuracy : 0.977169
Counter({1: 3883, 0: 3808})

Epoch :  18 loss training:  3.223058460105676 Time :  1924
accuracy train: 0.995556 val: 0.970909 test: 0.973973
max validation accuracy : 0.970909 max acc epoch : 10 test accuracy : 0.977169
Counter({0: 3885, 1: 3806})

Epoch :  19 loss training:  3.4209258764167316 Time :  1963
accuracy train: 0.995758 val: 0.969091 test: 0.975342
max validation accuracy : 0.970909 max acc epoch : 10 test accuracy : 0.977169
Counter({1: 3895, 0: 3796})

Epoch :  20 loss training:  3.0905053820461035 Time :  2003
accuracy train: 0.996162 val: 0.970909 test: 0.975342
max validation accuracy : 0.970909 max acc epoch : 10 test accuracy : 0.977169
Counter({0: 3905, 1: 3786})

Epoch :  21 loss training:  3.442559319548309 Time :  2039
accuracy train: 0.994547 val: 0.965455 test: 0.975799
max validation accuracy : 0.970909 max acc epoch : 10 test accuracy : 0.977169
Counter({0: 3886, 1: 3805})

========================================================================================================================================================================================================
best acc epoch :  10
validation accuracy :  0.9709090909090909
test accuracy :  0.9771689497716894
last test_accuracy :  0.9757990867579909
second best val :  0.9690909090909091
second best test :  0.9771689497716894
max gap 4
========================================================================================================================================================================================================

itr : 2
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=510, tsne=False, weight_decay=0)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  42.846182614564896 Time :  2163
accuracy train: 0.951323 val: 0.930909 test: 0.954795
max validation accuracy : 0.930909 max acc epoch : 1 test accuracy : 0.954795
Counter({1: 4267, 0: 3424})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  19.274111260659993 Time :  2202
accuracy train: 0.973541 val: 0.956364 test: 0.956164
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.956164
Counter({1: 4048, 0: 3643})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.85884697549045 Time :  2234
accuracy train: 0.958998 val: 0.943636 test: 0.959361
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.956164
Counter({0: 4061, 1: 3630})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.571635907050222 Time :  2275
accuracy train: 0.979398 val: 0.956364 test: 0.965297
max validation accuracy : 0.956364 max acc epoch : 2 test accuracy : 0.956164
Counter({1: 4039, 0: 3652})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.621363054262474 Time :  2317
accuracy train: 0.987275 val: 0.958182 test: 0.960731
max validation accuracy : 0.958182 max acc epoch : 5 test accuracy : 0.960731
Counter({0: 4001, 1: 3690})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  9.21701755153481 Time :  2355
accuracy train: 0.986265 val: 0.950909 test: 0.965297
max validation accuracy : 0.958182 max acc epoch : 5 test accuracy : 0.960731
Counter({1: 3962, 0: 3729})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.233448511455208 Time :  2387
accuracy train: 0.988891 val: 0.970909 test: 0.964840
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.964840
Counter({0: 3954, 1: 3737})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.060991630656645 Time :  2425
accuracy train: 0.986871 val: 0.965455 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.964840
Counter({0: 3950, 1: 3741})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.609327614074573 Time :  2468
accuracy train: 0.992931 val: 0.970909 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.964840
Counter({1: 3927, 0: 3764})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.039498113736045 Time :  2508
accuracy train: 0.992931 val: 0.970909 test: 0.970776
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.964840
Counter({0: 3904, 1: 3787})

Epoch :  11 loss training:  5.3635667078197 Time :  2540
accuracy train: 0.993335 val: 0.963636 test: 0.970776
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.964840
Counter({1: 3912, 0: 3779})

Epoch :  12 loss training:  5.412468003691174 Time :  2573
accuracy train: 0.993133 val: 0.963636 test: 0.972603
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.964840
Counter({0: 3913, 1: 3778})

Epoch :  13 loss training:  5.028613123751711 Time :  2613
accuracy train: 0.994547 val: 0.963636 test: 0.969863
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.964840
Counter({0: 3906, 1: 3785})

Epoch :  14 loss training:  4.5144041707972065 Time :  2652
accuracy train: 0.995152 val: 0.963636 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.964840
Counter({0: 3902, 1: 3789})

Epoch :  15 loss training:  4.336608910074574 Time :  2690
accuracy train: 0.995758 val: 0.961818 test: 0.967580
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.964840
Counter({1: 3896, 0: 3795})

Epoch :  16 loss training:  3.551426673831884 Time :  2726
accuracy train: 0.994951 val: 0.961818 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.964840
Counter({1: 3876, 0: 3815})

Epoch :  17 loss training:  3.724655478144996 Time :  2766
accuracy train: 0.995556 val: 0.969091 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.964840
Counter({0: 3879, 1: 3812})

Epoch :  18 loss training:  3.3537649309728295 Time :  2800
accuracy train: 0.994749 val: 0.961818 test: 0.969406
max validation accuracy : 0.970909 max acc epoch : 7 test accuracy : 0.964840
Counter({0: 3870, 1: 3821})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.9709090909090909
test accuracy :  0.9648401826484019
last test_accuracy :  0.9694063926940639
second best val :  0.9690909090909091
second best test :  0.9648401826484019
max gap 3
========================================================================================================================================================================================================

itr : 3
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=505, tsne=False, weight_decay=0)
device :  cuda:0
Counter({1: 4715, 0: 2976})

Epoch :  1 loss training:  40.86309404671192 Time :  2904
accuracy train: 0.961826 val: 0.963636 test: 0.952968
max validation accuracy : 0.963636 max acc epoch : 1 test accuracy : 0.952968
Counter({0: 4087, 1: 3604})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.80312749929726 Time :  2945
accuracy train: 0.959402 val: 0.947273 test: 0.959361
max validation accuracy : 0.963636 max acc epoch : 1 test accuracy : 0.952968
Counter({0: 4125, 1: 3566})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.50551237910986 Time :  2979
accuracy train: 0.952333 val: 0.969091 test: 0.936986
max validation accuracy : 0.969091 max acc epoch : 3 test accuracy : 0.936986
Counter({1: 3926, 0: 3765})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.5538868191652 Time :  3015
accuracy train: 0.973541 val: 0.960000 test: 0.961644
max validation accuracy : 0.969091 max acc epoch : 3 test accuracy : 0.936986
Counter({0: 4009, 1: 3682})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.14214920613449 Time :  3049
accuracy train: 0.981014 val: 0.961818 test: 0.965297
max validation accuracy : 0.969091 max acc epoch : 3 test accuracy : 0.936986
Counter({1: 3956, 0: 3735})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.232719155494124 Time :  3082
accuracy train: 0.976772 val: 0.963636 test: 0.965297
max validation accuracy : 0.969091 max acc epoch : 3 test accuracy : 0.936986
Counter({0: 3978, 1: 3713})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  8.024468586081639 Time :  3119
accuracy train: 0.990507 val: 0.981818 test: 0.966210
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.966210
Counter({1: 3934, 0: 3757})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.968026419170201 Time :  3158
accuracy train: 0.991315 val: 0.981818 test: 0.960274
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.966210
Counter({0: 3899, 1: 3792})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.469725140021183 Time :  3191
accuracy train: 0.992325 val: 0.974545 test: 0.966210
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.966210
Counter({1: 3921, 0: 3770})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  6.148421759484336 Time :  3220
accuracy train: 0.991113 val: 0.969091 test: 0.972603
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.966210
Counter({0: 3901, 1: 3790})

Epoch :  11 loss training:  5.856791868340224 Time :  3256
accuracy train: 0.992931 val: 0.981818 test: 0.965753
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.966210
Counter({1: 3910, 0: 3781})

Epoch :  12 loss training:  5.197152924025431 Time :  3300
accuracy train: 0.994143 val: 0.974545 test: 0.970320
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.966210
Counter({1: 3905, 0: 3786})

Epoch :  13 loss training:  4.950855786213651 Time :  3338
accuracy train: 0.994951 val: 0.976364 test: 0.968493
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.966210
Counter({1: 3901, 0: 3790})

Epoch :  14 loss training:  4.623237049905583 Time :  3371
accuracy train: 0.993537 val: 0.972727 test: 0.966667
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.966210
Counter({0: 3905, 1: 3786})

Epoch :  15 loss training:  4.550848103361204 Time :  3409
accuracy train: 0.992931 val: 0.974545 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.966210
Counter({0: 3886, 1: 3805})

Epoch :  16 loss training:  4.374331698054448 Time :  3447
accuracy train: 0.994951 val: 0.978182 test: 0.970776
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.966210
Counter({1: 3895, 0: 3796})

Epoch :  17 loss training:  3.644392622736632 Time :  3492
accuracy train: 0.995152 val: 0.976364 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.966210
Counter({0: 3870, 1: 3821})

Epoch :  18 loss training:  3.7548420124221593 Time :  3529
accuracy train: 0.994951 val: 0.978182 test: 0.969863
max validation accuracy : 0.981818 max acc epoch : 7 test accuracy : 0.966210
Counter({1: 3856, 0: 3835})

========================================================================================================================================================================================================
best acc epoch :  7
validation accuracy :  0.9818181818181818
test accuracy :  0.9662100456621004
last test_accuracy :  0.9698630136986301
second best val :  0.9781818181818182
second best test :  0.9662100456621004
max gap 4
========================================================================================================================================================================================================

itr : 4
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=743, tsne=False, weight_decay=0)
device :  cuda:0
Counter({0: 4721, 1: 2970})

Epoch :  1 loss training:  39.35055874288082 Time :  3654
accuracy train: 0.948293 val: 0.938182 test: 0.952511
max validation accuracy : 0.938182 max acc epoch : 1 test accuracy : 0.952511
Counter({0: 4107, 1: 3584})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  17.691767272539437 Time :  3696
accuracy train: 0.966067 val: 0.940000 test: 0.953881
max validation accuracy : 0.940000 max acc epoch : 2 test accuracy : 0.953881
Counter({0: 3962, 1: 3729})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  13.587461066897959 Time :  3736
accuracy train: 0.970107 val: 0.963636 test: 0.959361
max validation accuracy : 0.963636 max acc epoch : 3 test accuracy : 0.959361
Counter({0: 3888, 1: 3803})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  10.243258017115295 Time :  3778
accuracy train: 0.987073 val: 0.970909 test: 0.965753
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.965753
Counter({1: 3865, 0: 3826})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  9.092786241322756 Time :  3821
accuracy train: 0.988689 val: 0.969091 test: 0.968037
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.965753
Counter({1: 3855, 0: 3836})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.091443944023922 Time :  3864
accuracy train: 0.988487 val: 0.965455 test: 0.967123
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.965753
Counter({0: 3849, 1: 3842})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  6.673800124786794 Time :  3895
accuracy train: 0.990103 val: 0.967273 test: 0.970776
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.965753
Counter({0: 3846, 1: 3845})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  6.171890087949578 Time :  3935
accuracy train: 0.990507 val: 0.960000 test: 0.971233
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.965753
Counter({0: 3865, 1: 3826})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  5.86051917495206 Time :  3979
accuracy train: 0.992123 val: 0.969091 test: 0.968950
max validation accuracy : 0.970909 max acc epoch : 4 test accuracy : 0.965753
Counter({1: 3853, 0: 3838})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.070277407066897 Time :  4019
accuracy train: 0.992931 val: 0.974545 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.971689
Counter({1: 3862, 0: 3829})

Epoch :  11 loss training:  5.0268748487578705 Time :  4056
accuracy train: 0.992729 val: 0.967273 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.971689
Counter({0: 3861, 1: 3830})

Epoch :  12 loss training:  4.574407716165297 Time :  4093
accuracy train: 0.993335 val: 0.969091 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.971689
Counter({1: 3870, 0: 3821})

Epoch :  13 loss training:  4.025397730933037 Time :  4141
accuracy train: 0.994547 val: 0.970909 test: 0.973973
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.971689
Counter({0: 3873, 1: 3818})

Epoch :  14 loss training:  3.7375474128639325 Time :  4184
accuracy train: 0.994547 val: 0.967273 test: 0.968950
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.971689
Counter({1: 3872, 0: 3819})

Epoch :  15 loss training:  4.1857984470552765 Time :  4227
accuracy train: 0.993739 val: 0.967273 test: 0.971233
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.971689
Counter({0: 3881, 1: 3810})

Epoch :  16 loss training:  3.6591962351230904 Time :  4264
accuracy train: 0.994749 val: 0.965455 test: 0.969863
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.971689
Counter({0: 3882, 1: 3809})

Epoch :  17 loss training:  3.0751290320185944 Time :  4305
accuracy train: 0.995758 val: 0.970909 test: 0.971689
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.971689
Counter({1: 3889, 0: 3802})

Epoch :  18 loss training:  3.4380489439936355 Time :  4350
accuracy train: 0.996162 val: 0.967273 test: 0.973516
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.971689
Counter({0: 3880, 1: 3811})

Epoch :  19 loss training:  3.0208984345081262 Time :  4399
accuracy train: 0.995960 val: 0.970909 test: 0.969406
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.971689
Counter({1: 3903, 0: 3788})

Epoch :  20 loss training:  2.7007214424666017 Time :  4442
accuracy train: 0.996162 val: 0.965455 test: 0.972146
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.971689
Counter({1: 3902, 0: 3789})

Epoch :  21 loss training:  2.4111535318079405 Time :  4483
accuracy train: 0.995758 val: 0.963636 test: 0.974886
max validation accuracy : 0.974545 max acc epoch : 10 test accuracy : 0.971689
Counter({0: 3904, 1: 3787})

========================================================================================================================================================================================================
best acc epoch :  10
validation accuracy :  0.9745454545454545
test accuracy :  0.971689497716895
last test_accuracy :  0.9748858447488584
second best val :  0.9709090909090909
second best test :  0.9657534246575342
max gap 6
========================================================================================================================================================================================================

itr : 5
Namespace(batch_size=64, dataset='R8', device=0, dropout=0.3, early_stop=10, epochs=300, hidden_dim=200, lda=False, lr=0.001, num_clusters=2, num_exp=6, num_layers=3, num_mlp_layers=1, random_vec=False, seed=626, tsne=False, weight_decay=0)
device :  cuda:0
Counter({0: 4715, 1: 2976})

Epoch :  1 loss training:  38.491321325302124 Time :  4620
accuracy train: 0.955968 val: 0.958182 test: 0.954338
max validation accuracy : 0.958182 max acc epoch : 1 test accuracy : 0.954338
Counter({1: 4059, 0: 3632})
Epoch-1 lr: 0.001

Epoch :  2 loss training:  18.62821637839079 Time :  4658
accuracy train: 0.970713 val: 0.963636 test: 0.964384
max validation accuracy : 0.963636 max acc epoch : 2 test accuracy : 0.964384
Counter({0: 3940, 1: 3751})
Epoch-2 lr: 0.001

Epoch :  3 loss training:  14.063927110284567 Time :  4699
accuracy train: 0.966067 val: 0.965455 test: 0.964384
max validation accuracy : 0.965455 max acc epoch : 3 test accuracy : 0.964384
Counter({1: 3967, 0: 3724})
Epoch-3 lr: 0.0005

Epoch :  4 loss training:  11.415674421936274 Time :  4739
accuracy train: 0.985256 val: 0.976364 test: 0.967580
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.967580
Counter({0: 3916, 1: 3775})
Epoch-4 lr: 0.0005

Epoch :  5 loss training:  10.307293547084555 Time :  4781
accuracy train: 0.982226 val: 0.969091 test: 0.969406
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.967580
Counter({1: 3909, 0: 3782})
Epoch-5 lr: 0.0005

Epoch :  6 loss training:  8.82698335358873 Time :  4817
accuracy train: 0.988083 val: 0.974545 test: 0.965753
max validation accuracy : 0.976364 max acc epoch : 4 test accuracy : 0.967580
Counter({0: 3858, 1: 3833})
Epoch-6 lr: 0.00025

Epoch :  7 loss training:  7.467542891157791 Time :  4850
accuracy train: 0.989699 val: 0.978182 test: 0.965297
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.965297
Counter({1: 3878, 0: 3813})
Epoch-7 lr: 0.00025

Epoch :  8 loss training:  7.622445746441372 Time :  4893
accuracy train: 0.990305 val: 0.972727 test: 0.969863
max validation accuracy : 0.978182 max acc epoch : 7 test accuracy : 0.965297
Counter({0: 3875, 1: 3816})
Epoch-8 lr: 0.00025

Epoch :  9 loss training:  6.045965137891471 Time :  4933
accuracy train: 0.991719 val: 0.980000 test: 0.965297
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.965297
Counter({1: 3852, 0: 3839})
Epoch-9 lr: 0.000125

Epoch :  10 loss training:  5.472234301967546 Time :  4979
accuracy train: 0.989093 val: 0.976364 test: 0.971233
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.965297
Counter({0: 3861, 1: 3830})

Epoch :  11 loss training:  5.818747186451219 Time :  5014
accuracy train: 0.993335 val: 0.980000 test: 0.967123
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.965297
Counter({1: 3847, 0: 3844})

Epoch :  12 loss training:  4.759895135415718 Time :  5051
accuracy train: 0.993133 val: 0.976364 test: 0.969406
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.965297
Counter({1: 3847, 0: 3844})

Epoch :  13 loss training:  4.846898361574858 Time :  5086
accuracy train: 0.994143 val: 0.980000 test: 0.968493
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.965297
Counter({1: 3862, 0: 3829})

Epoch :  14 loss training:  4.300541949807666 Time :  5126
accuracy train: 0.994143 val: 0.980000 test: 0.969863
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.965297
Counter({0: 3865, 1: 3826})

Epoch :  15 loss training:  4.091813082515728 Time :  5164
accuracy train: 0.994951 val: 0.980000 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.965297
Counter({1: 3867, 0: 3824})

Epoch :  16 loss training:  3.7191712782368995 Time :  5194
accuracy train: 0.994345 val: 0.978182 test: 0.968493
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.965297
Counter({1: 3886, 0: 3805})

Epoch :  17 loss training:  3.607224101317115 Time :  5232
accuracy train: 0.995152 val: 0.976364 test: 0.968037
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.965297
Counter({1: 3876, 0: 3815})

Epoch :  18 loss training:  3.5578373268945143 Time :  5274
accuracy train: 0.995556 val: 0.980000 test: 0.970776
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.965297
Counter({0: 3886, 1: 3805})

Epoch :  19 loss training:  3.1784065212123096 Time :  5321
accuracy train: 0.995960 val: 0.980000 test: 0.970320
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.965297
Counter({1: 3890, 0: 3801})

Epoch :  20 loss training:  2.845511401828844 Time :  5354
accuracy train: 0.995960 val: 0.976364 test: 0.974429
max validation accuracy : 0.980000 max acc epoch : 9 test accuracy : 0.965297
Counter({0: 3884, 1: 3807})

========================================================================================================================================================================================================
best acc epoch :  9
validation accuracy :  0.98
test accuracy :  0.965296803652968
last test_accuracy :  0.9744292237442922
second best val :  0.9781818181818182
second best test :  0.965296803652968
max gap 3
========================================================================================================================================================================================================

=======================================================================Summary=======================================================================
k :  0 	 best_acc epoch :  17 	 val_accuracy : 0.98545 	 test_accuracy : 0.97352 	 last test_accuracy : 0.97352 	 second best val : 0.98364 	 second best test : 0.97260
k :  1 	 best_acc epoch :  10 	 val_accuracy : 0.97091 	 test_accuracy : 0.97717 	 last test_accuracy : 0.97580 	 second best val : 0.96909 	 second best test : 0.97717
k :  2 	 best_acc epoch :  7 	 val_accuracy : 0.97091 	 test_accuracy : 0.96484 	 last test_accuracy : 0.96941 	 second best val : 0.96909 	 second best test : 0.96484
k :  3 	 best_acc epoch :  7 	 val_accuracy : 0.98182 	 test_accuracy : 0.96621 	 last test_accuracy : 0.96986 	 second best val : 0.97818 	 second best test : 0.96621
k :  4 	 best_acc epoch :  10 	 val_accuracy : 0.97455 	 test_accuracy : 0.97169 	 last test_accuracy : 0.97489 	 second best val : 0.97091 	 second best test : 0.96575
k :  5 	 best_acc epoch :  9 	 val_accuracy : 0.98000 	 test_accuracy : 0.96530 	 last test_accuracy : 0.97443 	 second best val : 0.97818 	 second best test : 0.96530

avg :  	 val_accuracy : 0.97727 	 test_accuracy : 0.96979 	 last_accuracy : 0.97298 	 second best val : 0.97485 	 second best test : 0.96865

std :  	 val_accuracy : 0.00553 	 test_accuracy : 0.00464 	 last_accuracy : 0.00246 	 second best val : 0.00550 	 second best test : 0.00462
